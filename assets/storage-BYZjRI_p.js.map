{"version":3,"file":"storage-BYZjRI_p.js","sources":["../../node_modules/zustand/esm/vanilla.mjs","../../node_modules/use-sync-external-store/shim/index.js","../../node_modules/use-sync-external-store/cjs/use-sync-external-store-shim.development.js","../../node_modules/use-sync-external-store/shim/with-selector.js","../../node_modules/use-sync-external-store/cjs/use-sync-external-store-shim/with-selector.development.js","../../node_modules/zustand/esm/index.mjs","../../node_modules/dexie/dist/modern/dexie.mjs"],"sourcesContent":["const createStoreImpl = (createState) => {\n  let state;\n  const listeners = /* @__PURE__ */ new Set();\n  const setState = (partial, replace) => {\n    const nextState = typeof partial === \"function\" ? partial(state) : partial;\n    if (!Object.is(nextState, state)) {\n      const previousState = state;\n      state = (replace != null ? replace : typeof nextState !== \"object\" || nextState === null) ? nextState : Object.assign({}, state, nextState);\n      listeners.forEach((listener) => listener(state, previousState));\n    }\n  };\n  const getState = () => state;\n  const getInitialState = () => initialState;\n  const subscribe = (listener) => {\n    listeners.add(listener);\n    return () => listeners.delete(listener);\n  };\n  const destroy = () => {\n    if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n      console.warn(\n        \"[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected.\"\n      );\n    }\n    listeners.clear();\n  };\n  const api = { setState, getState, getInitialState, subscribe, destroy };\n  const initialState = state = createState(setState, getState, api);\n  return api;\n};\nconst createStore = (createState) => createState ? createStoreImpl(createState) : createStoreImpl;\nvar vanilla = (createState) => {\n  if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n    console.warn(\n      \"[DEPRECATED] Default export is deprecated. Instead use import { createStore } from 'zustand/vanilla'.\"\n    );\n  }\n  return createStore(createState);\n};\n\nexport { createStore, vanilla as default };\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('../cjs/use-sync-external-store-shim.production.js');\n} else {\n  module.exports = require('../cjs/use-sync-external-store-shim.development.js');\n}\n","/**\n * @license React\n * use-sync-external-store-shim.development.js\n *\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n\"use strict\";\n\"production\" !== process.env.NODE_ENV &&\n  (function () {\n    function is(x, y) {\n      return (x === y && (0 !== x || 1 / x === 1 / y)) || (x !== x && y !== y);\n    }\n    function useSyncExternalStore$2(subscribe, getSnapshot) {\n      didWarnOld18Alpha ||\n        void 0 === React.startTransition ||\n        ((didWarnOld18Alpha = !0),\n        console.error(\n          \"You are using an outdated, pre-release alpha of React 18 that does not support useSyncExternalStore. The use-sync-external-store shim will not work correctly. Upgrade to a newer pre-release.\"\n        ));\n      var value = getSnapshot();\n      if (!didWarnUncachedGetSnapshot) {\n        var cachedValue = getSnapshot();\n        objectIs(value, cachedValue) ||\n          (console.error(\n            \"The result of getSnapshot should be cached to avoid an infinite loop\"\n          ),\n          (didWarnUncachedGetSnapshot = !0));\n      }\n      cachedValue = useState({\n        inst: { value: value, getSnapshot: getSnapshot }\n      });\n      var inst = cachedValue[0].inst,\n        forceUpdate = cachedValue[1];\n      useLayoutEffect(\n        function () {\n          inst.value = value;\n          inst.getSnapshot = getSnapshot;\n          checkIfSnapshotChanged(inst) && forceUpdate({ inst: inst });\n        },\n        [subscribe, value, getSnapshot]\n      );\n      useEffect(\n        function () {\n          checkIfSnapshotChanged(inst) && forceUpdate({ inst: inst });\n          return subscribe(function () {\n            checkIfSnapshotChanged(inst) && forceUpdate({ inst: inst });\n          });\n        },\n        [subscribe]\n      );\n      useDebugValue(value);\n      return value;\n    }\n    function checkIfSnapshotChanged(inst) {\n      var latestGetSnapshot = inst.getSnapshot;\n      inst = inst.value;\n      try {\n        var nextValue = latestGetSnapshot();\n        return !objectIs(inst, nextValue);\n      } catch (error) {\n        return !0;\n      }\n    }\n    function useSyncExternalStore$1(subscribe, getSnapshot) {\n      return getSnapshot();\n    }\n    \"undefined\" !== typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ &&\n      \"function\" ===\n        typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart &&\n      __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(Error());\n    var React = require(\"react\"),\n      objectIs = \"function\" === typeof Object.is ? Object.is : is,\n      useState = React.useState,\n      useEffect = React.useEffect,\n      useLayoutEffect = React.useLayoutEffect,\n      useDebugValue = React.useDebugValue,\n      didWarnOld18Alpha = !1,\n      didWarnUncachedGetSnapshot = !1,\n      shim =\n        \"undefined\" === typeof window ||\n        \"undefined\" === typeof window.document ||\n        \"undefined\" === typeof window.document.createElement\n          ? useSyncExternalStore$1\n          : useSyncExternalStore$2;\n    exports.useSyncExternalStore =\n      void 0 !== React.useSyncExternalStore ? React.useSyncExternalStore : shim;\n    \"undefined\" !== typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ &&\n      \"function\" ===\n        typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop &&\n      __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(Error());\n  })();\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('../cjs/use-sync-external-store-shim/with-selector.production.js');\n} else {\n  module.exports = require('../cjs/use-sync-external-store-shim/with-selector.development.js');\n}\n","/**\n * @license React\n * use-sync-external-store-shim/with-selector.development.js\n *\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n\"use strict\";\n\"production\" !== process.env.NODE_ENV &&\n  (function () {\n    function is(x, y) {\n      return (x === y && (0 !== x || 1 / x === 1 / y)) || (x !== x && y !== y);\n    }\n    \"undefined\" !== typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ &&\n      \"function\" ===\n        typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart &&\n      __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(Error());\n    var React = require(\"react\"),\n      shim = require(\"use-sync-external-store/shim\"),\n      objectIs = \"function\" === typeof Object.is ? Object.is : is,\n      useSyncExternalStore = shim.useSyncExternalStore,\n      useRef = React.useRef,\n      useEffect = React.useEffect,\n      useMemo = React.useMemo,\n      useDebugValue = React.useDebugValue;\n    exports.useSyncExternalStoreWithSelector = function (\n      subscribe,\n      getSnapshot,\n      getServerSnapshot,\n      selector,\n      isEqual\n    ) {\n      var instRef = useRef(null);\n      if (null === instRef.current) {\n        var inst = { hasValue: !1, value: null };\n        instRef.current = inst;\n      } else inst = instRef.current;\n      instRef = useMemo(\n        function () {\n          function memoizedSelector(nextSnapshot) {\n            if (!hasMemo) {\n              hasMemo = !0;\n              memoizedSnapshot = nextSnapshot;\n              nextSnapshot = selector(nextSnapshot);\n              if (void 0 !== isEqual && inst.hasValue) {\n                var currentSelection = inst.value;\n                if (isEqual(currentSelection, nextSnapshot))\n                  return (memoizedSelection = currentSelection);\n              }\n              return (memoizedSelection = nextSnapshot);\n            }\n            currentSelection = memoizedSelection;\n            if (objectIs(memoizedSnapshot, nextSnapshot))\n              return currentSelection;\n            var nextSelection = selector(nextSnapshot);\n            if (void 0 !== isEqual && isEqual(currentSelection, nextSelection))\n              return (memoizedSnapshot = nextSnapshot), currentSelection;\n            memoizedSnapshot = nextSnapshot;\n            return (memoizedSelection = nextSelection);\n          }\n          var hasMemo = !1,\n            memoizedSnapshot,\n            memoizedSelection,\n            maybeGetServerSnapshot =\n              void 0 === getServerSnapshot ? null : getServerSnapshot;\n          return [\n            function () {\n              return memoizedSelector(getSnapshot());\n            },\n            null === maybeGetServerSnapshot\n              ? void 0\n              : function () {\n                  return memoizedSelector(maybeGetServerSnapshot());\n                }\n          ];\n        },\n        [getSnapshot, getServerSnapshot, selector, isEqual]\n      );\n      var value = useSyncExternalStore(subscribe, instRef[0], instRef[1]);\n      useEffect(\n        function () {\n          inst.hasValue = !0;\n          inst.value = value;\n        },\n        [value]\n      );\n      useDebugValue(value);\n      return value;\n    };\n    \"undefined\" !== typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ &&\n      \"function\" ===\n        typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop &&\n      __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(Error());\n  })();\n","import { createStore } from 'zustand/vanilla';\nexport * from 'zustand/vanilla';\nimport ReactExports from 'react';\nimport useSyncExternalStoreExports from 'use-sync-external-store/shim/with-selector.js';\n\nconst { useDebugValue } = ReactExports;\nconst { useSyncExternalStoreWithSelector } = useSyncExternalStoreExports;\nlet didWarnAboutEqualityFn = false;\nconst identity = (arg) => arg;\nfunction useStore(api, selector = identity, equalityFn) {\n  if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && equalityFn && !didWarnAboutEqualityFn) {\n    console.warn(\n      \"[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937\"\n    );\n    didWarnAboutEqualityFn = true;\n  }\n  const slice = useSyncExternalStoreWithSelector(\n    api.subscribe,\n    api.getState,\n    api.getServerState || api.getInitialState,\n    selector,\n    equalityFn\n  );\n  useDebugValue(slice);\n  return slice;\n}\nconst createImpl = (createState) => {\n  if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && typeof createState !== \"function\") {\n    console.warn(\n      \"[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.\"\n    );\n  }\n  const api = typeof createState === \"function\" ? createStore(createState) : createState;\n  const useBoundStore = (selector, equalityFn) => useStore(api, selector, equalityFn);\n  Object.assign(useBoundStore, api);\n  return useBoundStore;\n};\nconst create = (createState) => createState ? createImpl(createState) : createImpl;\nvar react = (createState) => {\n  if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n    console.warn(\n      \"[DEPRECATED] Default export is deprecated. Instead use `import { create } from 'zustand'`.\"\n    );\n  }\n  return create(createState);\n};\n\nexport { create, react as default, useStore };\n","/*\n * Dexie.js - a minimalistic wrapper for IndexedDB\n * ===============================================\n *\n * By David Fahlander, david.fahlander@gmail.com\n *\n * Version 3.2.7, Wed Mar 20 2024\n *\n * https://dexie.org\n *\n * Apache License Version 2.0, January 2004, http://www.apache.org/licenses/\n */\n \nconst _global = typeof globalThis !== 'undefined' ? globalThis :\n    typeof self !== 'undefined' ? self :\n        typeof window !== 'undefined' ? window :\n            global;\n\nconst keys = Object.keys;\nconst isArray = Array.isArray;\nif (typeof Promise !== 'undefined' && !_global.Promise) {\n    _global.Promise = Promise;\n}\nfunction extend(obj, extension) {\n    if (typeof extension !== 'object')\n        return obj;\n    keys(extension).forEach(function (key) {\n        obj[key] = extension[key];\n    });\n    return obj;\n}\nconst getProto = Object.getPrototypeOf;\nconst _hasOwn = {}.hasOwnProperty;\nfunction hasOwn(obj, prop) {\n    return _hasOwn.call(obj, prop);\n}\nfunction props(proto, extension) {\n    if (typeof extension === 'function')\n        extension = extension(getProto(proto));\n    (typeof Reflect === \"undefined\" ? keys : Reflect.ownKeys)(extension).forEach(key => {\n        setProp(proto, key, extension[key]);\n    });\n}\nconst defineProperty = Object.defineProperty;\nfunction setProp(obj, prop, functionOrGetSet, options) {\n    defineProperty(obj, prop, extend(functionOrGetSet && hasOwn(functionOrGetSet, \"get\") && typeof functionOrGetSet.get === 'function' ?\n        { get: functionOrGetSet.get, set: functionOrGetSet.set, configurable: true } :\n        { value: functionOrGetSet, configurable: true, writable: true }, options));\n}\nfunction derive(Child) {\n    return {\n        from: function (Parent) {\n            Child.prototype = Object.create(Parent.prototype);\n            setProp(Child.prototype, \"constructor\", Child);\n            return {\n                extend: props.bind(null, Child.prototype)\n            };\n        }\n    };\n}\nconst getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\nfunction getPropertyDescriptor(obj, prop) {\n    const pd = getOwnPropertyDescriptor(obj, prop);\n    let proto;\n    return pd || (proto = getProto(obj)) && getPropertyDescriptor(proto, prop);\n}\nconst _slice = [].slice;\nfunction slice(args, start, end) {\n    return _slice.call(args, start, end);\n}\nfunction override(origFunc, overridedFactory) {\n    return overridedFactory(origFunc);\n}\nfunction assert(b) {\n    if (!b)\n        throw new Error(\"Assertion Failed\");\n}\nfunction asap$1(fn) {\n    if (_global.setImmediate)\n        setImmediate(fn);\n    else\n        setTimeout(fn, 0);\n}\nfunction arrayToObject(array, extractor) {\n    return array.reduce((result, item, i) => {\n        var nameAndValue = extractor(item, i);\n        if (nameAndValue)\n            result[nameAndValue[0]] = nameAndValue[1];\n        return result;\n    }, {});\n}\nfunction tryCatch(fn, onerror, args) {\n    try {\n        fn.apply(null, args);\n    }\n    catch (ex) {\n        onerror && onerror(ex);\n    }\n}\nfunction getByKeyPath(obj, keyPath) {\n    if (typeof keyPath === 'string' && hasOwn(obj, keyPath))\n        return obj[keyPath];\n    if (!keyPath)\n        return obj;\n    if (typeof keyPath !== 'string') {\n        var rv = [];\n        for (var i = 0, l = keyPath.length; i < l; ++i) {\n            var val = getByKeyPath(obj, keyPath[i]);\n            rv.push(val);\n        }\n        return rv;\n    }\n    var period = keyPath.indexOf('.');\n    if (period !== -1) {\n        var innerObj = obj[keyPath.substr(0, period)];\n        return innerObj == null ? undefined : getByKeyPath(innerObj, keyPath.substr(period + 1));\n    }\n    return undefined;\n}\nfunction setByKeyPath(obj, keyPath, value) {\n    if (!obj || keyPath === undefined)\n        return;\n    if ('isFrozen' in Object && Object.isFrozen(obj))\n        return;\n    if (typeof keyPath !== 'string' && 'length' in keyPath) {\n        assert(typeof value !== 'string' && 'length' in value);\n        for (var i = 0, l = keyPath.length; i < l; ++i) {\n            setByKeyPath(obj, keyPath[i], value[i]);\n        }\n    }\n    else {\n        var period = keyPath.indexOf('.');\n        if (period !== -1) {\n            var currentKeyPath = keyPath.substr(0, period);\n            var remainingKeyPath = keyPath.substr(period + 1);\n            if (remainingKeyPath === \"\")\n                if (value === undefined) {\n                    if (isArray(obj) && !isNaN(parseInt(currentKeyPath)))\n                        obj.splice(currentKeyPath, 1);\n                    else\n                        delete obj[currentKeyPath];\n                }\n                else\n                    obj[currentKeyPath] = value;\n            else {\n                var innerObj = obj[currentKeyPath];\n                if (!innerObj || !hasOwn(obj, currentKeyPath))\n                    innerObj = (obj[currentKeyPath] = {});\n                setByKeyPath(innerObj, remainingKeyPath, value);\n            }\n        }\n        else {\n            if (value === undefined) {\n                if (isArray(obj) && !isNaN(parseInt(keyPath)))\n                    obj.splice(keyPath, 1);\n                else\n                    delete obj[keyPath];\n            }\n            else\n                obj[keyPath] = value;\n        }\n    }\n}\nfunction delByKeyPath(obj, keyPath) {\n    if (typeof keyPath === 'string')\n        setByKeyPath(obj, keyPath, undefined);\n    else if ('length' in keyPath)\n        [].map.call(keyPath, function (kp) {\n            setByKeyPath(obj, kp, undefined);\n        });\n}\nfunction shallowClone(obj) {\n    var rv = {};\n    for (var m in obj) {\n        if (hasOwn(obj, m))\n            rv[m] = obj[m];\n    }\n    return rv;\n}\nconst concat = [].concat;\nfunction flatten(a) {\n    return concat.apply([], a);\n}\nconst intrinsicTypeNames = \"BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey\"\n    .split(',').concat(flatten([8, 16, 32, 64].map(num => [\"Int\", \"Uint\", \"Float\"].map(t => t + num + \"Array\")))).filter(t => _global[t]);\nconst intrinsicTypes = intrinsicTypeNames.map(t => _global[t]);\narrayToObject(intrinsicTypeNames, x => [x, true]);\nlet circularRefs = null;\nfunction deepClone(any) {\n    circularRefs = typeof WeakMap !== 'undefined' && new WeakMap();\n    const rv = innerDeepClone(any);\n    circularRefs = null;\n    return rv;\n}\nfunction innerDeepClone(any) {\n    if (!any || typeof any !== 'object')\n        return any;\n    let rv = circularRefs && circularRefs.get(any);\n    if (rv)\n        return rv;\n    if (isArray(any)) {\n        rv = [];\n        circularRefs && circularRefs.set(any, rv);\n        for (var i = 0, l = any.length; i < l; ++i) {\n            rv.push(innerDeepClone(any[i]));\n        }\n    }\n    else if (intrinsicTypes.indexOf(any.constructor) >= 0) {\n        rv = any;\n    }\n    else {\n        const proto = getProto(any);\n        rv = proto === Object.prototype ? {} : Object.create(proto);\n        circularRefs && circularRefs.set(any, rv);\n        for (var prop in any) {\n            if (hasOwn(any, prop)) {\n                rv[prop] = innerDeepClone(any[prop]);\n            }\n        }\n    }\n    return rv;\n}\nconst { toString } = {};\nfunction toStringTag(o) {\n    return toString.call(o).slice(8, -1);\n}\nconst iteratorSymbol = typeof Symbol !== 'undefined' ?\n    Symbol.iterator :\n    '@@iterator';\nconst getIteratorOf = typeof iteratorSymbol === \"symbol\" ? function (x) {\n    var i;\n    return x != null && (i = x[iteratorSymbol]) && i.apply(x);\n} : function () { return null; };\nconst NO_CHAR_ARRAY = {};\nfunction getArrayOf(arrayLike) {\n    var i, a, x, it;\n    if (arguments.length === 1) {\n        if (isArray(arrayLike))\n            return arrayLike.slice();\n        if (this === NO_CHAR_ARRAY && typeof arrayLike === 'string')\n            return [arrayLike];\n        if ((it = getIteratorOf(arrayLike))) {\n            a = [];\n            while ((x = it.next()), !x.done)\n                a.push(x.value);\n            return a;\n        }\n        if (arrayLike == null)\n            return [arrayLike];\n        i = arrayLike.length;\n        if (typeof i === 'number') {\n            a = new Array(i);\n            while (i--)\n                a[i] = arrayLike[i];\n            return a;\n        }\n        return [arrayLike];\n    }\n    i = arguments.length;\n    a = new Array(i);\n    while (i--)\n        a[i] = arguments[i];\n    return a;\n}\nconst isAsyncFunction = typeof Symbol !== 'undefined'\n    ? (fn) => fn[Symbol.toStringTag] === 'AsyncFunction'\n    : () => false;\n\nvar debug = typeof location !== 'undefined' &&\n    /^(http|https):\\/\\/(localhost|127\\.0\\.0\\.1)/.test(location.href);\nfunction setDebug(value, filter) {\n    debug = value;\n    libraryFilter = filter;\n}\nvar libraryFilter = () => true;\nconst NEEDS_THROW_FOR_STACK = !new Error(\"\").stack;\nfunction getErrorWithStack() {\n    if (NEEDS_THROW_FOR_STACK)\n        try {\n            getErrorWithStack.arguments;\n            throw new Error();\n        }\n        catch (e) {\n            return e;\n        }\n    return new Error();\n}\nfunction prettyStack(exception, numIgnoredFrames) {\n    var stack = exception.stack;\n    if (!stack)\n        return \"\";\n    numIgnoredFrames = (numIgnoredFrames || 0);\n    if (stack.indexOf(exception.name) === 0)\n        numIgnoredFrames += (exception.name + exception.message).split('\\n').length;\n    return stack.split('\\n')\n        .slice(numIgnoredFrames)\n        .filter(libraryFilter)\n        .map(frame => \"\\n\" + frame)\n        .join('');\n}\n\nvar dexieErrorNames = [\n    'Modify',\n    'Bulk',\n    'OpenFailed',\n    'VersionChange',\n    'Schema',\n    'Upgrade',\n    'InvalidTable',\n    'MissingAPI',\n    'NoSuchDatabase',\n    'InvalidArgument',\n    'SubTransaction',\n    'Unsupported',\n    'Internal',\n    'DatabaseClosed',\n    'PrematureCommit',\n    'ForeignAwait'\n];\nvar idbDomErrorNames = [\n    'Unknown',\n    'Constraint',\n    'Data',\n    'TransactionInactive',\n    'ReadOnly',\n    'Version',\n    'NotFound',\n    'InvalidState',\n    'InvalidAccess',\n    'Abort',\n    'Timeout',\n    'QuotaExceeded',\n    'Syntax',\n    'DataClone'\n];\nvar errorList = dexieErrorNames.concat(idbDomErrorNames);\nvar defaultTexts = {\n    VersionChanged: \"Database version changed by other database connection\",\n    DatabaseClosed: \"Database has been closed\",\n    Abort: \"Transaction aborted\",\n    TransactionInactive: \"Transaction has already completed or failed\",\n    MissingAPI: \"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb\"\n};\nfunction DexieError(name, msg) {\n    this._e = getErrorWithStack();\n    this.name = name;\n    this.message = msg;\n}\nderive(DexieError).from(Error).extend({\n    stack: {\n        get: function () {\n            return this._stack ||\n                (this._stack = this.name + \": \" + this.message + prettyStack(this._e, 2));\n        }\n    },\n    toString: function () { return this.name + \": \" + this.message; }\n});\nfunction getMultiErrorMessage(msg, failures) {\n    return msg + \". Errors: \" + Object.keys(failures)\n        .map(key => failures[key].toString())\n        .filter((v, i, s) => s.indexOf(v) === i)\n        .join('\\n');\n}\nfunction ModifyError(msg, failures, successCount, failedKeys) {\n    this._e = getErrorWithStack();\n    this.failures = failures;\n    this.failedKeys = failedKeys;\n    this.successCount = successCount;\n    this.message = getMultiErrorMessage(msg, failures);\n}\nderive(ModifyError).from(DexieError);\nfunction BulkError(msg, failures) {\n    this._e = getErrorWithStack();\n    this.name = \"BulkError\";\n    this.failures = Object.keys(failures).map(pos => failures[pos]);\n    this.failuresByPos = failures;\n    this.message = getMultiErrorMessage(msg, failures);\n}\nderive(BulkError).from(DexieError);\nvar errnames = errorList.reduce((obj, name) => (obj[name] = name + \"Error\", obj), {});\nconst BaseException = DexieError;\nvar exceptions = errorList.reduce((obj, name) => {\n    var fullName = name + \"Error\";\n    function DexieError(msgOrInner, inner) {\n        this._e = getErrorWithStack();\n        this.name = fullName;\n        if (!msgOrInner) {\n            this.message = defaultTexts[name] || fullName;\n            this.inner = null;\n        }\n        else if (typeof msgOrInner === 'string') {\n            this.message = `${msgOrInner}${!inner ? '' : '\\n ' + inner}`;\n            this.inner = inner || null;\n        }\n        else if (typeof msgOrInner === 'object') {\n            this.message = `${msgOrInner.name} ${msgOrInner.message}`;\n            this.inner = msgOrInner;\n        }\n    }\n    derive(DexieError).from(BaseException);\n    obj[name] = DexieError;\n    return obj;\n}, {});\nexceptions.Syntax = SyntaxError;\nexceptions.Type = TypeError;\nexceptions.Range = RangeError;\nvar exceptionMap = idbDomErrorNames.reduce((obj, name) => {\n    obj[name + \"Error\"] = exceptions[name];\n    return obj;\n}, {});\nfunction mapError(domError, message) {\n    if (!domError || domError instanceof DexieError || domError instanceof TypeError || domError instanceof SyntaxError || !domError.name || !exceptionMap[domError.name])\n        return domError;\n    var rv = new exceptionMap[domError.name](message || domError.message, domError);\n    if (\"stack\" in domError) {\n        setProp(rv, \"stack\", { get: function () {\n                return this.inner.stack;\n            } });\n    }\n    return rv;\n}\nvar fullNameExceptions = errorList.reduce((obj, name) => {\n    if ([\"Syntax\", \"Type\", \"Range\"].indexOf(name) === -1)\n        obj[name + \"Error\"] = exceptions[name];\n    return obj;\n}, {});\nfullNameExceptions.ModifyError = ModifyError;\nfullNameExceptions.DexieError = DexieError;\nfullNameExceptions.BulkError = BulkError;\n\nfunction nop() { }\nfunction mirror(val) { return val; }\nfunction pureFunctionChain(f1, f2) {\n    if (f1 == null || f1 === mirror)\n        return f2;\n    return function (val) {\n        return f2(f1(val));\n    };\n}\nfunction callBoth(on1, on2) {\n    return function () {\n        on1.apply(this, arguments);\n        on2.apply(this, arguments);\n    };\n}\nfunction hookCreatingChain(f1, f2) {\n    if (f1 === nop)\n        return f2;\n    return function () {\n        var res = f1.apply(this, arguments);\n        if (res !== undefined)\n            arguments[0] = res;\n        var onsuccess = this.onsuccess,\n        onerror = this.onerror;\n        this.onsuccess = null;\n        this.onerror = null;\n        var res2 = f2.apply(this, arguments);\n        if (onsuccess)\n            this.onsuccess = this.onsuccess ? callBoth(onsuccess, this.onsuccess) : onsuccess;\n        if (onerror)\n            this.onerror = this.onerror ? callBoth(onerror, this.onerror) : onerror;\n        return res2 !== undefined ? res2 : res;\n    };\n}\nfunction hookDeletingChain(f1, f2) {\n    if (f1 === nop)\n        return f2;\n    return function () {\n        f1.apply(this, arguments);\n        var onsuccess = this.onsuccess,\n        onerror = this.onerror;\n        this.onsuccess = this.onerror = null;\n        f2.apply(this, arguments);\n        if (onsuccess)\n            this.onsuccess = this.onsuccess ? callBoth(onsuccess, this.onsuccess) : onsuccess;\n        if (onerror)\n            this.onerror = this.onerror ? callBoth(onerror, this.onerror) : onerror;\n    };\n}\nfunction hookUpdatingChain(f1, f2) {\n    if (f1 === nop)\n        return f2;\n    return function (modifications) {\n        var res = f1.apply(this, arguments);\n        extend(modifications, res);\n        var onsuccess = this.onsuccess,\n        onerror = this.onerror;\n        this.onsuccess = null;\n        this.onerror = null;\n        var res2 = f2.apply(this, arguments);\n        if (onsuccess)\n            this.onsuccess = this.onsuccess ? callBoth(onsuccess, this.onsuccess) : onsuccess;\n        if (onerror)\n            this.onerror = this.onerror ? callBoth(onerror, this.onerror) : onerror;\n        return res === undefined ?\n            (res2 === undefined ? undefined : res2) :\n            (extend(res, res2));\n    };\n}\nfunction reverseStoppableEventChain(f1, f2) {\n    if (f1 === nop)\n        return f2;\n    return function () {\n        if (f2.apply(this, arguments) === false)\n            return false;\n        return f1.apply(this, arguments);\n    };\n}\nfunction promisableChain(f1, f2) {\n    if (f1 === nop)\n        return f2;\n    return function () {\n        var res = f1.apply(this, arguments);\n        if (res && typeof res.then === 'function') {\n            var thiz = this, i = arguments.length, args = new Array(i);\n            while (i--)\n                args[i] = arguments[i];\n            return res.then(function () {\n                return f2.apply(thiz, args);\n            });\n        }\n        return f2.apply(this, arguments);\n    };\n}\n\nvar INTERNAL = {};\nconst LONG_STACKS_CLIP_LIMIT = 100,\nMAX_LONG_STACKS = 20, ZONE_ECHO_LIMIT = 100, [resolvedNativePromise, nativePromiseProto, resolvedGlobalPromise] = typeof Promise === 'undefined' ?\n    [] :\n    (() => {\n        let globalP = Promise.resolve();\n        if (typeof crypto === 'undefined' || !crypto.subtle)\n            return [globalP, getProto(globalP), globalP];\n        const nativeP = crypto.subtle.digest(\"SHA-512\", new Uint8Array([0]));\n        return [\n            nativeP,\n            getProto(nativeP),\n            globalP\n        ];\n    })(), nativePromiseThen = nativePromiseProto && nativePromiseProto.then;\nconst NativePromise = resolvedNativePromise && resolvedNativePromise.constructor;\nconst patchGlobalPromise = !!resolvedGlobalPromise;\nvar stack_being_generated = false;\nvar schedulePhysicalTick = resolvedGlobalPromise ?\n    () => { resolvedGlobalPromise.then(physicalTick); }\n    :\n        _global.setImmediate ?\n            setImmediate.bind(null, physicalTick) :\n            _global.MutationObserver ?\n                () => {\n                    var hiddenDiv = document.createElement(\"div\");\n                    (new MutationObserver(() => {\n                        physicalTick();\n                        hiddenDiv = null;\n                    })).observe(hiddenDiv, { attributes: true });\n                    hiddenDiv.setAttribute('i', '1');\n                } :\n                () => { setTimeout(physicalTick, 0); };\nvar asap = function (callback, args) {\n    microtickQueue.push([callback, args]);\n    if (needsNewPhysicalTick) {\n        schedulePhysicalTick();\n        needsNewPhysicalTick = false;\n    }\n};\nvar isOutsideMicroTick = true,\nneedsNewPhysicalTick = true,\nunhandledErrors = [],\nrejectingErrors = [],\ncurrentFulfiller = null, rejectionMapper = mirror;\nvar globalPSD = {\n    id: 'global',\n    global: true,\n    ref: 0,\n    unhandleds: [],\n    onunhandled: globalError,\n    pgp: false,\n    env: {},\n    finalize: function () {\n        this.unhandleds.forEach(uh => {\n            try {\n                globalError(uh[0], uh[1]);\n            }\n            catch (e) { }\n        });\n    }\n};\nvar PSD = globalPSD;\nvar microtickQueue = [];\nvar numScheduledCalls = 0;\nvar tickFinalizers = [];\nfunction DexiePromise(fn) {\n    if (typeof this !== 'object')\n        throw new TypeError('Promises must be constructed via new');\n    this._listeners = [];\n    this.onuncatched = nop;\n    this._lib = false;\n    var psd = (this._PSD = PSD);\n    if (debug) {\n        this._stackHolder = getErrorWithStack();\n        this._prev = null;\n        this._numPrev = 0;\n    }\n    if (typeof fn !== 'function') {\n        if (fn !== INTERNAL)\n            throw new TypeError('Not a function');\n        this._state = arguments[1];\n        this._value = arguments[2];\n        if (this._state === false)\n            handleRejection(this, this._value);\n        return;\n    }\n    this._state = null;\n    this._value = null;\n    ++psd.ref;\n    executePromiseTask(this, fn);\n}\nconst thenProp = {\n    get: function () {\n        var psd = PSD, microTaskId = totalEchoes;\n        function then(onFulfilled, onRejected) {\n            var possibleAwait = !psd.global && (psd !== PSD || microTaskId !== totalEchoes);\n            const cleanup = possibleAwait && !decrementExpectedAwaits();\n            var rv = new DexiePromise((resolve, reject) => {\n                propagateToListener(this, new Listener(nativeAwaitCompatibleWrap(onFulfilled, psd, possibleAwait, cleanup), nativeAwaitCompatibleWrap(onRejected, psd, possibleAwait, cleanup), resolve, reject, psd));\n            });\n            debug && linkToPreviousPromise(rv, this);\n            return rv;\n        }\n        then.prototype = INTERNAL;\n        return then;\n    },\n    set: function (value) {\n        setProp(this, 'then', value && value.prototype === INTERNAL ?\n            thenProp :\n            {\n                get: function () {\n                    return value;\n                },\n                set: thenProp.set\n            });\n    }\n};\nprops(DexiePromise.prototype, {\n    then: thenProp,\n    _then: function (onFulfilled, onRejected) {\n        propagateToListener(this, new Listener(null, null, onFulfilled, onRejected, PSD));\n    },\n    catch: function (onRejected) {\n        if (arguments.length === 1)\n            return this.then(null, onRejected);\n        var type = arguments[0], handler = arguments[1];\n        return typeof type === 'function' ? this.then(null, err =>\n        err instanceof type ? handler(err) : PromiseReject(err))\n            : this.then(null, err =>\n            err && err.name === type ? handler(err) : PromiseReject(err));\n    },\n    finally: function (onFinally) {\n        return this.then(value => {\n            onFinally();\n            return value;\n        }, err => {\n            onFinally();\n            return PromiseReject(err);\n        });\n    },\n    stack: {\n        get: function () {\n            if (this._stack)\n                return this._stack;\n            try {\n                stack_being_generated = true;\n                var stacks = getStack(this, [], MAX_LONG_STACKS);\n                var stack = stacks.join(\"\\nFrom previous: \");\n                if (this._state !== null)\n                    this._stack = stack;\n                return stack;\n            }\n            finally {\n                stack_being_generated = false;\n            }\n        }\n    },\n    timeout: function (ms, msg) {\n        return ms < Infinity ?\n            new DexiePromise((resolve, reject) => {\n                var handle = setTimeout(() => reject(new exceptions.Timeout(msg)), ms);\n                this.then(resolve, reject).finally(clearTimeout.bind(null, handle));\n            }) : this;\n    }\n});\nif (typeof Symbol !== 'undefined' && Symbol.toStringTag)\n    setProp(DexiePromise.prototype, Symbol.toStringTag, 'Dexie.Promise');\nglobalPSD.env = snapShot();\nfunction Listener(onFulfilled, onRejected, resolve, reject, zone) {\n    this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n    this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n    this.resolve = resolve;\n    this.reject = reject;\n    this.psd = zone;\n}\nprops(DexiePromise, {\n    all: function () {\n        var values = getArrayOf.apply(null, arguments)\n            .map(onPossibleParallellAsync);\n        return new DexiePromise(function (resolve, reject) {\n            if (values.length === 0)\n                resolve([]);\n            var remaining = values.length;\n            values.forEach((a, i) => DexiePromise.resolve(a).then(x => {\n                values[i] = x;\n                if (!--remaining)\n                    resolve(values);\n            }, reject));\n        });\n    },\n    resolve: value => {\n        if (value instanceof DexiePromise)\n            return value;\n        if (value && typeof value.then === 'function')\n            return new DexiePromise((resolve, reject) => {\n                value.then(resolve, reject);\n            });\n        var rv = new DexiePromise(INTERNAL, true, value);\n        linkToPreviousPromise(rv, currentFulfiller);\n        return rv;\n    },\n    reject: PromiseReject,\n    race: function () {\n        var values = getArrayOf.apply(null, arguments).map(onPossibleParallellAsync);\n        return new DexiePromise((resolve, reject) => {\n            values.map(value => DexiePromise.resolve(value).then(resolve, reject));\n        });\n    },\n    PSD: {\n        get: () => PSD,\n        set: value => PSD = value\n    },\n    totalEchoes: { get: () => totalEchoes },\n    newPSD: newScope,\n    usePSD: usePSD,\n    scheduler: {\n        get: () => asap,\n        set: value => { asap = value; }\n    },\n    rejectionMapper: {\n        get: () => rejectionMapper,\n        set: value => { rejectionMapper = value; }\n    },\n    follow: (fn, zoneProps) => {\n        return new DexiePromise((resolve, reject) => {\n            return newScope((resolve, reject) => {\n                var psd = PSD;\n                psd.unhandleds = [];\n                psd.onunhandled = reject;\n                psd.finalize = callBoth(function () {\n                    run_at_end_of_this_or_next_physical_tick(() => {\n                        this.unhandleds.length === 0 ? resolve() : reject(this.unhandleds[0]);\n                    });\n                }, psd.finalize);\n                fn();\n            }, zoneProps, resolve, reject);\n        });\n    }\n});\nif (NativePromise) {\n    if (NativePromise.allSettled)\n        setProp(DexiePromise, \"allSettled\", function () {\n            const possiblePromises = getArrayOf.apply(null, arguments).map(onPossibleParallellAsync);\n            return new DexiePromise(resolve => {\n                if (possiblePromises.length === 0)\n                    resolve([]);\n                let remaining = possiblePromises.length;\n                const results = new Array(remaining);\n                possiblePromises.forEach((p, i) => DexiePromise.resolve(p).then(value => results[i] = { status: \"fulfilled\", value }, reason => results[i] = { status: \"rejected\", reason })\n                    .then(() => --remaining || resolve(results)));\n            });\n        });\n    if (NativePromise.any && typeof AggregateError !== 'undefined')\n        setProp(DexiePromise, \"any\", function () {\n            const possiblePromises = getArrayOf.apply(null, arguments).map(onPossibleParallellAsync);\n            return new DexiePromise((resolve, reject) => {\n                if (possiblePromises.length === 0)\n                    reject(new AggregateError([]));\n                let remaining = possiblePromises.length;\n                const failures = new Array(remaining);\n                possiblePromises.forEach((p, i) => DexiePromise.resolve(p).then(value => resolve(value), failure => {\n                    failures[i] = failure;\n                    if (!--remaining)\n                        reject(new AggregateError(failures));\n                }));\n            });\n        });\n}\nfunction executePromiseTask(promise, fn) {\n    try {\n        fn(value => {\n            if (promise._state !== null)\n                return;\n            if (value === promise)\n                throw new TypeError('A promise cannot be resolved with itself.');\n            var shouldExecuteTick = promise._lib && beginMicroTickScope();\n            if (value && typeof value.then === 'function') {\n                executePromiseTask(promise, (resolve, reject) => {\n                    value instanceof DexiePromise ?\n                        value._then(resolve, reject) :\n                        value.then(resolve, reject);\n                });\n            }\n            else {\n                promise._state = true;\n                promise._value = value;\n                propagateAllListeners(promise);\n            }\n            if (shouldExecuteTick)\n                endMicroTickScope();\n        }, handleRejection.bind(null, promise));\n    }\n    catch (ex) {\n        handleRejection(promise, ex);\n    }\n}\nfunction handleRejection(promise, reason) {\n    rejectingErrors.push(reason);\n    if (promise._state !== null)\n        return;\n    var shouldExecuteTick = promise._lib && beginMicroTickScope();\n    reason = rejectionMapper(reason);\n    promise._state = false;\n    promise._value = reason;\n    debug && reason !== null && typeof reason === 'object' && !reason._promise && tryCatch(() => {\n        var origProp = getPropertyDescriptor(reason, \"stack\");\n        reason._promise = promise;\n        setProp(reason, \"stack\", {\n            get: () => stack_being_generated ?\n                origProp && (origProp.get ?\n                    origProp.get.apply(reason) :\n                    origProp.value) :\n                promise.stack\n        });\n    });\n    addPossiblyUnhandledError(promise);\n    propagateAllListeners(promise);\n    if (shouldExecuteTick)\n        endMicroTickScope();\n}\nfunction propagateAllListeners(promise) {\n    var listeners = promise._listeners;\n    promise._listeners = [];\n    for (var i = 0, len = listeners.length; i < len; ++i) {\n        propagateToListener(promise, listeners[i]);\n    }\n    var psd = promise._PSD;\n    --psd.ref || psd.finalize();\n    if (numScheduledCalls === 0) {\n        ++numScheduledCalls;\n        asap(() => {\n            if (--numScheduledCalls === 0)\n                finalizePhysicalTick();\n        }, []);\n    }\n}\nfunction propagateToListener(promise, listener) {\n    if (promise._state === null) {\n        promise._listeners.push(listener);\n        return;\n    }\n    var cb = promise._state ? listener.onFulfilled : listener.onRejected;\n    if (cb === null) {\n        return (promise._state ? listener.resolve : listener.reject)(promise._value);\n    }\n    ++listener.psd.ref;\n    ++numScheduledCalls;\n    asap(callListener, [cb, promise, listener]);\n}\nfunction callListener(cb, promise, listener) {\n    try {\n        currentFulfiller = promise;\n        var ret, value = promise._value;\n        if (promise._state) {\n            ret = cb(value);\n        }\n        else {\n            if (rejectingErrors.length)\n                rejectingErrors = [];\n            ret = cb(value);\n            if (rejectingErrors.indexOf(value) === -1)\n                markErrorAsHandled(promise);\n        }\n        listener.resolve(ret);\n    }\n    catch (e) {\n        listener.reject(e);\n    }\n    finally {\n        currentFulfiller = null;\n        if (--numScheduledCalls === 0)\n            finalizePhysicalTick();\n        --listener.psd.ref || listener.psd.finalize();\n    }\n}\nfunction getStack(promise, stacks, limit) {\n    if (stacks.length === limit)\n        return stacks;\n    var stack = \"\";\n    if (promise._state === false) {\n        var failure = promise._value, errorName, message;\n        if (failure != null) {\n            errorName = failure.name || \"Error\";\n            message = failure.message || failure;\n            stack = prettyStack(failure, 0);\n        }\n        else {\n            errorName = failure;\n            message = \"\";\n        }\n        stacks.push(errorName + (message ? \": \" + message : \"\") + stack);\n    }\n    if (debug) {\n        stack = prettyStack(promise._stackHolder, 2);\n        if (stack && stacks.indexOf(stack) === -1)\n            stacks.push(stack);\n        if (promise._prev)\n            getStack(promise._prev, stacks, limit);\n    }\n    return stacks;\n}\nfunction linkToPreviousPromise(promise, prev) {\n    var numPrev = prev ? prev._numPrev + 1 : 0;\n    if (numPrev < LONG_STACKS_CLIP_LIMIT) {\n        promise._prev = prev;\n        promise._numPrev = numPrev;\n    }\n}\nfunction physicalTick() {\n    beginMicroTickScope() && endMicroTickScope();\n}\nfunction beginMicroTickScope() {\n    var wasRootExec = isOutsideMicroTick;\n    isOutsideMicroTick = false;\n    needsNewPhysicalTick = false;\n    return wasRootExec;\n}\nfunction endMicroTickScope() {\n    var callbacks, i, l;\n    do {\n        while (microtickQueue.length > 0) {\n            callbacks = microtickQueue;\n            microtickQueue = [];\n            l = callbacks.length;\n            for (i = 0; i < l; ++i) {\n                var item = callbacks[i];\n                item[0].apply(null, item[1]);\n            }\n        }\n    } while (microtickQueue.length > 0);\n    isOutsideMicroTick = true;\n    needsNewPhysicalTick = true;\n}\nfunction finalizePhysicalTick() {\n    var unhandledErrs = unhandledErrors;\n    unhandledErrors = [];\n    unhandledErrs.forEach(p => {\n        p._PSD.onunhandled.call(null, p._value, p);\n    });\n    var finalizers = tickFinalizers.slice(0);\n    var i = finalizers.length;\n    while (i)\n        finalizers[--i]();\n}\nfunction run_at_end_of_this_or_next_physical_tick(fn) {\n    function finalizer() {\n        fn();\n        tickFinalizers.splice(tickFinalizers.indexOf(finalizer), 1);\n    }\n    tickFinalizers.push(finalizer);\n    ++numScheduledCalls;\n    asap(() => {\n        if (--numScheduledCalls === 0)\n            finalizePhysicalTick();\n    }, []);\n}\nfunction addPossiblyUnhandledError(promise) {\n    if (!unhandledErrors.some(p => p._value === promise._value))\n        unhandledErrors.push(promise);\n}\nfunction markErrorAsHandled(promise) {\n    var i = unhandledErrors.length;\n    while (i)\n        if (unhandledErrors[--i]._value === promise._value) {\n            unhandledErrors.splice(i, 1);\n            return;\n        }\n}\nfunction PromiseReject(reason) {\n    return new DexiePromise(INTERNAL, false, reason);\n}\nfunction wrap(fn, errorCatcher) {\n    var psd = PSD;\n    return function () {\n        var wasRootExec = beginMicroTickScope(), outerScope = PSD;\n        try {\n            switchToZone(psd, true);\n            return fn.apply(this, arguments);\n        }\n        catch (e) {\n            errorCatcher && errorCatcher(e);\n        }\n        finally {\n            switchToZone(outerScope, false);\n            if (wasRootExec)\n                endMicroTickScope();\n        }\n    };\n}\nconst task = { awaits: 0, echoes: 0, id: 0 };\nvar taskCounter = 0;\nvar zoneStack = [];\nvar zoneEchoes = 0;\nvar totalEchoes = 0;\nvar zone_id_counter = 0;\nfunction newScope(fn, props, a1, a2) {\n    var parent = PSD, psd = Object.create(parent);\n    psd.parent = parent;\n    psd.ref = 0;\n    psd.global = false;\n    psd.id = ++zone_id_counter;\n    var globalEnv = globalPSD.env;\n    psd.env = patchGlobalPromise ? {\n        Promise: DexiePromise,\n        PromiseProp: { value: DexiePromise, configurable: true, writable: true },\n        all: DexiePromise.all,\n        race: DexiePromise.race,\n        allSettled: DexiePromise.allSettled,\n        any: DexiePromise.any,\n        resolve: DexiePromise.resolve,\n        reject: DexiePromise.reject,\n        nthen: getPatchedPromiseThen(globalEnv.nthen, psd),\n        gthen: getPatchedPromiseThen(globalEnv.gthen, psd)\n    } : {};\n    if (props)\n        extend(psd, props);\n    ++parent.ref;\n    psd.finalize = function () {\n        --this.parent.ref || this.parent.finalize();\n    };\n    var rv = usePSD(psd, fn, a1, a2);\n    if (psd.ref === 0)\n        psd.finalize();\n    return rv;\n}\nfunction incrementExpectedAwaits() {\n    if (!task.id)\n        task.id = ++taskCounter;\n    ++task.awaits;\n    task.echoes += ZONE_ECHO_LIMIT;\n    return task.id;\n}\nfunction decrementExpectedAwaits() {\n    if (!task.awaits)\n        return false;\n    if (--task.awaits === 0)\n        task.id = 0;\n    task.echoes = task.awaits * ZONE_ECHO_LIMIT;\n    return true;\n}\nif (('' + nativePromiseThen).indexOf('[native code]') === -1) {\n    incrementExpectedAwaits = decrementExpectedAwaits = nop;\n}\nfunction onPossibleParallellAsync(possiblePromise) {\n    if (task.echoes && possiblePromise && possiblePromise.constructor === NativePromise) {\n        incrementExpectedAwaits();\n        return possiblePromise.then(x => {\n            decrementExpectedAwaits();\n            return x;\n        }, e => {\n            decrementExpectedAwaits();\n            return rejection(e);\n        });\n    }\n    return possiblePromise;\n}\nfunction zoneEnterEcho(targetZone) {\n    ++totalEchoes;\n    if (!task.echoes || --task.echoes === 0) {\n        task.echoes = task.id = 0;\n    }\n    zoneStack.push(PSD);\n    switchToZone(targetZone, true);\n}\nfunction zoneLeaveEcho() {\n    var zone = zoneStack[zoneStack.length - 1];\n    zoneStack.pop();\n    switchToZone(zone, false);\n}\nfunction switchToZone(targetZone, bEnteringZone) {\n    var currentZone = PSD;\n    if (bEnteringZone ? task.echoes && (!zoneEchoes++ || targetZone !== PSD) : zoneEchoes && (!--zoneEchoes || targetZone !== PSD)) {\n        enqueueNativeMicroTask(bEnteringZone ? zoneEnterEcho.bind(null, targetZone) : zoneLeaveEcho);\n    }\n    if (targetZone === PSD)\n        return;\n    PSD = targetZone;\n    if (currentZone === globalPSD)\n        globalPSD.env = snapShot();\n    if (patchGlobalPromise) {\n        var GlobalPromise = globalPSD.env.Promise;\n        var targetEnv = targetZone.env;\n        nativePromiseProto.then = targetEnv.nthen;\n        GlobalPromise.prototype.then = targetEnv.gthen;\n        if (currentZone.global || targetZone.global) {\n            Object.defineProperty(_global, 'Promise', targetEnv.PromiseProp);\n            GlobalPromise.all = targetEnv.all;\n            GlobalPromise.race = targetEnv.race;\n            GlobalPromise.resolve = targetEnv.resolve;\n            GlobalPromise.reject = targetEnv.reject;\n            if (targetEnv.allSettled)\n                GlobalPromise.allSettled = targetEnv.allSettled;\n            if (targetEnv.any)\n                GlobalPromise.any = targetEnv.any;\n        }\n    }\n}\nfunction snapShot() {\n    var GlobalPromise = _global.Promise;\n    return patchGlobalPromise ? {\n        Promise: GlobalPromise,\n        PromiseProp: Object.getOwnPropertyDescriptor(_global, \"Promise\"),\n        all: GlobalPromise.all,\n        race: GlobalPromise.race,\n        allSettled: GlobalPromise.allSettled,\n        any: GlobalPromise.any,\n        resolve: GlobalPromise.resolve,\n        reject: GlobalPromise.reject,\n        nthen: nativePromiseProto.then,\n        gthen: GlobalPromise.prototype.then\n    } : {};\n}\nfunction usePSD(psd, fn, a1, a2, a3) {\n    var outerScope = PSD;\n    try {\n        switchToZone(psd, true);\n        return fn(a1, a2, a3);\n    }\n    finally {\n        switchToZone(outerScope, false);\n    }\n}\nfunction enqueueNativeMicroTask(job) {\n    nativePromiseThen.call(resolvedNativePromise, job);\n}\nfunction nativeAwaitCompatibleWrap(fn, zone, possibleAwait, cleanup) {\n    return typeof fn !== 'function' ? fn : function () {\n        var outerZone = PSD;\n        if (possibleAwait)\n            incrementExpectedAwaits();\n        switchToZone(zone, true);\n        try {\n            return fn.apply(this, arguments);\n        }\n        finally {\n            switchToZone(outerZone, false);\n            if (cleanup)\n                enqueueNativeMicroTask(decrementExpectedAwaits);\n        }\n    };\n}\nfunction getPatchedPromiseThen(origThen, zone) {\n    return function (onResolved, onRejected) {\n        return origThen.call(this, nativeAwaitCompatibleWrap(onResolved, zone), nativeAwaitCompatibleWrap(onRejected, zone));\n    };\n}\nconst UNHANDLEDREJECTION = \"unhandledrejection\";\nfunction globalError(err, promise) {\n    var rv;\n    try {\n        rv = promise.onuncatched(err);\n    }\n    catch (e) { }\n    if (rv !== false)\n        try {\n            var event, eventData = { promise: promise, reason: err };\n            if (_global.document && document.createEvent) {\n                event = document.createEvent('Event');\n                event.initEvent(UNHANDLEDREJECTION, true, true);\n                extend(event, eventData);\n            }\n            else if (_global.CustomEvent) {\n                event = new CustomEvent(UNHANDLEDREJECTION, { detail: eventData });\n                extend(event, eventData);\n            }\n            if (event && _global.dispatchEvent) {\n                dispatchEvent(event);\n                if (!_global.PromiseRejectionEvent && _global.onunhandledrejection)\n                    try {\n                        _global.onunhandledrejection(event);\n                    }\n                    catch (_) { }\n            }\n            if (debug && event && !event.defaultPrevented) {\n                console.warn(`Unhandled rejection: ${err.stack || err}`);\n            }\n        }\n        catch (e) { }\n}\nvar rejection = DexiePromise.reject;\n\nfunction tempTransaction(db, mode, storeNames, fn) {\n    if (!db.idbdb || (!db._state.openComplete && (!PSD.letThrough && !db._vip))) {\n        if (db._state.openComplete) {\n            return rejection(new exceptions.DatabaseClosed(db._state.dbOpenError));\n        }\n        if (!db._state.isBeingOpened) {\n            if (!db._options.autoOpen)\n                return rejection(new exceptions.DatabaseClosed());\n            db.open().catch(nop);\n        }\n        return db._state.dbReadyPromise.then(() => tempTransaction(db, mode, storeNames, fn));\n    }\n    else {\n        var trans = db._createTransaction(mode, storeNames, db._dbSchema);\n        try {\n            trans.create();\n            db._state.PR1398_maxLoop = 3;\n        }\n        catch (ex) {\n            if (ex.name === errnames.InvalidState && db.isOpen() && --db._state.PR1398_maxLoop > 0) {\n                console.warn('Dexie: Need to reopen db');\n                db._close();\n                return db.open().then(() => tempTransaction(db, mode, storeNames, fn));\n            }\n            return rejection(ex);\n        }\n        return trans._promise(mode, (resolve, reject) => {\n            return newScope(() => {\n                PSD.trans = trans;\n                return fn(resolve, reject, trans);\n            });\n        }).then(result => {\n            return trans._completion.then(() => result);\n        });\n    }\n}\n\nconst DEXIE_VERSION = '3.2.7';\nconst maxString = String.fromCharCode(65535);\nconst minKey = -Infinity;\nconst INVALID_KEY_ARGUMENT = \"Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.\";\nconst STRING_EXPECTED = \"String expected.\";\nconst connections = [];\nconst isIEOrEdge = typeof navigator !== 'undefined' && /(MSIE|Trident|Edge)/.test(navigator.userAgent);\nconst hasIEDeleteObjectStoreBug = isIEOrEdge;\nconst hangsOnDeleteLargeKeyRange = isIEOrEdge;\nconst dexieStackFrameFilter = frame => !/(dexie\\.js|dexie\\.min\\.js)/.test(frame);\nconst DBNAMES_DB = '__dbnames';\nconst READONLY = 'readonly';\nconst READWRITE = 'readwrite';\n\nfunction combine(filter1, filter2) {\n    return filter1 ?\n        filter2 ?\n            function () { return filter1.apply(this, arguments) && filter2.apply(this, arguments); } :\n            filter1 :\n        filter2;\n}\n\nconst AnyRange = {\n    type: 3 ,\n    lower: -Infinity,\n    lowerOpen: false,\n    upper: [[]],\n    upperOpen: false\n};\n\nfunction workaroundForUndefinedPrimKey(keyPath) {\n    return typeof keyPath === \"string\" && !/\\./.test(keyPath)\n        ? (obj) => {\n            if (obj[keyPath] === undefined && (keyPath in obj)) {\n                obj = deepClone(obj);\n                delete obj[keyPath];\n            }\n            return obj;\n        }\n        : (obj) => obj;\n}\n\nclass Table {\n    _trans(mode, fn, writeLocked) {\n        const trans = this._tx || PSD.trans;\n        const tableName = this.name;\n        function checkTableInTransaction(resolve, reject, trans) {\n            if (!trans.schema[tableName])\n                throw new exceptions.NotFound(\"Table \" + tableName + \" not part of transaction\");\n            return fn(trans.idbtrans, trans);\n        }\n        const wasRootExec = beginMicroTickScope();\n        try {\n            return trans && trans.db === this.db ?\n                trans === PSD.trans ?\n                    trans._promise(mode, checkTableInTransaction, writeLocked) :\n                    newScope(() => trans._promise(mode, checkTableInTransaction, writeLocked), { trans: trans, transless: PSD.transless || PSD }) :\n                tempTransaction(this.db, mode, [this.name], checkTableInTransaction);\n        }\n        finally {\n            if (wasRootExec)\n                endMicroTickScope();\n        }\n    }\n    get(keyOrCrit, cb) {\n        if (keyOrCrit && keyOrCrit.constructor === Object)\n            return this.where(keyOrCrit).first(cb);\n        return this._trans('readonly', (trans) => {\n            return this.core.get({ trans, key: keyOrCrit })\n                .then(res => this.hook.reading.fire(res));\n        }).then(cb);\n    }\n    where(indexOrCrit) {\n        if (typeof indexOrCrit === 'string')\n            return new this.db.WhereClause(this, indexOrCrit);\n        if (isArray(indexOrCrit))\n            return new this.db.WhereClause(this, `[${indexOrCrit.join('+')}]`);\n        const keyPaths = keys(indexOrCrit);\n        if (keyPaths.length === 1)\n            return this\n                .where(keyPaths[0])\n                .equals(indexOrCrit[keyPaths[0]]);\n        const compoundIndex = this.schema.indexes.concat(this.schema.primKey).filter(ix => {\n            if (ix.compound &&\n                keyPaths.every(keyPath => ix.keyPath.indexOf(keyPath) >= 0)) {\n                for (let i = 0; i < keyPaths.length; ++i) {\n                    if (keyPaths.indexOf(ix.keyPath[i]) === -1)\n                        return false;\n                }\n                return true;\n            }\n            return false;\n        }).sort((a, b) => a.keyPath.length - b.keyPath.length)[0];\n        if (compoundIndex && this.db._maxKey !== maxString) {\n            const keyPathsInValidOrder = compoundIndex.keyPath.slice(0, keyPaths.length);\n            return this\n                .where(keyPathsInValidOrder)\n                .equals(keyPathsInValidOrder.map(kp => indexOrCrit[kp]));\n        }\n        if (!compoundIndex && debug)\n            console.warn(`The query ${JSON.stringify(indexOrCrit)} on ${this.name} would benefit of a ` +\n                `compound index [${keyPaths.join('+')}]`);\n        const { idxByName } = this.schema;\n        const idb = this.db._deps.indexedDB;\n        function equals(a, b) {\n            try {\n                return idb.cmp(a, b) === 0;\n            }\n            catch (e) {\n                return false;\n            }\n        }\n        const [idx, filterFunction] = keyPaths.reduce(([prevIndex, prevFilterFn], keyPath) => {\n            const index = idxByName[keyPath];\n            const value = indexOrCrit[keyPath];\n            return [\n                prevIndex || index,\n                prevIndex || !index ?\n                    combine(prevFilterFn, index && index.multi ?\n                        x => {\n                            const prop = getByKeyPath(x, keyPath);\n                            return isArray(prop) && prop.some(item => equals(value, item));\n                        } : x => equals(value, getByKeyPath(x, keyPath)))\n                    : prevFilterFn\n            ];\n        }, [null, null]);\n        return idx ?\n            this.where(idx.name).equals(indexOrCrit[idx.keyPath])\n                .filter(filterFunction) :\n            compoundIndex ?\n                this.filter(filterFunction) :\n                this.where(keyPaths).equals('');\n    }\n    filter(filterFunction) {\n        return this.toCollection().and(filterFunction);\n    }\n    count(thenShortcut) {\n        return this.toCollection().count(thenShortcut);\n    }\n    offset(offset) {\n        return this.toCollection().offset(offset);\n    }\n    limit(numRows) {\n        return this.toCollection().limit(numRows);\n    }\n    each(callback) {\n        return this.toCollection().each(callback);\n    }\n    toArray(thenShortcut) {\n        return this.toCollection().toArray(thenShortcut);\n    }\n    toCollection() {\n        return new this.db.Collection(new this.db.WhereClause(this));\n    }\n    orderBy(index) {\n        return new this.db.Collection(new this.db.WhereClause(this, isArray(index) ?\n            `[${index.join('+')}]` :\n            index));\n    }\n    reverse() {\n        return this.toCollection().reverse();\n    }\n    mapToClass(constructor) {\n        this.schema.mappedClass = constructor;\n        const readHook = obj => {\n            if (!obj)\n                return obj;\n            const res = Object.create(constructor.prototype);\n            for (var m in obj)\n                if (hasOwn(obj, m))\n                    try {\n                        res[m] = obj[m];\n                    }\n                    catch (_) { }\n            return res;\n        };\n        if (this.schema.readHook) {\n            this.hook.reading.unsubscribe(this.schema.readHook);\n        }\n        this.schema.readHook = readHook;\n        this.hook(\"reading\", readHook);\n        return constructor;\n    }\n    defineClass() {\n        function Class(content) {\n            extend(this, content);\n        }\n        return this.mapToClass(Class);\n    }\n    add(obj, key) {\n        const { auto, keyPath } = this.schema.primKey;\n        let objToAdd = obj;\n        if (keyPath && auto) {\n            objToAdd = workaroundForUndefinedPrimKey(keyPath)(obj);\n        }\n        return this._trans('readwrite', trans => {\n            return this.core.mutate({ trans, type: 'add', keys: key != null ? [key] : null, values: [objToAdd] });\n        }).then(res => res.numFailures ? DexiePromise.reject(res.failures[0]) : res.lastResult)\n            .then(lastResult => {\n            if (keyPath) {\n                try {\n                    setByKeyPath(obj, keyPath, lastResult);\n                }\n                catch (_) { }\n            }\n            return lastResult;\n        });\n    }\n    update(keyOrObject, modifications) {\n        if (typeof keyOrObject === 'object' && !isArray(keyOrObject)) {\n            const key = getByKeyPath(keyOrObject, this.schema.primKey.keyPath);\n            if (key === undefined)\n                return rejection(new exceptions.InvalidArgument(\"Given object does not contain its primary key\"));\n            try {\n                if (typeof modifications !== \"function\") {\n                    keys(modifications).forEach(keyPath => {\n                        setByKeyPath(keyOrObject, keyPath, modifications[keyPath]);\n                    });\n                }\n                else {\n                    modifications(keyOrObject, { value: keyOrObject, primKey: key });\n                }\n            }\n            catch (_a) {\n            }\n            return this.where(\":id\").equals(key).modify(modifications);\n        }\n        else {\n            return this.where(\":id\").equals(keyOrObject).modify(modifications);\n        }\n    }\n    put(obj, key) {\n        const { auto, keyPath } = this.schema.primKey;\n        let objToAdd = obj;\n        if (keyPath && auto) {\n            objToAdd = workaroundForUndefinedPrimKey(keyPath)(obj);\n        }\n        return this._trans('readwrite', trans => this.core.mutate({ trans, type: 'put', values: [objToAdd], keys: key != null ? [key] : null }))\n            .then(res => res.numFailures ? DexiePromise.reject(res.failures[0]) : res.lastResult)\n            .then(lastResult => {\n            if (keyPath) {\n                try {\n                    setByKeyPath(obj, keyPath, lastResult);\n                }\n                catch (_) { }\n            }\n            return lastResult;\n        });\n    }\n    delete(key) {\n        return this._trans('readwrite', trans => this.core.mutate({ trans, type: 'delete', keys: [key] }))\n            .then(res => res.numFailures ? DexiePromise.reject(res.failures[0]) : undefined);\n    }\n    clear() {\n        return this._trans('readwrite', trans => this.core.mutate({ trans, type: 'deleteRange', range: AnyRange }))\n            .then(res => res.numFailures ? DexiePromise.reject(res.failures[0]) : undefined);\n    }\n    bulkGet(keys) {\n        return this._trans('readonly', trans => {\n            return this.core.getMany({\n                keys,\n                trans\n            }).then(result => result.map(res => this.hook.reading.fire(res)));\n        });\n    }\n    bulkAdd(objects, keysOrOptions, options) {\n        const keys = Array.isArray(keysOrOptions) ? keysOrOptions : undefined;\n        options = options || (keys ? undefined : keysOrOptions);\n        const wantResults = options ? options.allKeys : undefined;\n        return this._trans('readwrite', trans => {\n            const { auto, keyPath } = this.schema.primKey;\n            if (keyPath && keys)\n                throw new exceptions.InvalidArgument(\"bulkAdd(): keys argument invalid on tables with inbound keys\");\n            if (keys && keys.length !== objects.length)\n                throw new exceptions.InvalidArgument(\"Arguments objects and keys must have the same length\");\n            const numObjects = objects.length;\n            let objectsToAdd = keyPath && auto ?\n                objects.map(workaroundForUndefinedPrimKey(keyPath)) :\n                objects;\n            return this.core.mutate({ trans, type: 'add', keys: keys, values: objectsToAdd, wantResults })\n                .then(({ numFailures, results, lastResult, failures }) => {\n                const result = wantResults ? results : lastResult;\n                if (numFailures === 0)\n                    return result;\n                throw new BulkError(`${this.name}.bulkAdd(): ${numFailures} of ${numObjects} operations failed`, failures);\n            });\n        });\n    }\n    bulkPut(objects, keysOrOptions, options) {\n        const keys = Array.isArray(keysOrOptions) ? keysOrOptions : undefined;\n        options = options || (keys ? undefined : keysOrOptions);\n        const wantResults = options ? options.allKeys : undefined;\n        return this._trans('readwrite', trans => {\n            const { auto, keyPath } = this.schema.primKey;\n            if (keyPath && keys)\n                throw new exceptions.InvalidArgument(\"bulkPut(): keys argument invalid on tables with inbound keys\");\n            if (keys && keys.length !== objects.length)\n                throw new exceptions.InvalidArgument(\"Arguments objects and keys must have the same length\");\n            const numObjects = objects.length;\n            let objectsToPut = keyPath && auto ?\n                objects.map(workaroundForUndefinedPrimKey(keyPath)) :\n                objects;\n            return this.core.mutate({ trans, type: 'put', keys: keys, values: objectsToPut, wantResults })\n                .then(({ numFailures, results, lastResult, failures }) => {\n                const result = wantResults ? results : lastResult;\n                if (numFailures === 0)\n                    return result;\n                throw new BulkError(`${this.name}.bulkPut(): ${numFailures} of ${numObjects} operations failed`, failures);\n            });\n        });\n    }\n    bulkDelete(keys) {\n        const numKeys = keys.length;\n        return this._trans('readwrite', trans => {\n            return this.core.mutate({ trans, type: 'delete', keys: keys });\n        }).then(({ numFailures, lastResult, failures }) => {\n            if (numFailures === 0)\n                return lastResult;\n            throw new BulkError(`${this.name}.bulkDelete(): ${numFailures} of ${numKeys} operations failed`, failures);\n        });\n    }\n}\n\nfunction Events(ctx) {\n    var evs = {};\n    var rv = function (eventName, subscriber) {\n        if (subscriber) {\n            var i = arguments.length, args = new Array(i - 1);\n            while (--i)\n                args[i - 1] = arguments[i];\n            evs[eventName].subscribe.apply(null, args);\n            return ctx;\n        }\n        else if (typeof (eventName) === 'string') {\n            return evs[eventName];\n        }\n    };\n    rv.addEventType = add;\n    for (var i = 1, l = arguments.length; i < l; ++i) {\n        add(arguments[i]);\n    }\n    return rv;\n    function add(eventName, chainFunction, defaultFunction) {\n        if (typeof eventName === 'object')\n            return addConfiguredEvents(eventName);\n        if (!chainFunction)\n            chainFunction = reverseStoppableEventChain;\n        if (!defaultFunction)\n            defaultFunction = nop;\n        var context = {\n            subscribers: [],\n            fire: defaultFunction,\n            subscribe: function (cb) {\n                if (context.subscribers.indexOf(cb) === -1) {\n                    context.subscribers.push(cb);\n                    context.fire = chainFunction(context.fire, cb);\n                }\n            },\n            unsubscribe: function (cb) {\n                context.subscribers = context.subscribers.filter(function (fn) { return fn !== cb; });\n                context.fire = context.subscribers.reduce(chainFunction, defaultFunction);\n            }\n        };\n        evs[eventName] = rv[eventName] = context;\n        return context;\n    }\n    function addConfiguredEvents(cfg) {\n        keys(cfg).forEach(function (eventName) {\n            var args = cfg[eventName];\n            if (isArray(args)) {\n                add(eventName, cfg[eventName][0], cfg[eventName][1]);\n            }\n            else if (args === 'asap') {\n                var context = add(eventName, mirror, function fire() {\n                    var i = arguments.length, args = new Array(i);\n                    while (i--)\n                        args[i] = arguments[i];\n                    context.subscribers.forEach(function (fn) {\n                        asap$1(function fireEvent() {\n                            fn.apply(null, args);\n                        });\n                    });\n                });\n            }\n            else\n                throw new exceptions.InvalidArgument(\"Invalid event config\");\n        });\n    }\n}\n\nfunction makeClassConstructor(prototype, constructor) {\n    derive(constructor).from({ prototype });\n    return constructor;\n}\n\nfunction createTableConstructor(db) {\n    return makeClassConstructor(Table.prototype, function Table(name, tableSchema, trans) {\n        this.db = db;\n        this._tx = trans;\n        this.name = name;\n        this.schema = tableSchema;\n        this.hook = db._allTables[name] ? db._allTables[name].hook : Events(null, {\n            \"creating\": [hookCreatingChain, nop],\n            \"reading\": [pureFunctionChain, mirror],\n            \"updating\": [hookUpdatingChain, nop],\n            \"deleting\": [hookDeletingChain, nop]\n        });\n    });\n}\n\nfunction isPlainKeyRange(ctx, ignoreLimitFilter) {\n    return !(ctx.filter || ctx.algorithm || ctx.or) &&\n        (ignoreLimitFilter ? ctx.justLimit : !ctx.replayFilter);\n}\nfunction addFilter(ctx, fn) {\n    ctx.filter = combine(ctx.filter, fn);\n}\nfunction addReplayFilter(ctx, factory, isLimitFilter) {\n    var curr = ctx.replayFilter;\n    ctx.replayFilter = curr ? () => combine(curr(), factory()) : factory;\n    ctx.justLimit = isLimitFilter && !curr;\n}\nfunction addMatchFilter(ctx, fn) {\n    ctx.isMatch = combine(ctx.isMatch, fn);\n}\nfunction getIndexOrStore(ctx, coreSchema) {\n    if (ctx.isPrimKey)\n        return coreSchema.primaryKey;\n    const index = coreSchema.getIndexByKeyPath(ctx.index);\n    if (!index)\n        throw new exceptions.Schema(\"KeyPath \" + ctx.index + \" on object store \" + coreSchema.name + \" is not indexed\");\n    return index;\n}\nfunction openCursor(ctx, coreTable, trans) {\n    const index = getIndexOrStore(ctx, coreTable.schema);\n    return coreTable.openCursor({\n        trans,\n        values: !ctx.keysOnly,\n        reverse: ctx.dir === 'prev',\n        unique: !!ctx.unique,\n        query: {\n            index,\n            range: ctx.range\n        }\n    });\n}\nfunction iter(ctx, fn, coreTrans, coreTable) {\n    const filter = ctx.replayFilter ? combine(ctx.filter, ctx.replayFilter()) : ctx.filter;\n    if (!ctx.or) {\n        return iterate(openCursor(ctx, coreTable, coreTrans), combine(ctx.algorithm, filter), fn, !ctx.keysOnly && ctx.valueMapper);\n    }\n    else {\n        const set = {};\n        const union = (item, cursor, advance) => {\n            if (!filter || filter(cursor, advance, result => cursor.stop(result), err => cursor.fail(err))) {\n                var primaryKey = cursor.primaryKey;\n                var key = '' + primaryKey;\n                if (key === '[object ArrayBuffer]')\n                    key = '' + new Uint8Array(primaryKey);\n                if (!hasOwn(set, key)) {\n                    set[key] = true;\n                    fn(item, cursor, advance);\n                }\n            }\n        };\n        return Promise.all([\n            ctx.or._iterate(union, coreTrans),\n            iterate(openCursor(ctx, coreTable, coreTrans), ctx.algorithm, union, !ctx.keysOnly && ctx.valueMapper)\n        ]);\n    }\n}\nfunction iterate(cursorPromise, filter, fn, valueMapper) {\n    var mappedFn = valueMapper ? (x, c, a) => fn(valueMapper(x), c, a) : fn;\n    var wrappedFn = wrap(mappedFn);\n    return cursorPromise.then(cursor => {\n        if (cursor) {\n            return cursor.start(() => {\n                var c = () => cursor.continue();\n                if (!filter || filter(cursor, advancer => c = advancer, val => { cursor.stop(val); c = nop; }, e => { cursor.fail(e); c = nop; }))\n                    wrappedFn(cursor.value, cursor, advancer => c = advancer);\n                c();\n            });\n        }\n    });\n}\n\nfunction cmp(a, b) {\n    try {\n        const ta = type(a);\n        const tb = type(b);\n        if (ta !== tb) {\n            if (ta === 'Array')\n                return 1;\n            if (tb === 'Array')\n                return -1;\n            if (ta === 'binary')\n                return 1;\n            if (tb === 'binary')\n                return -1;\n            if (ta === 'string')\n                return 1;\n            if (tb === 'string')\n                return -1;\n            if (ta === 'Date')\n                return 1;\n            if (tb !== 'Date')\n                return NaN;\n            return -1;\n        }\n        switch (ta) {\n            case 'number':\n            case 'Date':\n            case 'string':\n                return a > b ? 1 : a < b ? -1 : 0;\n            case 'binary': {\n                return compareUint8Arrays(getUint8Array(a), getUint8Array(b));\n            }\n            case 'Array':\n                return compareArrays(a, b);\n        }\n    }\n    catch (_a) { }\n    return NaN;\n}\nfunction compareArrays(a, b) {\n    const al = a.length;\n    const bl = b.length;\n    const l = al < bl ? al : bl;\n    for (let i = 0; i < l; ++i) {\n        const res = cmp(a[i], b[i]);\n        if (res !== 0)\n            return res;\n    }\n    return al === bl ? 0 : al < bl ? -1 : 1;\n}\nfunction compareUint8Arrays(a, b) {\n    const al = a.length;\n    const bl = b.length;\n    const l = al < bl ? al : bl;\n    for (let i = 0; i < l; ++i) {\n        if (a[i] !== b[i])\n            return a[i] < b[i] ? -1 : 1;\n    }\n    return al === bl ? 0 : al < bl ? -1 : 1;\n}\nfunction type(x) {\n    const t = typeof x;\n    if (t !== 'object')\n        return t;\n    if (ArrayBuffer.isView(x))\n        return 'binary';\n    const tsTag = toStringTag(x);\n    return tsTag === 'ArrayBuffer' ? 'binary' : tsTag;\n}\nfunction getUint8Array(a) {\n    if (a instanceof Uint8Array)\n        return a;\n    if (ArrayBuffer.isView(a))\n        return new Uint8Array(a.buffer, a.byteOffset, a.byteLength);\n    return new Uint8Array(a);\n}\n\nclass Collection {\n    _read(fn, cb) {\n        var ctx = this._ctx;\n        return ctx.error ?\n            ctx.table._trans(null, rejection.bind(null, ctx.error)) :\n            ctx.table._trans('readonly', fn).then(cb);\n    }\n    _write(fn) {\n        var ctx = this._ctx;\n        return ctx.error ?\n            ctx.table._trans(null, rejection.bind(null, ctx.error)) :\n            ctx.table._trans('readwrite', fn, \"locked\");\n    }\n    _addAlgorithm(fn) {\n        var ctx = this._ctx;\n        ctx.algorithm = combine(ctx.algorithm, fn);\n    }\n    _iterate(fn, coreTrans) {\n        return iter(this._ctx, fn, coreTrans, this._ctx.table.core);\n    }\n    clone(props) {\n        var rv = Object.create(this.constructor.prototype), ctx = Object.create(this._ctx);\n        if (props)\n            extend(ctx, props);\n        rv._ctx = ctx;\n        return rv;\n    }\n    raw() {\n        this._ctx.valueMapper = null;\n        return this;\n    }\n    each(fn) {\n        var ctx = this._ctx;\n        return this._read(trans => iter(ctx, fn, trans, ctx.table.core));\n    }\n    count(cb) {\n        return this._read(trans => {\n            const ctx = this._ctx;\n            const coreTable = ctx.table.core;\n            if (isPlainKeyRange(ctx, true)) {\n                return coreTable.count({\n                    trans,\n                    query: {\n                        index: getIndexOrStore(ctx, coreTable.schema),\n                        range: ctx.range\n                    }\n                }).then(count => Math.min(count, ctx.limit));\n            }\n            else {\n                var count = 0;\n                return iter(ctx, () => { ++count; return false; }, trans, coreTable)\n                    .then(() => count);\n            }\n        }).then(cb);\n    }\n    sortBy(keyPath, cb) {\n        const parts = keyPath.split('.').reverse(), lastPart = parts[0], lastIndex = parts.length - 1;\n        function getval(obj, i) {\n            if (i)\n                return getval(obj[parts[i]], i - 1);\n            return obj[lastPart];\n        }\n        var order = this._ctx.dir === \"next\" ? 1 : -1;\n        function sorter(a, b) {\n            var aVal = getval(a, lastIndex), bVal = getval(b, lastIndex);\n            return aVal < bVal ? -order : aVal > bVal ? order : 0;\n        }\n        return this.toArray(function (a) {\n            return a.sort(sorter);\n        }).then(cb);\n    }\n    toArray(cb) {\n        return this._read(trans => {\n            var ctx = this._ctx;\n            if (ctx.dir === 'next' && isPlainKeyRange(ctx, true) && ctx.limit > 0) {\n                const { valueMapper } = ctx;\n                const index = getIndexOrStore(ctx, ctx.table.core.schema);\n                return ctx.table.core.query({\n                    trans,\n                    limit: ctx.limit,\n                    values: true,\n                    query: {\n                        index,\n                        range: ctx.range\n                    }\n                }).then(({ result }) => valueMapper ? result.map(valueMapper) : result);\n            }\n            else {\n                const a = [];\n                return iter(ctx, item => a.push(item), trans, ctx.table.core).then(() => a);\n            }\n        }, cb);\n    }\n    offset(offset) {\n        var ctx = this._ctx;\n        if (offset <= 0)\n            return this;\n        ctx.offset += offset;\n        if (isPlainKeyRange(ctx)) {\n            addReplayFilter(ctx, () => {\n                var offsetLeft = offset;\n                return (cursor, advance) => {\n                    if (offsetLeft === 0)\n                        return true;\n                    if (offsetLeft === 1) {\n                        --offsetLeft;\n                        return false;\n                    }\n                    advance(() => {\n                        cursor.advance(offsetLeft);\n                        offsetLeft = 0;\n                    });\n                    return false;\n                };\n            });\n        }\n        else {\n            addReplayFilter(ctx, () => {\n                var offsetLeft = offset;\n                return () => (--offsetLeft < 0);\n            });\n        }\n        return this;\n    }\n    limit(numRows) {\n        this._ctx.limit = Math.min(this._ctx.limit, numRows);\n        addReplayFilter(this._ctx, () => {\n            var rowsLeft = numRows;\n            return function (cursor, advance, resolve) {\n                if (--rowsLeft <= 0)\n                    advance(resolve);\n                return rowsLeft >= 0;\n            };\n        }, true);\n        return this;\n    }\n    until(filterFunction, bIncludeStopEntry) {\n        addFilter(this._ctx, function (cursor, advance, resolve) {\n            if (filterFunction(cursor.value)) {\n                advance(resolve);\n                return bIncludeStopEntry;\n            }\n            else {\n                return true;\n            }\n        });\n        return this;\n    }\n    first(cb) {\n        return this.limit(1).toArray(function (a) { return a[0]; }).then(cb);\n    }\n    last(cb) {\n        return this.reverse().first(cb);\n    }\n    filter(filterFunction) {\n        addFilter(this._ctx, function (cursor) {\n            return filterFunction(cursor.value);\n        });\n        addMatchFilter(this._ctx, filterFunction);\n        return this;\n    }\n    and(filter) {\n        return this.filter(filter);\n    }\n    or(indexName) {\n        return new this.db.WhereClause(this._ctx.table, indexName, this);\n    }\n    reverse() {\n        this._ctx.dir = (this._ctx.dir === \"prev\" ? \"next\" : \"prev\");\n        if (this._ondirectionchange)\n            this._ondirectionchange(this._ctx.dir);\n        return this;\n    }\n    desc() {\n        return this.reverse();\n    }\n    eachKey(cb) {\n        var ctx = this._ctx;\n        ctx.keysOnly = !ctx.isMatch;\n        return this.each(function (val, cursor) { cb(cursor.key, cursor); });\n    }\n    eachUniqueKey(cb) {\n        this._ctx.unique = \"unique\";\n        return this.eachKey(cb);\n    }\n    eachPrimaryKey(cb) {\n        var ctx = this._ctx;\n        ctx.keysOnly = !ctx.isMatch;\n        return this.each(function (val, cursor) { cb(cursor.primaryKey, cursor); });\n    }\n    keys(cb) {\n        var ctx = this._ctx;\n        ctx.keysOnly = !ctx.isMatch;\n        var a = [];\n        return this.each(function (item, cursor) {\n            a.push(cursor.key);\n        }).then(function () {\n            return a;\n        }).then(cb);\n    }\n    primaryKeys(cb) {\n        var ctx = this._ctx;\n        if (ctx.dir === 'next' && isPlainKeyRange(ctx, true) && ctx.limit > 0) {\n            return this._read(trans => {\n                var index = getIndexOrStore(ctx, ctx.table.core.schema);\n                return ctx.table.core.query({\n                    trans,\n                    values: false,\n                    limit: ctx.limit,\n                    query: {\n                        index,\n                        range: ctx.range\n                    }\n                });\n            }).then(({ result }) => result).then(cb);\n        }\n        ctx.keysOnly = !ctx.isMatch;\n        var a = [];\n        return this.each(function (item, cursor) {\n            a.push(cursor.primaryKey);\n        }).then(function () {\n            return a;\n        }).then(cb);\n    }\n    uniqueKeys(cb) {\n        this._ctx.unique = \"unique\";\n        return this.keys(cb);\n    }\n    firstKey(cb) {\n        return this.limit(1).keys(function (a) { return a[0]; }).then(cb);\n    }\n    lastKey(cb) {\n        return this.reverse().firstKey(cb);\n    }\n    distinct() {\n        var ctx = this._ctx, idx = ctx.index && ctx.table.schema.idxByName[ctx.index];\n        if (!idx || !idx.multi)\n            return this;\n        var set = {};\n        addFilter(this._ctx, function (cursor) {\n            var strKey = cursor.primaryKey.toString();\n            var found = hasOwn(set, strKey);\n            set[strKey] = true;\n            return !found;\n        });\n        return this;\n    }\n    modify(changes) {\n        var ctx = this._ctx;\n        return this._write(trans => {\n            var modifyer;\n            if (typeof changes === 'function') {\n                modifyer = changes;\n            }\n            else {\n                var keyPaths = keys(changes);\n                var numKeys = keyPaths.length;\n                modifyer = function (item) {\n                    var anythingModified = false;\n                    for (var i = 0; i < numKeys; ++i) {\n                        var keyPath = keyPaths[i], val = changes[keyPath];\n                        if (getByKeyPath(item, keyPath) !== val) {\n                            setByKeyPath(item, keyPath, val);\n                            anythingModified = true;\n                        }\n                    }\n                    return anythingModified;\n                };\n            }\n            const coreTable = ctx.table.core;\n            const { outbound, extractKey } = coreTable.schema.primaryKey;\n            const limit = this.db._options.modifyChunkSize || 200;\n            const totalFailures = [];\n            let successCount = 0;\n            const failedKeys = [];\n            const applyMutateResult = (expectedCount, res) => {\n                const { failures, numFailures } = res;\n                successCount += expectedCount - numFailures;\n                for (let pos of keys(failures)) {\n                    totalFailures.push(failures[pos]);\n                }\n            };\n            return this.clone().primaryKeys().then(keys => {\n                const nextChunk = (offset) => {\n                    const count = Math.min(limit, keys.length - offset);\n                    return coreTable.getMany({\n                        trans,\n                        keys: keys.slice(offset, offset + count),\n                        cache: \"immutable\"\n                    }).then(values => {\n                        const addValues = [];\n                        const putValues = [];\n                        const putKeys = outbound ? [] : null;\n                        const deleteKeys = [];\n                        for (let i = 0; i < count; ++i) {\n                            const origValue = values[i];\n                            const ctx = {\n                                value: deepClone(origValue),\n                                primKey: keys[offset + i]\n                            };\n                            if (modifyer.call(ctx, ctx.value, ctx) !== false) {\n                                if (ctx.value == null) {\n                                    deleteKeys.push(keys[offset + i]);\n                                }\n                                else if (!outbound && cmp(extractKey(origValue), extractKey(ctx.value)) !== 0) {\n                                    deleteKeys.push(keys[offset + i]);\n                                    addValues.push(ctx.value);\n                                }\n                                else {\n                                    putValues.push(ctx.value);\n                                    if (outbound)\n                                        putKeys.push(keys[offset + i]);\n                                }\n                            }\n                        }\n                        const criteria = isPlainKeyRange(ctx) &&\n                            ctx.limit === Infinity &&\n                            (typeof changes !== 'function' || changes === deleteCallback) && {\n                            index: ctx.index,\n                            range: ctx.range\n                        };\n                        return Promise.resolve(addValues.length > 0 &&\n                            coreTable.mutate({ trans, type: 'add', values: addValues })\n                                .then(res => {\n                                for (let pos in res.failures) {\n                                    deleteKeys.splice(parseInt(pos), 1);\n                                }\n                                applyMutateResult(addValues.length, res);\n                            })).then(() => (putValues.length > 0 || (criteria && typeof changes === 'object')) &&\n                            coreTable.mutate({\n                                trans,\n                                type: 'put',\n                                keys: putKeys,\n                                values: putValues,\n                                criteria,\n                                changeSpec: typeof changes !== 'function'\n                                    && changes\n                            }).then(res => applyMutateResult(putValues.length, res))).then(() => (deleteKeys.length > 0 || (criteria && changes === deleteCallback)) &&\n                            coreTable.mutate({\n                                trans,\n                                type: 'delete',\n                                keys: deleteKeys,\n                                criteria\n                            }).then(res => applyMutateResult(deleteKeys.length, res))).then(() => {\n                            return keys.length > offset + count && nextChunk(offset + limit);\n                        });\n                    });\n                };\n                return nextChunk(0).then(() => {\n                    if (totalFailures.length > 0)\n                        throw new ModifyError(\"Error modifying one or more objects\", totalFailures, successCount, failedKeys);\n                    return keys.length;\n                });\n            });\n        });\n    }\n    delete() {\n        var ctx = this._ctx, range = ctx.range;\n        if (isPlainKeyRange(ctx) &&\n            ((ctx.isPrimKey && !hangsOnDeleteLargeKeyRange) || range.type === 3 ))\n         {\n            return this._write(trans => {\n                const { primaryKey } = ctx.table.core.schema;\n                const coreRange = range;\n                return ctx.table.core.count({ trans, query: { index: primaryKey, range: coreRange } }).then(count => {\n                    return ctx.table.core.mutate({ trans, type: 'deleteRange', range: coreRange })\n                        .then(({ failures, lastResult, results, numFailures }) => {\n                        if (numFailures)\n                            throw new ModifyError(\"Could not delete some values\", Object.keys(failures).map(pos => failures[pos]), count - numFailures);\n                        return count - numFailures;\n                    });\n                });\n            });\n        }\n        return this.modify(deleteCallback);\n    }\n}\nconst deleteCallback = (value, ctx) => ctx.value = null;\n\nfunction createCollectionConstructor(db) {\n    return makeClassConstructor(Collection.prototype, function Collection(whereClause, keyRangeGenerator) {\n        this.db = db;\n        let keyRange = AnyRange, error = null;\n        if (keyRangeGenerator)\n            try {\n                keyRange = keyRangeGenerator();\n            }\n            catch (ex) {\n                error = ex;\n            }\n        const whereCtx = whereClause._ctx;\n        const table = whereCtx.table;\n        const readingHook = table.hook.reading.fire;\n        this._ctx = {\n            table: table,\n            index: whereCtx.index,\n            isPrimKey: (!whereCtx.index || (table.schema.primKey.keyPath && whereCtx.index === table.schema.primKey.name)),\n            range: keyRange,\n            keysOnly: false,\n            dir: \"next\",\n            unique: \"\",\n            algorithm: null,\n            filter: null,\n            replayFilter: null,\n            justLimit: true,\n            isMatch: null,\n            offset: 0,\n            limit: Infinity,\n            error: error,\n            or: whereCtx.or,\n            valueMapper: readingHook !== mirror ? readingHook : null\n        };\n    });\n}\n\nfunction simpleCompare(a, b) {\n    return a < b ? -1 : a === b ? 0 : 1;\n}\nfunction simpleCompareReverse(a, b) {\n    return a > b ? -1 : a === b ? 0 : 1;\n}\n\nfunction fail(collectionOrWhereClause, err, T) {\n    var collection = collectionOrWhereClause instanceof WhereClause ?\n        new collectionOrWhereClause.Collection(collectionOrWhereClause) :\n        collectionOrWhereClause;\n    collection._ctx.error = T ? new T(err) : new TypeError(err);\n    return collection;\n}\nfunction emptyCollection(whereClause) {\n    return new whereClause.Collection(whereClause, () => rangeEqual(\"\")).limit(0);\n}\nfunction upperFactory(dir) {\n    return dir === \"next\" ?\n        (s) => s.toUpperCase() :\n        (s) => s.toLowerCase();\n}\nfunction lowerFactory(dir) {\n    return dir === \"next\" ?\n        (s) => s.toLowerCase() :\n        (s) => s.toUpperCase();\n}\nfunction nextCasing(key, lowerKey, upperNeedle, lowerNeedle, cmp, dir) {\n    var length = Math.min(key.length, lowerNeedle.length);\n    var llp = -1;\n    for (var i = 0; i < length; ++i) {\n        var lwrKeyChar = lowerKey[i];\n        if (lwrKeyChar !== lowerNeedle[i]) {\n            if (cmp(key[i], upperNeedle[i]) < 0)\n                return key.substr(0, i) + upperNeedle[i] + upperNeedle.substr(i + 1);\n            if (cmp(key[i], lowerNeedle[i]) < 0)\n                return key.substr(0, i) + lowerNeedle[i] + upperNeedle.substr(i + 1);\n            if (llp >= 0)\n                return key.substr(0, llp) + lowerKey[llp] + upperNeedle.substr(llp + 1);\n            return null;\n        }\n        if (cmp(key[i], lwrKeyChar) < 0)\n            llp = i;\n    }\n    if (length < lowerNeedle.length && dir === \"next\")\n        return key + upperNeedle.substr(key.length);\n    if (length < key.length && dir === \"prev\")\n        return key.substr(0, upperNeedle.length);\n    return (llp < 0 ? null : key.substr(0, llp) + lowerNeedle[llp] + upperNeedle.substr(llp + 1));\n}\nfunction addIgnoreCaseAlgorithm(whereClause, match, needles, suffix) {\n    var upper, lower, compare, upperNeedles, lowerNeedles, direction, nextKeySuffix, needlesLen = needles.length;\n    if (!needles.every(s => typeof s === 'string')) {\n        return fail(whereClause, STRING_EXPECTED);\n    }\n    function initDirection(dir) {\n        upper = upperFactory(dir);\n        lower = lowerFactory(dir);\n        compare = (dir === \"next\" ? simpleCompare : simpleCompareReverse);\n        var needleBounds = needles.map(function (needle) {\n            return { lower: lower(needle), upper: upper(needle) };\n        }).sort(function (a, b) {\n            return compare(a.lower, b.lower);\n        });\n        upperNeedles = needleBounds.map(function (nb) { return nb.upper; });\n        lowerNeedles = needleBounds.map(function (nb) { return nb.lower; });\n        direction = dir;\n        nextKeySuffix = (dir === \"next\" ? \"\" : suffix);\n    }\n    initDirection(\"next\");\n    var c = new whereClause.Collection(whereClause, () => createRange(upperNeedles[0], lowerNeedles[needlesLen - 1] + suffix));\n    c._ondirectionchange = function (direction) {\n        initDirection(direction);\n    };\n    var firstPossibleNeedle = 0;\n    c._addAlgorithm(function (cursor, advance, resolve) {\n        var key = cursor.key;\n        if (typeof key !== 'string')\n            return false;\n        var lowerKey = lower(key);\n        if (match(lowerKey, lowerNeedles, firstPossibleNeedle)) {\n            return true;\n        }\n        else {\n            var lowestPossibleCasing = null;\n            for (var i = firstPossibleNeedle; i < needlesLen; ++i) {\n                var casing = nextCasing(key, lowerKey, upperNeedles[i], lowerNeedles[i], compare, direction);\n                if (casing === null && lowestPossibleCasing === null)\n                    firstPossibleNeedle = i + 1;\n                else if (lowestPossibleCasing === null || compare(lowestPossibleCasing, casing) > 0) {\n                    lowestPossibleCasing = casing;\n                }\n            }\n            if (lowestPossibleCasing !== null) {\n                advance(function () { cursor.continue(lowestPossibleCasing + nextKeySuffix); });\n            }\n            else {\n                advance(resolve);\n            }\n            return false;\n        }\n    });\n    return c;\n}\nfunction createRange(lower, upper, lowerOpen, upperOpen) {\n    return {\n        type: 2 ,\n        lower,\n        upper,\n        lowerOpen,\n        upperOpen\n    };\n}\nfunction rangeEqual(value) {\n    return {\n        type: 1 ,\n        lower: value,\n        upper: value\n    };\n}\n\nclass WhereClause {\n    get Collection() {\n        return this._ctx.table.db.Collection;\n    }\n    between(lower, upper, includeLower, includeUpper) {\n        includeLower = includeLower !== false;\n        includeUpper = includeUpper === true;\n        try {\n            if ((this._cmp(lower, upper) > 0) ||\n                (this._cmp(lower, upper) === 0 && (includeLower || includeUpper) && !(includeLower && includeUpper)))\n                return emptyCollection(this);\n            return new this.Collection(this, () => createRange(lower, upper, !includeLower, !includeUpper));\n        }\n        catch (e) {\n            return fail(this, INVALID_KEY_ARGUMENT);\n        }\n    }\n    equals(value) {\n        if (value == null)\n            return fail(this, INVALID_KEY_ARGUMENT);\n        return new this.Collection(this, () => rangeEqual(value));\n    }\n    above(value) {\n        if (value == null)\n            return fail(this, INVALID_KEY_ARGUMENT);\n        return new this.Collection(this, () => createRange(value, undefined, true));\n    }\n    aboveOrEqual(value) {\n        if (value == null)\n            return fail(this, INVALID_KEY_ARGUMENT);\n        return new this.Collection(this, () => createRange(value, undefined, false));\n    }\n    below(value) {\n        if (value == null)\n            return fail(this, INVALID_KEY_ARGUMENT);\n        return new this.Collection(this, () => createRange(undefined, value, false, true));\n    }\n    belowOrEqual(value) {\n        if (value == null)\n            return fail(this, INVALID_KEY_ARGUMENT);\n        return new this.Collection(this, () => createRange(undefined, value));\n    }\n    startsWith(str) {\n        if (typeof str !== 'string')\n            return fail(this, STRING_EXPECTED);\n        return this.between(str, str + maxString, true, true);\n    }\n    startsWithIgnoreCase(str) {\n        if (str === \"\")\n            return this.startsWith(str);\n        return addIgnoreCaseAlgorithm(this, (x, a) => x.indexOf(a[0]) === 0, [str], maxString);\n    }\n    equalsIgnoreCase(str) {\n        return addIgnoreCaseAlgorithm(this, (x, a) => x === a[0], [str], \"\");\n    }\n    anyOfIgnoreCase() {\n        var set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n        if (set.length === 0)\n            return emptyCollection(this);\n        return addIgnoreCaseAlgorithm(this, (x, a) => a.indexOf(x) !== -1, set, \"\");\n    }\n    startsWithAnyOfIgnoreCase() {\n        var set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n        if (set.length === 0)\n            return emptyCollection(this);\n        return addIgnoreCaseAlgorithm(this, (x, a) => a.some(n => x.indexOf(n) === 0), set, maxString);\n    }\n    anyOf() {\n        const set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n        let compare = this._cmp;\n        try {\n            set.sort(compare);\n        }\n        catch (e) {\n            return fail(this, INVALID_KEY_ARGUMENT);\n        }\n        if (set.length === 0)\n            return emptyCollection(this);\n        const c = new this.Collection(this, () => createRange(set[0], set[set.length - 1]));\n        c._ondirectionchange = direction => {\n            compare = (direction === \"next\" ?\n                this._ascending :\n                this._descending);\n            set.sort(compare);\n        };\n        let i = 0;\n        c._addAlgorithm((cursor, advance, resolve) => {\n            const key = cursor.key;\n            while (compare(key, set[i]) > 0) {\n                ++i;\n                if (i === set.length) {\n                    advance(resolve);\n                    return false;\n                }\n            }\n            if (compare(key, set[i]) === 0) {\n                return true;\n            }\n            else {\n                advance(() => { cursor.continue(set[i]); });\n                return false;\n            }\n        });\n        return c;\n    }\n    notEqual(value) {\n        return this.inAnyRange([[minKey, value], [value, this.db._maxKey]], { includeLowers: false, includeUppers: false });\n    }\n    noneOf() {\n        const set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n        if (set.length === 0)\n            return new this.Collection(this);\n        try {\n            set.sort(this._ascending);\n        }\n        catch (e) {\n            return fail(this, INVALID_KEY_ARGUMENT);\n        }\n        const ranges = set.reduce((res, val) => res ?\n            res.concat([[res[res.length - 1][1], val]]) :\n            [[minKey, val]], null);\n        ranges.push([set[set.length - 1], this.db._maxKey]);\n        return this.inAnyRange(ranges, { includeLowers: false, includeUppers: false });\n    }\n    inAnyRange(ranges, options) {\n        const cmp = this._cmp, ascending = this._ascending, descending = this._descending, min = this._min, max = this._max;\n        if (ranges.length === 0)\n            return emptyCollection(this);\n        if (!ranges.every(range => range[0] !== undefined &&\n            range[1] !== undefined &&\n            ascending(range[0], range[1]) <= 0)) {\n            return fail(this, \"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower\", exceptions.InvalidArgument);\n        }\n        const includeLowers = !options || options.includeLowers !== false;\n        const includeUppers = options && options.includeUppers === true;\n        function addRange(ranges, newRange) {\n            let i = 0, l = ranges.length;\n            for (; i < l; ++i) {\n                const range = ranges[i];\n                if (cmp(newRange[0], range[1]) < 0 && cmp(newRange[1], range[0]) > 0) {\n                    range[0] = min(range[0], newRange[0]);\n                    range[1] = max(range[1], newRange[1]);\n                    break;\n                }\n            }\n            if (i === l)\n                ranges.push(newRange);\n            return ranges;\n        }\n        let sortDirection = ascending;\n        function rangeSorter(a, b) { return sortDirection(a[0], b[0]); }\n        let set;\n        try {\n            set = ranges.reduce(addRange, []);\n            set.sort(rangeSorter);\n        }\n        catch (ex) {\n            return fail(this, INVALID_KEY_ARGUMENT);\n        }\n        let rangePos = 0;\n        const keyIsBeyondCurrentEntry = includeUppers ?\n            key => ascending(key, set[rangePos][1]) > 0 :\n            key => ascending(key, set[rangePos][1]) >= 0;\n        const keyIsBeforeCurrentEntry = includeLowers ?\n            key => descending(key, set[rangePos][0]) > 0 :\n            key => descending(key, set[rangePos][0]) >= 0;\n        function keyWithinCurrentRange(key) {\n            return !keyIsBeyondCurrentEntry(key) && !keyIsBeforeCurrentEntry(key);\n        }\n        let checkKey = keyIsBeyondCurrentEntry;\n        const c = new this.Collection(this, () => createRange(set[0][0], set[set.length - 1][1], !includeLowers, !includeUppers));\n        c._ondirectionchange = direction => {\n            if (direction === \"next\") {\n                checkKey = keyIsBeyondCurrentEntry;\n                sortDirection = ascending;\n            }\n            else {\n                checkKey = keyIsBeforeCurrentEntry;\n                sortDirection = descending;\n            }\n            set.sort(rangeSorter);\n        };\n        c._addAlgorithm((cursor, advance, resolve) => {\n            var key = cursor.key;\n            while (checkKey(key)) {\n                ++rangePos;\n                if (rangePos === set.length) {\n                    advance(resolve);\n                    return false;\n                }\n            }\n            if (keyWithinCurrentRange(key)) {\n                return true;\n            }\n            else if (this._cmp(key, set[rangePos][1]) === 0 || this._cmp(key, set[rangePos][0]) === 0) {\n                return false;\n            }\n            else {\n                advance(() => {\n                    if (sortDirection === ascending)\n                        cursor.continue(set[rangePos][0]);\n                    else\n                        cursor.continue(set[rangePos][1]);\n                });\n                return false;\n            }\n        });\n        return c;\n    }\n    startsWithAnyOf() {\n        const set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n        if (!set.every(s => typeof s === 'string')) {\n            return fail(this, \"startsWithAnyOf() only works with strings\");\n        }\n        if (set.length === 0)\n            return emptyCollection(this);\n        return this.inAnyRange(set.map((str) => [str, str + maxString]));\n    }\n}\n\nfunction createWhereClauseConstructor(db) {\n    return makeClassConstructor(WhereClause.prototype, function WhereClause(table, index, orCollection) {\n        this.db = db;\n        this._ctx = {\n            table: table,\n            index: index === \":id\" ? null : index,\n            or: orCollection\n        };\n        const indexedDB = db._deps.indexedDB;\n        if (!indexedDB)\n            throw new exceptions.MissingAPI();\n        this._cmp = this._ascending = indexedDB.cmp.bind(indexedDB);\n        this._descending = (a, b) => indexedDB.cmp(b, a);\n        this._max = (a, b) => indexedDB.cmp(a, b) > 0 ? a : b;\n        this._min = (a, b) => indexedDB.cmp(a, b) < 0 ? a : b;\n        this._IDBKeyRange = db._deps.IDBKeyRange;\n    });\n}\n\nfunction eventRejectHandler(reject) {\n    return wrap(function (event) {\n        preventDefault(event);\n        reject(event.target.error);\n        return false;\n    });\n}\nfunction preventDefault(event) {\n    if (event.stopPropagation)\n        event.stopPropagation();\n    if (event.preventDefault)\n        event.preventDefault();\n}\n\nconst DEXIE_STORAGE_MUTATED_EVENT_NAME = 'storagemutated';\nconst STORAGE_MUTATED_DOM_EVENT_NAME = 'x-storagemutated-1';\nconst globalEvents = Events(null, DEXIE_STORAGE_MUTATED_EVENT_NAME);\n\nclass Transaction {\n    _lock() {\n        assert(!PSD.global);\n        ++this._reculock;\n        if (this._reculock === 1 && !PSD.global)\n            PSD.lockOwnerFor = this;\n        return this;\n    }\n    _unlock() {\n        assert(!PSD.global);\n        if (--this._reculock === 0) {\n            if (!PSD.global)\n                PSD.lockOwnerFor = null;\n            while (this._blockedFuncs.length > 0 && !this._locked()) {\n                var fnAndPSD = this._blockedFuncs.shift();\n                try {\n                    usePSD(fnAndPSD[1], fnAndPSD[0]);\n                }\n                catch (e) { }\n            }\n        }\n        return this;\n    }\n    _locked() {\n        return this._reculock && PSD.lockOwnerFor !== this;\n    }\n    create(idbtrans) {\n        if (!this.mode)\n            return this;\n        const idbdb = this.db.idbdb;\n        const dbOpenError = this.db._state.dbOpenError;\n        assert(!this.idbtrans);\n        if (!idbtrans && !idbdb) {\n            switch (dbOpenError && dbOpenError.name) {\n                case \"DatabaseClosedError\":\n                    throw new exceptions.DatabaseClosed(dbOpenError);\n                case \"MissingAPIError\":\n                    throw new exceptions.MissingAPI(dbOpenError.message, dbOpenError);\n                default:\n                    throw new exceptions.OpenFailed(dbOpenError);\n            }\n        }\n        if (!this.active)\n            throw new exceptions.TransactionInactive();\n        assert(this._completion._state === null);\n        idbtrans = this.idbtrans = idbtrans ||\n            (this.db.core\n                ? this.db.core.transaction(this.storeNames, this.mode, { durability: this.chromeTransactionDurability })\n                : idbdb.transaction(this.storeNames, this.mode, { durability: this.chromeTransactionDurability }));\n        idbtrans.onerror = wrap(ev => {\n            preventDefault(ev);\n            this._reject(idbtrans.error);\n        });\n        idbtrans.onabort = wrap(ev => {\n            preventDefault(ev);\n            this.active && this._reject(new exceptions.Abort(idbtrans.error));\n            this.active = false;\n            this.on(\"abort\").fire(ev);\n        });\n        idbtrans.oncomplete = wrap(() => {\n            this.active = false;\n            this._resolve();\n            if ('mutatedParts' in idbtrans) {\n                globalEvents.storagemutated.fire(idbtrans[\"mutatedParts\"]);\n            }\n        });\n        return this;\n    }\n    _promise(mode, fn, bWriteLock) {\n        if (mode === 'readwrite' && this.mode !== 'readwrite')\n            return rejection(new exceptions.ReadOnly(\"Transaction is readonly\"));\n        if (!this.active)\n            return rejection(new exceptions.TransactionInactive());\n        if (this._locked()) {\n            return new DexiePromise((resolve, reject) => {\n                this._blockedFuncs.push([() => {\n                        this._promise(mode, fn, bWriteLock).then(resolve, reject);\n                    }, PSD]);\n            });\n        }\n        else if (bWriteLock) {\n            return newScope(() => {\n                var p = new DexiePromise((resolve, reject) => {\n                    this._lock();\n                    const rv = fn(resolve, reject, this);\n                    if (rv && rv.then)\n                        rv.then(resolve, reject);\n                });\n                p.finally(() => this._unlock());\n                p._lib = true;\n                return p;\n            });\n        }\n        else {\n            var p = new DexiePromise((resolve, reject) => {\n                var rv = fn(resolve, reject, this);\n                if (rv && rv.then)\n                    rv.then(resolve, reject);\n            });\n            p._lib = true;\n            return p;\n        }\n    }\n    _root() {\n        return this.parent ? this.parent._root() : this;\n    }\n    waitFor(promiseLike) {\n        var root = this._root();\n        const promise = DexiePromise.resolve(promiseLike);\n        if (root._waitingFor) {\n            root._waitingFor = root._waitingFor.then(() => promise);\n        }\n        else {\n            root._waitingFor = promise;\n            root._waitingQueue = [];\n            var store = root.idbtrans.objectStore(root.storeNames[0]);\n            (function spin() {\n                ++root._spinCount;\n                while (root._waitingQueue.length)\n                    (root._waitingQueue.shift())();\n                if (root._waitingFor)\n                    store.get(-Infinity).onsuccess = spin;\n            }());\n        }\n        var currentWaitPromise = root._waitingFor;\n        return new DexiePromise((resolve, reject) => {\n            promise.then(res => root._waitingQueue.push(wrap(resolve.bind(null, res))), err => root._waitingQueue.push(wrap(reject.bind(null, err)))).finally(() => {\n                if (root._waitingFor === currentWaitPromise) {\n                    root._waitingFor = null;\n                }\n            });\n        });\n    }\n    abort() {\n        if (this.active) {\n            this.active = false;\n            if (this.idbtrans)\n                this.idbtrans.abort();\n            this._reject(new exceptions.Abort());\n        }\n    }\n    table(tableName) {\n        const memoizedTables = (this._memoizedTables || (this._memoizedTables = {}));\n        if (hasOwn(memoizedTables, tableName))\n            return memoizedTables[tableName];\n        const tableSchema = this.schema[tableName];\n        if (!tableSchema) {\n            throw new exceptions.NotFound(\"Table \" + tableName + \" not part of transaction\");\n        }\n        const transactionBoundTable = new this.db.Table(tableName, tableSchema, this);\n        transactionBoundTable.core = this.db.core.table(tableName);\n        memoizedTables[tableName] = transactionBoundTable;\n        return transactionBoundTable;\n    }\n}\n\nfunction createTransactionConstructor(db) {\n    return makeClassConstructor(Transaction.prototype, function Transaction(mode, storeNames, dbschema, chromeTransactionDurability, parent) {\n        this.db = db;\n        this.mode = mode;\n        this.storeNames = storeNames;\n        this.schema = dbschema;\n        this.chromeTransactionDurability = chromeTransactionDurability;\n        this.idbtrans = null;\n        this.on = Events(this, \"complete\", \"error\", \"abort\");\n        this.parent = parent || null;\n        this.active = true;\n        this._reculock = 0;\n        this._blockedFuncs = [];\n        this._resolve = null;\n        this._reject = null;\n        this._waitingFor = null;\n        this._waitingQueue = null;\n        this._spinCount = 0;\n        this._completion = new DexiePromise((resolve, reject) => {\n            this._resolve = resolve;\n            this._reject = reject;\n        });\n        this._completion.then(() => {\n            this.active = false;\n            this.on.complete.fire();\n        }, e => {\n            var wasActive = this.active;\n            this.active = false;\n            this.on.error.fire(e);\n            this.parent ?\n                this.parent._reject(e) :\n                wasActive && this.idbtrans && this.idbtrans.abort();\n            return rejection(e);\n        });\n    });\n}\n\nfunction createIndexSpec(name, keyPath, unique, multi, auto, compound, isPrimKey) {\n    return {\n        name,\n        keyPath,\n        unique,\n        multi,\n        auto,\n        compound,\n        src: (unique && !isPrimKey ? '&' : '') + (multi ? '*' : '') + (auto ? \"++\" : \"\") + nameFromKeyPath(keyPath)\n    };\n}\nfunction nameFromKeyPath(keyPath) {\n    return typeof keyPath === 'string' ?\n        keyPath :\n        keyPath ? ('[' + [].join.call(keyPath, '+') + ']') : \"\";\n}\n\nfunction createTableSchema(name, primKey, indexes) {\n    return {\n        name,\n        primKey,\n        indexes,\n        mappedClass: null,\n        idxByName: arrayToObject(indexes, index => [index.name, index])\n    };\n}\n\nfunction safariMultiStoreFix(storeNames) {\n    return storeNames.length === 1 ? storeNames[0] : storeNames;\n}\nlet getMaxKey = (IdbKeyRange) => {\n    try {\n        IdbKeyRange.only([[]]);\n        getMaxKey = () => [[]];\n        return [[]];\n    }\n    catch (e) {\n        getMaxKey = () => maxString;\n        return maxString;\n    }\n};\n\nfunction getKeyExtractor(keyPath) {\n    if (keyPath == null) {\n        return () => undefined;\n    }\n    else if (typeof keyPath === 'string') {\n        return getSinglePathKeyExtractor(keyPath);\n    }\n    else {\n        return obj => getByKeyPath(obj, keyPath);\n    }\n}\nfunction getSinglePathKeyExtractor(keyPath) {\n    const split = keyPath.split('.');\n    if (split.length === 1) {\n        return obj => obj[keyPath];\n    }\n    else {\n        return obj => getByKeyPath(obj, keyPath);\n    }\n}\n\nfunction arrayify(arrayLike) {\n    return [].slice.call(arrayLike);\n}\nlet _id_counter = 0;\nfunction getKeyPathAlias(keyPath) {\n    return keyPath == null ?\n        \":id\" :\n        typeof keyPath === 'string' ?\n            keyPath :\n            `[${keyPath.join('+')}]`;\n}\nfunction createDBCore(db, IdbKeyRange, tmpTrans) {\n    function extractSchema(db, trans) {\n        const tables = arrayify(db.objectStoreNames);\n        return {\n            schema: {\n                name: db.name,\n                tables: tables.map(table => trans.objectStore(table)).map(store => {\n                    const { keyPath, autoIncrement } = store;\n                    const compound = isArray(keyPath);\n                    const outbound = keyPath == null;\n                    const indexByKeyPath = {};\n                    const result = {\n                        name: store.name,\n                        primaryKey: {\n                            name: null,\n                            isPrimaryKey: true,\n                            outbound,\n                            compound,\n                            keyPath,\n                            autoIncrement,\n                            unique: true,\n                            extractKey: getKeyExtractor(keyPath)\n                        },\n                        indexes: arrayify(store.indexNames).map(indexName => store.index(indexName))\n                            .map(index => {\n                            const { name, unique, multiEntry, keyPath } = index;\n                            const compound = isArray(keyPath);\n                            const result = {\n                                name,\n                                compound,\n                                keyPath,\n                                unique,\n                                multiEntry,\n                                extractKey: getKeyExtractor(keyPath)\n                            };\n                            indexByKeyPath[getKeyPathAlias(keyPath)] = result;\n                            return result;\n                        }),\n                        getIndexByKeyPath: (keyPath) => indexByKeyPath[getKeyPathAlias(keyPath)]\n                    };\n                    indexByKeyPath[\":id\"] = result.primaryKey;\n                    if (keyPath != null) {\n                        indexByKeyPath[getKeyPathAlias(keyPath)] = result.primaryKey;\n                    }\n                    return result;\n                })\n            },\n            hasGetAll: tables.length > 0 && ('getAll' in trans.objectStore(tables[0])) &&\n                !(typeof navigator !== 'undefined' && /Safari/.test(navigator.userAgent) &&\n                    !/(Chrome\\/|Edge\\/)/.test(navigator.userAgent) &&\n                    [].concat(navigator.userAgent.match(/Safari\\/(\\d*)/))[1] < 604)\n        };\n    }\n    function makeIDBKeyRange(range) {\n        if (range.type === 3 )\n            return null;\n        if (range.type === 4 )\n            throw new Error(\"Cannot convert never type to IDBKeyRange\");\n        const { lower, upper, lowerOpen, upperOpen } = range;\n        const idbRange = lower === undefined ?\n            upper === undefined ?\n                null :\n                IdbKeyRange.upperBound(upper, !!upperOpen) :\n            upper === undefined ?\n                IdbKeyRange.lowerBound(lower, !!lowerOpen) :\n                IdbKeyRange.bound(lower, upper, !!lowerOpen, !!upperOpen);\n        return idbRange;\n    }\n    function createDbCoreTable(tableSchema) {\n        const tableName = tableSchema.name;\n        function mutate({ trans, type, keys, values, range }) {\n            return new Promise((resolve, reject) => {\n                resolve = wrap(resolve);\n                const store = trans.objectStore(tableName);\n                const outbound = store.keyPath == null;\n                const isAddOrPut = type === \"put\" || type === \"add\";\n                if (!isAddOrPut && type !== 'delete' && type !== 'deleteRange')\n                    throw new Error(\"Invalid operation type: \" + type);\n                const { length } = keys || values || { length: 1 };\n                if (keys && values && keys.length !== values.length) {\n                    throw new Error(\"Given keys array must have same length as given values array.\");\n                }\n                if (length === 0)\n                    return resolve({ numFailures: 0, failures: {}, results: [], lastResult: undefined });\n                let req;\n                const reqs = [];\n                const failures = [];\n                let numFailures = 0;\n                const errorHandler = event => {\n                    ++numFailures;\n                    preventDefault(event);\n                };\n                if (type === 'deleteRange') {\n                    if (range.type === 4 )\n                        return resolve({ numFailures, failures, results: [], lastResult: undefined });\n                    if (range.type === 3 )\n                        reqs.push(req = store.clear());\n                    else\n                        reqs.push(req = store.delete(makeIDBKeyRange(range)));\n                }\n                else {\n                    const [args1, args2] = isAddOrPut ?\n                        outbound ?\n                            [values, keys] :\n                            [values, null] :\n                        [keys, null];\n                    if (isAddOrPut) {\n                        for (let i = 0; i < length; ++i) {\n                            reqs.push(req = (args2 && args2[i] !== undefined ?\n                                store[type](args1[i], args2[i]) :\n                                store[type](args1[i])));\n                            req.onerror = errorHandler;\n                        }\n                    }\n                    else {\n                        for (let i = 0; i < length; ++i) {\n                            reqs.push(req = store[type](args1[i]));\n                            req.onerror = errorHandler;\n                        }\n                    }\n                }\n                const done = event => {\n                    const lastResult = event.target.result;\n                    reqs.forEach((req, i) => req.error != null && (failures[i] = req.error));\n                    resolve({\n                        numFailures,\n                        failures,\n                        results: type === \"delete\" ? keys : reqs.map(req => req.result),\n                        lastResult\n                    });\n                };\n                req.onerror = event => {\n                    errorHandler(event);\n                    done(event);\n                };\n                req.onsuccess = done;\n            });\n        }\n        function openCursor({ trans, values, query, reverse, unique }) {\n            return new Promise((resolve, reject) => {\n                resolve = wrap(resolve);\n                const { index, range } = query;\n                const store = trans.objectStore(tableName);\n                const source = index.isPrimaryKey ?\n                    store :\n                    store.index(index.name);\n                const direction = reverse ?\n                    unique ?\n                        \"prevunique\" :\n                        \"prev\" :\n                    unique ?\n                        \"nextunique\" :\n                        \"next\";\n                const req = values || !('openKeyCursor' in source) ?\n                    source.openCursor(makeIDBKeyRange(range), direction) :\n                    source.openKeyCursor(makeIDBKeyRange(range), direction);\n                req.onerror = eventRejectHandler(reject);\n                req.onsuccess = wrap(ev => {\n                    const cursor = req.result;\n                    if (!cursor) {\n                        resolve(null);\n                        return;\n                    }\n                    cursor.___id = ++_id_counter;\n                    cursor.done = false;\n                    const _cursorContinue = cursor.continue.bind(cursor);\n                    let _cursorContinuePrimaryKey = cursor.continuePrimaryKey;\n                    if (_cursorContinuePrimaryKey)\n                        _cursorContinuePrimaryKey = _cursorContinuePrimaryKey.bind(cursor);\n                    const _cursorAdvance = cursor.advance.bind(cursor);\n                    const doThrowCursorIsNotStarted = () => { throw new Error(\"Cursor not started\"); };\n                    const doThrowCursorIsStopped = () => { throw new Error(\"Cursor not stopped\"); };\n                    cursor.trans = trans;\n                    cursor.stop = cursor.continue = cursor.continuePrimaryKey = cursor.advance = doThrowCursorIsNotStarted;\n                    cursor.fail = wrap(reject);\n                    cursor.next = function () {\n                        let gotOne = 1;\n                        return this.start(() => gotOne-- ? this.continue() : this.stop()).then(() => this);\n                    };\n                    cursor.start = (callback) => {\n                        const iterationPromise = new Promise((resolveIteration, rejectIteration) => {\n                            resolveIteration = wrap(resolveIteration);\n                            req.onerror = eventRejectHandler(rejectIteration);\n                            cursor.fail = rejectIteration;\n                            cursor.stop = value => {\n                                cursor.stop = cursor.continue = cursor.continuePrimaryKey = cursor.advance = doThrowCursorIsStopped;\n                                resolveIteration(value);\n                            };\n                        });\n                        const guardedCallback = () => {\n                            if (req.result) {\n                                try {\n                                    callback();\n                                }\n                                catch (err) {\n                                    cursor.fail(err);\n                                }\n                            }\n                            else {\n                                cursor.done = true;\n                                cursor.start = () => { throw new Error(\"Cursor behind last entry\"); };\n                                cursor.stop();\n                            }\n                        };\n                        req.onsuccess = wrap(ev => {\n                            req.onsuccess = guardedCallback;\n                            guardedCallback();\n                        });\n                        cursor.continue = _cursorContinue;\n                        cursor.continuePrimaryKey = _cursorContinuePrimaryKey;\n                        cursor.advance = _cursorAdvance;\n                        guardedCallback();\n                        return iterationPromise;\n                    };\n                    resolve(cursor);\n                }, reject);\n            });\n        }\n        function query(hasGetAll) {\n            return (request) => {\n                return new Promise((resolve, reject) => {\n                    resolve = wrap(resolve);\n                    const { trans, values, limit, query } = request;\n                    const nonInfinitLimit = limit === Infinity ? undefined : limit;\n                    const { index, range } = query;\n                    const store = trans.objectStore(tableName);\n                    const source = index.isPrimaryKey ? store : store.index(index.name);\n                    const idbKeyRange = makeIDBKeyRange(range);\n                    if (limit === 0)\n                        return resolve({ result: [] });\n                    if (hasGetAll) {\n                        const req = values ?\n                            source.getAll(idbKeyRange, nonInfinitLimit) :\n                            source.getAllKeys(idbKeyRange, nonInfinitLimit);\n                        req.onsuccess = event => resolve({ result: event.target.result });\n                        req.onerror = eventRejectHandler(reject);\n                    }\n                    else {\n                        let count = 0;\n                        const req = values || !('openKeyCursor' in source) ?\n                            source.openCursor(idbKeyRange) :\n                            source.openKeyCursor(idbKeyRange);\n                        const result = [];\n                        req.onsuccess = event => {\n                            const cursor = req.result;\n                            if (!cursor)\n                                return resolve({ result });\n                            result.push(values ? cursor.value : cursor.primaryKey);\n                            if (++count === limit)\n                                return resolve({ result });\n                            cursor.continue();\n                        };\n                        req.onerror = eventRejectHandler(reject);\n                    }\n                });\n            };\n        }\n        return {\n            name: tableName,\n            schema: tableSchema,\n            mutate,\n            getMany({ trans, keys }) {\n                return new Promise((resolve, reject) => {\n                    resolve = wrap(resolve);\n                    const store = trans.objectStore(tableName);\n                    const length = keys.length;\n                    const result = new Array(length);\n                    let keyCount = 0;\n                    let callbackCount = 0;\n                    let req;\n                    const successHandler = event => {\n                        const req = event.target;\n                        if ((result[req._pos] = req.result) != null)\n                            ;\n                        if (++callbackCount === keyCount)\n                            resolve(result);\n                    };\n                    const errorHandler = eventRejectHandler(reject);\n                    for (let i = 0; i < length; ++i) {\n                        const key = keys[i];\n                        if (key != null) {\n                            req = store.get(keys[i]);\n                            req._pos = i;\n                            req.onsuccess = successHandler;\n                            req.onerror = errorHandler;\n                            ++keyCount;\n                        }\n                    }\n                    if (keyCount === 0)\n                        resolve(result);\n                });\n            },\n            get({ trans, key }) {\n                return new Promise((resolve, reject) => {\n                    resolve = wrap(resolve);\n                    const store = trans.objectStore(tableName);\n                    const req = store.get(key);\n                    req.onsuccess = event => resolve(event.target.result);\n                    req.onerror = eventRejectHandler(reject);\n                });\n            },\n            query: query(hasGetAll),\n            openCursor,\n            count({ query, trans }) {\n                const { index, range } = query;\n                return new Promise((resolve, reject) => {\n                    const store = trans.objectStore(tableName);\n                    const source = index.isPrimaryKey ? store : store.index(index.name);\n                    const idbKeyRange = makeIDBKeyRange(range);\n                    const req = idbKeyRange ? source.count(idbKeyRange) : source.count();\n                    req.onsuccess = wrap(ev => resolve(ev.target.result));\n                    req.onerror = eventRejectHandler(reject);\n                });\n            }\n        };\n    }\n    const { schema, hasGetAll } = extractSchema(db, tmpTrans);\n    const tables = schema.tables.map(tableSchema => createDbCoreTable(tableSchema));\n    const tableMap = {};\n    tables.forEach(table => tableMap[table.name] = table);\n    return {\n        stack: \"dbcore\",\n        transaction: db.transaction.bind(db),\n        table(name) {\n            const result = tableMap[name];\n            if (!result)\n                throw new Error(`Table '${name}' not found`);\n            return tableMap[name];\n        },\n        MIN_KEY: -Infinity,\n        MAX_KEY: getMaxKey(IdbKeyRange),\n        schema\n    };\n}\n\nfunction createMiddlewareStack(stackImpl, middlewares) {\n    return middlewares.reduce((down, { create }) => ({ ...down, ...create(down) }), stackImpl);\n}\nfunction createMiddlewareStacks(middlewares, idbdb, { IDBKeyRange, indexedDB }, tmpTrans) {\n    const dbcore = createMiddlewareStack(createDBCore(idbdb, IDBKeyRange, tmpTrans), middlewares.dbcore);\n    return {\n        dbcore\n    };\n}\nfunction generateMiddlewareStacks({ _novip: db }, tmpTrans) {\n    const idbdb = tmpTrans.db;\n    const stacks = createMiddlewareStacks(db._middlewares, idbdb, db._deps, tmpTrans);\n    db.core = stacks.dbcore;\n    db.tables.forEach(table => {\n        const tableName = table.name;\n        if (db.core.schema.tables.some(tbl => tbl.name === tableName)) {\n            table.core = db.core.table(tableName);\n            if (db[tableName] instanceof db.Table) {\n                db[tableName].core = table.core;\n            }\n        }\n    });\n}\n\nfunction setApiOnPlace({ _novip: db }, objs, tableNames, dbschema) {\n    tableNames.forEach(tableName => {\n        const schema = dbschema[tableName];\n        objs.forEach(obj => {\n            const propDesc = getPropertyDescriptor(obj, tableName);\n            if (!propDesc || (\"value\" in propDesc && propDesc.value === undefined)) {\n                if (obj === db.Transaction.prototype || obj instanceof db.Transaction) {\n                    setProp(obj, tableName, {\n                        get() { return this.table(tableName); },\n                        set(value) {\n                            defineProperty(this, tableName, { value, writable: true, configurable: true, enumerable: true });\n                        }\n                    });\n                }\n                else {\n                    obj[tableName] = new db.Table(tableName, schema);\n                }\n            }\n        });\n    });\n}\nfunction removeTablesApi({ _novip: db }, objs) {\n    objs.forEach(obj => {\n        for (let key in obj) {\n            if (obj[key] instanceof db.Table)\n                delete obj[key];\n        }\n    });\n}\nfunction lowerVersionFirst(a, b) {\n    return a._cfg.version - b._cfg.version;\n}\nfunction runUpgraders(db, oldVersion, idbUpgradeTrans, reject) {\n    const globalSchema = db._dbSchema;\n    const trans = db._createTransaction('readwrite', db._storeNames, globalSchema);\n    trans.create(idbUpgradeTrans);\n    trans._completion.catch(reject);\n    const rejectTransaction = trans._reject.bind(trans);\n    const transless = PSD.transless || PSD;\n    newScope(() => {\n        PSD.trans = trans;\n        PSD.transless = transless;\n        if (oldVersion === 0) {\n            keys(globalSchema).forEach(tableName => {\n                createTable(idbUpgradeTrans, tableName, globalSchema[tableName].primKey, globalSchema[tableName].indexes);\n            });\n            generateMiddlewareStacks(db, idbUpgradeTrans);\n            DexiePromise.follow(() => db.on.populate.fire(trans)).catch(rejectTransaction);\n        }\n        else\n            updateTablesAndIndexes(db, oldVersion, trans, idbUpgradeTrans).catch(rejectTransaction);\n    });\n}\nfunction updateTablesAndIndexes({ _novip: db }, oldVersion, trans, idbUpgradeTrans) {\n    const queue = [];\n    const versions = db._versions;\n    let globalSchema = db._dbSchema = buildGlobalSchema(db, db.idbdb, idbUpgradeTrans);\n    let anyContentUpgraderHasRun = false;\n    const versToRun = versions.filter(v => v._cfg.version >= oldVersion);\n    versToRun.forEach(version => {\n        queue.push(() => {\n            const oldSchema = globalSchema;\n            const newSchema = version._cfg.dbschema;\n            adjustToExistingIndexNames(db, oldSchema, idbUpgradeTrans);\n            adjustToExistingIndexNames(db, newSchema, idbUpgradeTrans);\n            globalSchema = db._dbSchema = newSchema;\n            const diff = getSchemaDiff(oldSchema, newSchema);\n            diff.add.forEach(tuple => {\n                createTable(idbUpgradeTrans, tuple[0], tuple[1].primKey, tuple[1].indexes);\n            });\n            diff.change.forEach(change => {\n                if (change.recreate) {\n                    throw new exceptions.Upgrade(\"Not yet support for changing primary key\");\n                }\n                else {\n                    const store = idbUpgradeTrans.objectStore(change.name);\n                    change.add.forEach(idx => addIndex(store, idx));\n                    change.change.forEach(idx => {\n                        store.deleteIndex(idx.name);\n                        addIndex(store, idx);\n                    });\n                    change.del.forEach(idxName => store.deleteIndex(idxName));\n                }\n            });\n            const contentUpgrade = version._cfg.contentUpgrade;\n            if (contentUpgrade && version._cfg.version > oldVersion) {\n                generateMiddlewareStacks(db, idbUpgradeTrans);\n                trans._memoizedTables = {};\n                anyContentUpgraderHasRun = true;\n                let upgradeSchema = shallowClone(newSchema);\n                diff.del.forEach(table => {\n                    upgradeSchema[table] = oldSchema[table];\n                });\n                removeTablesApi(db, [db.Transaction.prototype]);\n                setApiOnPlace(db, [db.Transaction.prototype], keys(upgradeSchema), upgradeSchema);\n                trans.schema = upgradeSchema;\n                const contentUpgradeIsAsync = isAsyncFunction(contentUpgrade);\n                if (contentUpgradeIsAsync) {\n                    incrementExpectedAwaits();\n                }\n                let returnValue;\n                const promiseFollowed = DexiePromise.follow(() => {\n                    returnValue = contentUpgrade(trans);\n                    if (returnValue) {\n                        if (contentUpgradeIsAsync) {\n                            var decrementor = decrementExpectedAwaits.bind(null, null);\n                            returnValue.then(decrementor, decrementor);\n                        }\n                    }\n                });\n                return (returnValue && typeof returnValue.then === 'function' ?\n                    DexiePromise.resolve(returnValue) : promiseFollowed.then(() => returnValue));\n            }\n        });\n        queue.push(idbtrans => {\n            if (!anyContentUpgraderHasRun || !hasIEDeleteObjectStoreBug) {\n                const newSchema = version._cfg.dbschema;\n                deleteRemovedTables(newSchema, idbtrans);\n            }\n            removeTablesApi(db, [db.Transaction.prototype]);\n            setApiOnPlace(db, [db.Transaction.prototype], db._storeNames, db._dbSchema);\n            trans.schema = db._dbSchema;\n        });\n    });\n    function runQueue() {\n        return queue.length ? DexiePromise.resolve(queue.shift()(trans.idbtrans)).then(runQueue) :\n            DexiePromise.resolve();\n    }\n    return runQueue().then(() => {\n        createMissingTables(globalSchema, idbUpgradeTrans);\n    });\n}\nfunction getSchemaDiff(oldSchema, newSchema) {\n    const diff = {\n        del: [],\n        add: [],\n        change: []\n    };\n    let table;\n    for (table in oldSchema) {\n        if (!newSchema[table])\n            diff.del.push(table);\n    }\n    for (table in newSchema) {\n        const oldDef = oldSchema[table], newDef = newSchema[table];\n        if (!oldDef) {\n            diff.add.push([table, newDef]);\n        }\n        else {\n            const change = {\n                name: table,\n                def: newDef,\n                recreate: false,\n                del: [],\n                add: [],\n                change: []\n            };\n            if ((\n            '' + (oldDef.primKey.keyPath || '')) !== ('' + (newDef.primKey.keyPath || '')) ||\n                (oldDef.primKey.auto !== newDef.primKey.auto && !isIEOrEdge))\n             {\n                change.recreate = true;\n                diff.change.push(change);\n            }\n            else {\n                const oldIndexes = oldDef.idxByName;\n                const newIndexes = newDef.idxByName;\n                let idxName;\n                for (idxName in oldIndexes) {\n                    if (!newIndexes[idxName])\n                        change.del.push(idxName);\n                }\n                for (idxName in newIndexes) {\n                    const oldIdx = oldIndexes[idxName], newIdx = newIndexes[idxName];\n                    if (!oldIdx)\n                        change.add.push(newIdx);\n                    else if (oldIdx.src !== newIdx.src)\n                        change.change.push(newIdx);\n                }\n                if (change.del.length > 0 || change.add.length > 0 || change.change.length > 0) {\n                    diff.change.push(change);\n                }\n            }\n        }\n    }\n    return diff;\n}\nfunction createTable(idbtrans, tableName, primKey, indexes) {\n    const store = idbtrans.db.createObjectStore(tableName, primKey.keyPath ?\n        { keyPath: primKey.keyPath, autoIncrement: primKey.auto } :\n        { autoIncrement: primKey.auto });\n    indexes.forEach(idx => addIndex(store, idx));\n    return store;\n}\nfunction createMissingTables(newSchema, idbtrans) {\n    keys(newSchema).forEach(tableName => {\n        if (!idbtrans.db.objectStoreNames.contains(tableName)) {\n            createTable(idbtrans, tableName, newSchema[tableName].primKey, newSchema[tableName].indexes);\n        }\n    });\n}\nfunction deleteRemovedTables(newSchema, idbtrans) {\n    [].slice.call(idbtrans.db.objectStoreNames).forEach(storeName => newSchema[storeName] == null && idbtrans.db.deleteObjectStore(storeName));\n}\nfunction addIndex(store, idx) {\n    store.createIndex(idx.name, idx.keyPath, { unique: idx.unique, multiEntry: idx.multi });\n}\nfunction buildGlobalSchema(db, idbdb, tmpTrans) {\n    const globalSchema = {};\n    const dbStoreNames = slice(idbdb.objectStoreNames, 0);\n    dbStoreNames.forEach(storeName => {\n        const store = tmpTrans.objectStore(storeName);\n        let keyPath = store.keyPath;\n        const primKey = createIndexSpec(nameFromKeyPath(keyPath), keyPath || \"\", false, false, !!store.autoIncrement, keyPath && typeof keyPath !== \"string\", true);\n        const indexes = [];\n        for (let j = 0; j < store.indexNames.length; ++j) {\n            const idbindex = store.index(store.indexNames[j]);\n            keyPath = idbindex.keyPath;\n            var index = createIndexSpec(idbindex.name, keyPath, !!idbindex.unique, !!idbindex.multiEntry, false, keyPath && typeof keyPath !== \"string\", false);\n            indexes.push(index);\n        }\n        globalSchema[storeName] = createTableSchema(storeName, primKey, indexes);\n    });\n    return globalSchema;\n}\nfunction readGlobalSchema({ _novip: db }, idbdb, tmpTrans) {\n    db.verno = idbdb.version / 10;\n    const globalSchema = db._dbSchema = buildGlobalSchema(db, idbdb, tmpTrans);\n    db._storeNames = slice(idbdb.objectStoreNames, 0);\n    setApiOnPlace(db, [db._allTables], keys(globalSchema), globalSchema);\n}\nfunction verifyInstalledSchema(db, tmpTrans) {\n    const installedSchema = buildGlobalSchema(db, db.idbdb, tmpTrans);\n    const diff = getSchemaDiff(installedSchema, db._dbSchema);\n    return !(diff.add.length || diff.change.some(ch => ch.add.length || ch.change.length));\n}\nfunction adjustToExistingIndexNames({ _novip: db }, schema, idbtrans) {\n    const storeNames = idbtrans.db.objectStoreNames;\n    for (let i = 0; i < storeNames.length; ++i) {\n        const storeName = storeNames[i];\n        const store = idbtrans.objectStore(storeName);\n        db._hasGetAll = 'getAll' in store;\n        for (let j = 0; j < store.indexNames.length; ++j) {\n            const indexName = store.indexNames[j];\n            const keyPath = store.index(indexName).keyPath;\n            const dexieName = typeof keyPath === 'string' ? keyPath : \"[\" + slice(keyPath).join('+') + \"]\";\n            if (schema[storeName]) {\n                const indexSpec = schema[storeName].idxByName[dexieName];\n                if (indexSpec) {\n                    indexSpec.name = indexName;\n                    delete schema[storeName].idxByName[dexieName];\n                    schema[storeName].idxByName[indexName] = indexSpec;\n                }\n            }\n        }\n    }\n    if (typeof navigator !== 'undefined' && /Safari/.test(navigator.userAgent) &&\n        !/(Chrome\\/|Edge\\/)/.test(navigator.userAgent) &&\n        _global.WorkerGlobalScope && _global instanceof _global.WorkerGlobalScope &&\n        [].concat(navigator.userAgent.match(/Safari\\/(\\d*)/))[1] < 604) {\n        db._hasGetAll = false;\n    }\n}\nfunction parseIndexSyntax(primKeyAndIndexes) {\n    return primKeyAndIndexes.split(',').map((index, indexNum) => {\n        index = index.trim();\n        const name = index.replace(/([&*]|\\+\\+)/g, \"\");\n        const keyPath = /^\\[/.test(name) ? name.match(/^\\[(.*)\\]$/)[1].split('+') : name;\n        return createIndexSpec(name, keyPath || null, /\\&/.test(index), /\\*/.test(index), /\\+\\+/.test(index), isArray(keyPath), indexNum === 0);\n    });\n}\n\nclass Version {\n    _parseStoresSpec(stores, outSchema) {\n        keys(stores).forEach(tableName => {\n            if (stores[tableName] !== null) {\n                var indexes = parseIndexSyntax(stores[tableName]);\n                var primKey = indexes.shift();\n                if (primKey.multi)\n                    throw new exceptions.Schema(\"Primary key cannot be multi-valued\");\n                indexes.forEach(idx => {\n                    if (idx.auto)\n                        throw new exceptions.Schema(\"Only primary key can be marked as autoIncrement (++)\");\n                    if (!idx.keyPath)\n                        throw new exceptions.Schema(\"Index must have a name and cannot be an empty string\");\n                });\n                outSchema[tableName] = createTableSchema(tableName, primKey, indexes);\n            }\n        });\n    }\n    stores(stores) {\n        const db = this.db;\n        this._cfg.storesSource = this._cfg.storesSource ?\n            extend(this._cfg.storesSource, stores) :\n            stores;\n        const versions = db._versions;\n        const storesSpec = {};\n        let dbschema = {};\n        versions.forEach(version => {\n            extend(storesSpec, version._cfg.storesSource);\n            dbschema = (version._cfg.dbschema = {});\n            version._parseStoresSpec(storesSpec, dbschema);\n        });\n        db._dbSchema = dbschema;\n        removeTablesApi(db, [db._allTables, db, db.Transaction.prototype]);\n        setApiOnPlace(db, [db._allTables, db, db.Transaction.prototype, this._cfg.tables], keys(dbschema), dbschema);\n        db._storeNames = keys(dbschema);\n        return this;\n    }\n    upgrade(upgradeFunction) {\n        this._cfg.contentUpgrade = promisableChain(this._cfg.contentUpgrade || nop, upgradeFunction);\n        return this;\n    }\n}\n\nfunction createVersionConstructor(db) {\n    return makeClassConstructor(Version.prototype, function Version(versionNumber) {\n        this.db = db;\n        this._cfg = {\n            version: versionNumber,\n            storesSource: null,\n            dbschema: {},\n            tables: {},\n            contentUpgrade: null\n        };\n    });\n}\n\nfunction getDbNamesTable(indexedDB, IDBKeyRange) {\n    let dbNamesDB = indexedDB[\"_dbNamesDB\"];\n    if (!dbNamesDB) {\n        dbNamesDB = indexedDB[\"_dbNamesDB\"] = new Dexie$1(DBNAMES_DB, {\n            addons: [],\n            indexedDB,\n            IDBKeyRange,\n        });\n        dbNamesDB.version(1).stores({ dbnames: \"name\" });\n    }\n    return dbNamesDB.table(\"dbnames\");\n}\nfunction hasDatabasesNative(indexedDB) {\n    return indexedDB && typeof indexedDB.databases === \"function\";\n}\nfunction getDatabaseNames({ indexedDB, IDBKeyRange, }) {\n    return hasDatabasesNative(indexedDB)\n        ? Promise.resolve(indexedDB.databases()).then((infos) => infos\n            .map((info) => info.name)\n            .filter((name) => name !== DBNAMES_DB))\n        : getDbNamesTable(indexedDB, IDBKeyRange).toCollection().primaryKeys();\n}\nfunction _onDatabaseCreated({ indexedDB, IDBKeyRange }, name) {\n    !hasDatabasesNative(indexedDB) &&\n        name !== DBNAMES_DB &&\n        getDbNamesTable(indexedDB, IDBKeyRange).put({ name }).catch(nop);\n}\nfunction _onDatabaseDeleted({ indexedDB, IDBKeyRange }, name) {\n    !hasDatabasesNative(indexedDB) &&\n        name !== DBNAMES_DB &&\n        getDbNamesTable(indexedDB, IDBKeyRange).delete(name).catch(nop);\n}\n\nfunction vip(fn) {\n    return newScope(function () {\n        PSD.letThrough = true;\n        return fn();\n    });\n}\n\nfunction idbReady() {\n    var isSafari = !navigator.userAgentData &&\n        /Safari\\//.test(navigator.userAgent) &&\n        !/Chrom(e|ium)\\//.test(navigator.userAgent);\n    if (!isSafari || !indexedDB.databases)\n        return Promise.resolve();\n    var intervalId;\n    return new Promise(function (resolve) {\n        var tryIdb = function () { return indexedDB.databases().finally(resolve); };\n        intervalId = setInterval(tryIdb, 100);\n        tryIdb();\n    }).finally(function () { return clearInterval(intervalId); });\n}\n\nfunction dexieOpen(db) {\n    const state = db._state;\n    const { indexedDB } = db._deps;\n    if (state.isBeingOpened || db.idbdb)\n        return state.dbReadyPromise.then(() => state.dbOpenError ?\n            rejection(state.dbOpenError) :\n            db);\n    debug && (state.openCanceller._stackHolder = getErrorWithStack());\n    state.isBeingOpened = true;\n    state.dbOpenError = null;\n    state.openComplete = false;\n    const openCanceller = state.openCanceller;\n    function throwIfCancelled() {\n        if (state.openCanceller !== openCanceller)\n            throw new exceptions.DatabaseClosed('db.open() was cancelled');\n    }\n    let resolveDbReady = state.dbReadyResolve,\n    upgradeTransaction = null, wasCreated = false;\n    const tryOpenDB = () => new DexiePromise((resolve, reject) => {\n        throwIfCancelled();\n        if (!indexedDB)\n            throw new exceptions.MissingAPI();\n        const dbName = db.name;\n        const req = state.autoSchema ?\n            indexedDB.open(dbName) :\n            indexedDB.open(dbName, Math.round(db.verno * 10));\n        if (!req)\n            throw new exceptions.MissingAPI();\n        req.onerror = eventRejectHandler(reject);\n        req.onblocked = wrap(db._fireOnBlocked);\n        req.onupgradeneeded = wrap(e => {\n            upgradeTransaction = req.transaction;\n            if (state.autoSchema && !db._options.allowEmptyDB) {\n                req.onerror = preventDefault;\n                upgradeTransaction.abort();\n                req.result.close();\n                const delreq = indexedDB.deleteDatabase(dbName);\n                delreq.onsuccess = delreq.onerror = wrap(() => {\n                    reject(new exceptions.NoSuchDatabase(`Database ${dbName} doesnt exist`));\n                });\n            }\n            else {\n                upgradeTransaction.onerror = eventRejectHandler(reject);\n                var oldVer = e.oldVersion > Math.pow(2, 62) ? 0 : e.oldVersion;\n                wasCreated = oldVer < 1;\n                db._novip.idbdb = req.result;\n                runUpgraders(db, oldVer / 10, upgradeTransaction, reject);\n            }\n        }, reject);\n        req.onsuccess = wrap(() => {\n            upgradeTransaction = null;\n            const idbdb = db._novip.idbdb = req.result;\n            const objectStoreNames = slice(idbdb.objectStoreNames);\n            if (objectStoreNames.length > 0)\n                try {\n                    const tmpTrans = idbdb.transaction(safariMultiStoreFix(objectStoreNames), 'readonly');\n                    if (state.autoSchema)\n                        readGlobalSchema(db, idbdb, tmpTrans);\n                    else {\n                        adjustToExistingIndexNames(db, db._dbSchema, tmpTrans);\n                        if (!verifyInstalledSchema(db, tmpTrans)) {\n                            console.warn(`Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.`);\n                        }\n                    }\n                    generateMiddlewareStacks(db, tmpTrans);\n                }\n                catch (e) {\n                }\n            connections.push(db);\n            idbdb.onversionchange = wrap(ev => {\n                state.vcFired = true;\n                db.on(\"versionchange\").fire(ev);\n            });\n            idbdb.onclose = wrap(ev => {\n                db.on(\"close\").fire(ev);\n            });\n            if (wasCreated)\n                _onDatabaseCreated(db._deps, dbName);\n            resolve();\n        }, reject);\n    }).catch(err => {\n        if (err && err.name === 'UnknownError' && state.PR1398_maxLoop > 0) {\n            state.PR1398_maxLoop--;\n            console.warn('Dexie: Workaround for Chrome UnknownError on open()');\n            return tryOpenDB();\n        }\n        else {\n            return DexiePromise.reject(err);\n        }\n    });\n    return DexiePromise.race([\n        openCanceller,\n        (typeof navigator === 'undefined' ? DexiePromise.resolve() : idbReady()).then(tryOpenDB)\n    ]).then(() => {\n        throwIfCancelled();\n        state.onReadyBeingFired = [];\n        return DexiePromise.resolve(vip(() => db.on.ready.fire(db.vip))).then(function fireRemainders() {\n            if (state.onReadyBeingFired.length > 0) {\n                let remainders = state.onReadyBeingFired.reduce(promisableChain, nop);\n                state.onReadyBeingFired = [];\n                return DexiePromise.resolve(vip(() => remainders(db.vip))).then(fireRemainders);\n            }\n        });\n    }).finally(() => {\n        state.onReadyBeingFired = null;\n        state.isBeingOpened = false;\n    }).then(() => {\n        return db;\n    }).catch(err => {\n        state.dbOpenError = err;\n        try {\n            upgradeTransaction && upgradeTransaction.abort();\n        }\n        catch (_a) { }\n        if (openCanceller === state.openCanceller) {\n            db._close();\n        }\n        return rejection(err);\n    }).finally(() => {\n        state.openComplete = true;\n        resolveDbReady();\n    });\n}\n\nfunction awaitIterator(iterator) {\n    var callNext = result => iterator.next(result), doThrow = error => iterator.throw(error), onSuccess = step(callNext), onError = step(doThrow);\n    function step(getNext) {\n        return (val) => {\n            var next = getNext(val), value = next.value;\n            return next.done ? value :\n                (!value || typeof value.then !== 'function' ?\n                    isArray(value) ? Promise.all(value).then(onSuccess, onError) : onSuccess(value) :\n                    value.then(onSuccess, onError));\n        };\n    }\n    return step(callNext)();\n}\n\nfunction extractTransactionArgs(mode, _tableArgs_, scopeFunc) {\n    var i = arguments.length;\n    if (i < 2)\n        throw new exceptions.InvalidArgument(\"Too few arguments\");\n    var args = new Array(i - 1);\n    while (--i)\n        args[i - 1] = arguments[i];\n    scopeFunc = args.pop();\n    var tables = flatten(args);\n    return [mode, tables, scopeFunc];\n}\nfunction enterTransactionScope(db, mode, storeNames, parentTransaction, scopeFunc) {\n    return DexiePromise.resolve().then(() => {\n        const transless = PSD.transless || PSD;\n        const trans = db._createTransaction(mode, storeNames, db._dbSchema, parentTransaction);\n        const zoneProps = {\n            trans: trans,\n            transless: transless\n        };\n        if (parentTransaction) {\n            trans.idbtrans = parentTransaction.idbtrans;\n        }\n        else {\n            try {\n                trans.create();\n                db._state.PR1398_maxLoop = 3;\n            }\n            catch (ex) {\n                if (ex.name === errnames.InvalidState && db.isOpen() && --db._state.PR1398_maxLoop > 0) {\n                    console.warn('Dexie: Need to reopen db');\n                    db._close();\n                    return db.open().then(() => enterTransactionScope(db, mode, storeNames, null, scopeFunc));\n                }\n                return rejection(ex);\n            }\n        }\n        const scopeFuncIsAsync = isAsyncFunction(scopeFunc);\n        if (scopeFuncIsAsync) {\n            incrementExpectedAwaits();\n        }\n        let returnValue;\n        const promiseFollowed = DexiePromise.follow(() => {\n            returnValue = scopeFunc.call(trans, trans);\n            if (returnValue) {\n                if (scopeFuncIsAsync) {\n                    var decrementor = decrementExpectedAwaits.bind(null, null);\n                    returnValue.then(decrementor, decrementor);\n                }\n                else if (typeof returnValue.next === 'function' && typeof returnValue.throw === 'function') {\n                    returnValue = awaitIterator(returnValue);\n                }\n            }\n        }, zoneProps);\n        return (returnValue && typeof returnValue.then === 'function' ?\n            DexiePromise.resolve(returnValue).then(x => trans.active ?\n                x\n                : rejection(new exceptions.PrematureCommit(\"Transaction committed too early. See http://bit.ly/2kdckMn\")))\n            : promiseFollowed.then(() => returnValue)).then(x => {\n            if (parentTransaction)\n                trans._resolve();\n            return trans._completion.then(() => x);\n        }).catch(e => {\n            trans._reject(e);\n            return rejection(e);\n        });\n    });\n}\n\nfunction pad(a, value, count) {\n    const result = isArray(a) ? a.slice() : [a];\n    for (let i = 0; i < count; ++i)\n        result.push(value);\n    return result;\n}\nfunction createVirtualIndexMiddleware(down) {\n    return {\n        ...down,\n        table(tableName) {\n            const table = down.table(tableName);\n            const { schema } = table;\n            const indexLookup = {};\n            const allVirtualIndexes = [];\n            function addVirtualIndexes(keyPath, keyTail, lowLevelIndex) {\n                const keyPathAlias = getKeyPathAlias(keyPath);\n                const indexList = (indexLookup[keyPathAlias] = indexLookup[keyPathAlias] || []);\n                const keyLength = keyPath == null ? 0 : typeof keyPath === 'string' ? 1 : keyPath.length;\n                const isVirtual = keyTail > 0;\n                const virtualIndex = {\n                    ...lowLevelIndex,\n                    isVirtual,\n                    keyTail,\n                    keyLength,\n                    extractKey: getKeyExtractor(keyPath),\n                    unique: !isVirtual && lowLevelIndex.unique\n                };\n                indexList.push(virtualIndex);\n                if (!virtualIndex.isPrimaryKey) {\n                    allVirtualIndexes.push(virtualIndex);\n                }\n                if (keyLength > 1) {\n                    const virtualKeyPath = keyLength === 2 ?\n                        keyPath[0] :\n                        keyPath.slice(0, keyLength - 1);\n                    addVirtualIndexes(virtualKeyPath, keyTail + 1, lowLevelIndex);\n                }\n                indexList.sort((a, b) => a.keyTail - b.keyTail);\n                return virtualIndex;\n            }\n            const primaryKey = addVirtualIndexes(schema.primaryKey.keyPath, 0, schema.primaryKey);\n            indexLookup[\":id\"] = [primaryKey];\n            for (const index of schema.indexes) {\n                addVirtualIndexes(index.keyPath, 0, index);\n            }\n            function findBestIndex(keyPath) {\n                const result = indexLookup[getKeyPathAlias(keyPath)];\n                return result && result[0];\n            }\n            function translateRange(range, keyTail) {\n                return {\n                    type: range.type === 1  ?\n                        2  :\n                        range.type,\n                    lower: pad(range.lower, range.lowerOpen ? down.MAX_KEY : down.MIN_KEY, keyTail),\n                    lowerOpen: true,\n                    upper: pad(range.upper, range.upperOpen ? down.MIN_KEY : down.MAX_KEY, keyTail),\n                    upperOpen: true\n                };\n            }\n            function translateRequest(req) {\n                const index = req.query.index;\n                return index.isVirtual ? {\n                    ...req,\n                    query: {\n                        index,\n                        range: translateRange(req.query.range, index.keyTail)\n                    }\n                } : req;\n            }\n            const result = {\n                ...table,\n                schema: {\n                    ...schema,\n                    primaryKey,\n                    indexes: allVirtualIndexes,\n                    getIndexByKeyPath: findBestIndex\n                },\n                count(req) {\n                    return table.count(translateRequest(req));\n                },\n                query(req) {\n                    return table.query(translateRequest(req));\n                },\n                openCursor(req) {\n                    const { keyTail, isVirtual, keyLength } = req.query.index;\n                    if (!isVirtual)\n                        return table.openCursor(req);\n                    function createVirtualCursor(cursor) {\n                        function _continue(key) {\n                            key != null ?\n                                cursor.continue(pad(key, req.reverse ? down.MAX_KEY : down.MIN_KEY, keyTail)) :\n                                req.unique ?\n                                    cursor.continue(cursor.key.slice(0, keyLength)\n                                        .concat(req.reverse\n                                        ? down.MIN_KEY\n                                        : down.MAX_KEY, keyTail)) :\n                                    cursor.continue();\n                        }\n                        const virtualCursor = Object.create(cursor, {\n                            continue: { value: _continue },\n                            continuePrimaryKey: {\n                                value(key, primaryKey) {\n                                    cursor.continuePrimaryKey(pad(key, down.MAX_KEY, keyTail), primaryKey);\n                                }\n                            },\n                            primaryKey: {\n                                get() {\n                                    return cursor.primaryKey;\n                                }\n                            },\n                            key: {\n                                get() {\n                                    const key = cursor.key;\n                                    return keyLength === 1 ?\n                                        key[0] :\n                                        key.slice(0, keyLength);\n                                }\n                            },\n                            value: {\n                                get() {\n                                    return cursor.value;\n                                }\n                            }\n                        });\n                        return virtualCursor;\n                    }\n                    return table.openCursor(translateRequest(req))\n                        .then(cursor => cursor && createVirtualCursor(cursor));\n                }\n            };\n            return result;\n        }\n    };\n}\nconst virtualIndexMiddleware = {\n    stack: \"dbcore\",\n    name: \"VirtualIndexMiddleware\",\n    level: 1,\n    create: createVirtualIndexMiddleware\n};\n\nfunction getObjectDiff(a, b, rv, prfx) {\n    rv = rv || {};\n    prfx = prfx || '';\n    keys(a).forEach((prop) => {\n        if (!hasOwn(b, prop)) {\n            rv[prfx + prop] = undefined;\n        }\n        else {\n            var ap = a[prop], bp = b[prop];\n            if (typeof ap === 'object' && typeof bp === 'object' && ap && bp) {\n                const apTypeName = toStringTag(ap);\n                const bpTypeName = toStringTag(bp);\n                if (apTypeName !== bpTypeName) {\n                    rv[prfx + prop] = b[prop];\n                }\n                else if (apTypeName === 'Object') {\n                    getObjectDiff(ap, bp, rv, prfx + prop + '.');\n                }\n                else if (ap !== bp) {\n                    rv[prfx + prop] = b[prop];\n                }\n            }\n            else if (ap !== bp)\n                rv[prfx + prop] = b[prop];\n        }\n    });\n    keys(b).forEach((prop) => {\n        if (!hasOwn(a, prop)) {\n            rv[prfx + prop] = b[prop];\n        }\n    });\n    return rv;\n}\n\nfunction getEffectiveKeys(primaryKey, req) {\n    if (req.type === 'delete')\n        return req.keys;\n    return req.keys || req.values.map(primaryKey.extractKey);\n}\n\nconst hooksMiddleware = {\n    stack: \"dbcore\",\n    name: \"HooksMiddleware\",\n    level: 2,\n    create: (downCore) => ({\n        ...downCore,\n        table(tableName) {\n            const downTable = downCore.table(tableName);\n            const { primaryKey } = downTable.schema;\n            const tableMiddleware = {\n                ...downTable,\n                mutate(req) {\n                    const dxTrans = PSD.trans;\n                    const { deleting, creating, updating } = dxTrans.table(tableName).hook;\n                    switch (req.type) {\n                        case 'add':\n                            if (creating.fire === nop)\n                                break;\n                            return dxTrans._promise('readwrite', () => addPutOrDelete(req), true);\n                        case 'put':\n                            if (creating.fire === nop && updating.fire === nop)\n                                break;\n                            return dxTrans._promise('readwrite', () => addPutOrDelete(req), true);\n                        case 'delete':\n                            if (deleting.fire === nop)\n                                break;\n                            return dxTrans._promise('readwrite', () => addPutOrDelete(req), true);\n                        case 'deleteRange':\n                            if (deleting.fire === nop)\n                                break;\n                            return dxTrans._promise('readwrite', () => deleteRange(req), true);\n                    }\n                    return downTable.mutate(req);\n                    function addPutOrDelete(req) {\n                        const dxTrans = PSD.trans;\n                        const keys = req.keys || getEffectiveKeys(primaryKey, req);\n                        if (!keys)\n                            throw new Error(\"Keys missing\");\n                        req = req.type === 'add' || req.type === 'put' ?\n                            { ...req, keys } :\n                            { ...req };\n                        if (req.type !== 'delete')\n                            req.values = [...req.values];\n                        if (req.keys)\n                            req.keys = [...req.keys];\n                        return getExistingValues(downTable, req, keys).then(existingValues => {\n                            const contexts = keys.map((key, i) => {\n                                const existingValue = existingValues[i];\n                                const ctx = { onerror: null, onsuccess: null };\n                                if (req.type === 'delete') {\n                                    deleting.fire.call(ctx, key, existingValue, dxTrans);\n                                }\n                                else if (req.type === 'add' || existingValue === undefined) {\n                                    const generatedPrimaryKey = creating.fire.call(ctx, key, req.values[i], dxTrans);\n                                    if (key == null && generatedPrimaryKey != null) {\n                                        key = generatedPrimaryKey;\n                                        req.keys[i] = key;\n                                        if (!primaryKey.outbound) {\n                                            setByKeyPath(req.values[i], primaryKey.keyPath, key);\n                                        }\n                                    }\n                                }\n                                else {\n                                    const objectDiff = getObjectDiff(existingValue, req.values[i]);\n                                    const additionalChanges = updating.fire.call(ctx, objectDiff, key, existingValue, dxTrans);\n                                    if (additionalChanges) {\n                                        const requestedValue = req.values[i];\n                                        Object.keys(additionalChanges).forEach(keyPath => {\n                                            if (hasOwn(requestedValue, keyPath)) {\n                                                requestedValue[keyPath] = additionalChanges[keyPath];\n                                            }\n                                            else {\n                                                setByKeyPath(requestedValue, keyPath, additionalChanges[keyPath]);\n                                            }\n                                        });\n                                    }\n                                }\n                                return ctx;\n                            });\n                            return downTable.mutate(req).then(({ failures, results, numFailures, lastResult }) => {\n                                for (let i = 0; i < keys.length; ++i) {\n                                    const primKey = results ? results[i] : keys[i];\n                                    const ctx = contexts[i];\n                                    if (primKey == null) {\n                                        ctx.onerror && ctx.onerror(failures[i]);\n                                    }\n                                    else {\n                                        ctx.onsuccess && ctx.onsuccess(req.type === 'put' && existingValues[i] ?\n                                            req.values[i] :\n                                            primKey\n                                        );\n                                    }\n                                }\n                                return { failures, results, numFailures, lastResult };\n                            }).catch(error => {\n                                contexts.forEach(ctx => ctx.onerror && ctx.onerror(error));\n                                return Promise.reject(error);\n                            });\n                        });\n                    }\n                    function deleteRange(req) {\n                        return deleteNextChunk(req.trans, req.range, 10000);\n                    }\n                    function deleteNextChunk(trans, range, limit) {\n                        return downTable.query({ trans, values: false, query: { index: primaryKey, range }, limit })\n                            .then(({ result }) => {\n                            return addPutOrDelete({ type: 'delete', keys: result, trans }).then(res => {\n                                if (res.numFailures > 0)\n                                    return Promise.reject(res.failures[0]);\n                                if (result.length < limit) {\n                                    return { failures: [], numFailures: 0, lastResult: undefined };\n                                }\n                                else {\n                                    return deleteNextChunk(trans, { ...range, lower: result[result.length - 1], lowerOpen: true }, limit);\n                                }\n                            });\n                        });\n                    }\n                }\n            };\n            return tableMiddleware;\n        },\n    })\n};\nfunction getExistingValues(table, req, effectiveKeys) {\n    return req.type === \"add\"\n        ? Promise.resolve([])\n        : table.getMany({ trans: req.trans, keys: effectiveKeys, cache: \"immutable\" });\n}\n\nfunction getFromTransactionCache(keys, cache, clone) {\n    try {\n        if (!cache)\n            return null;\n        if (cache.keys.length < keys.length)\n            return null;\n        const result = [];\n        for (let i = 0, j = 0; i < cache.keys.length && j < keys.length; ++i) {\n            if (cmp(cache.keys[i], keys[j]) !== 0)\n                continue;\n            result.push(clone ? deepClone(cache.values[i]) : cache.values[i]);\n            ++j;\n        }\n        return result.length === keys.length ? result : null;\n    }\n    catch (_a) {\n        return null;\n    }\n}\nconst cacheExistingValuesMiddleware = {\n    stack: \"dbcore\",\n    level: -1,\n    create: (core) => {\n        return {\n            table: (tableName) => {\n                const table = core.table(tableName);\n                return {\n                    ...table,\n                    getMany: (req) => {\n                        if (!req.cache) {\n                            return table.getMany(req);\n                        }\n                        const cachedResult = getFromTransactionCache(req.keys, req.trans[\"_cache\"], req.cache === \"clone\");\n                        if (cachedResult) {\n                            return DexiePromise.resolve(cachedResult);\n                        }\n                        return table.getMany(req).then((res) => {\n                            req.trans[\"_cache\"] = {\n                                keys: req.keys,\n                                values: req.cache === \"clone\" ? deepClone(res) : res,\n                            };\n                            return res;\n                        });\n                    },\n                    mutate: (req) => {\n                        if (req.type !== \"add\")\n                            req.trans[\"_cache\"] = null;\n                        return table.mutate(req);\n                    },\n                };\n            },\n        };\n    },\n};\n\nfunction isEmptyRange(node) {\n    return !(\"from\" in node);\n}\nconst RangeSet = function (fromOrTree, to) {\n    if (this) {\n        extend(this, arguments.length ? { d: 1, from: fromOrTree, to: arguments.length > 1 ? to : fromOrTree } : { d: 0 });\n    }\n    else {\n        const rv = new RangeSet();\n        if (fromOrTree && (\"d\" in fromOrTree)) {\n            extend(rv, fromOrTree);\n        }\n        return rv;\n    }\n};\nprops(RangeSet.prototype, {\n    add(rangeSet) {\n        mergeRanges(this, rangeSet);\n        return this;\n    },\n    addKey(key) {\n        addRange(this, key, key);\n        return this;\n    },\n    addKeys(keys) {\n        keys.forEach(key => addRange(this, key, key));\n        return this;\n    },\n    [iteratorSymbol]() {\n        return getRangeSetIterator(this);\n    }\n});\nfunction addRange(target, from, to) {\n    const diff = cmp(from, to);\n    if (isNaN(diff))\n        return;\n    if (diff > 0)\n        throw RangeError();\n    if (isEmptyRange(target))\n        return extend(target, { from, to, d: 1 });\n    const left = target.l;\n    const right = target.r;\n    if (cmp(to, target.from) < 0) {\n        left\n            ? addRange(left, from, to)\n            : (target.l = { from, to, d: 1, l: null, r: null });\n        return rebalance(target);\n    }\n    if (cmp(from, target.to) > 0) {\n        right\n            ? addRange(right, from, to)\n            : (target.r = { from, to, d: 1, l: null, r: null });\n        return rebalance(target);\n    }\n    if (cmp(from, target.from) < 0) {\n        target.from = from;\n        target.l = null;\n        target.d = right ? right.d + 1 : 1;\n    }\n    if (cmp(to, target.to) > 0) {\n        target.to = to;\n        target.r = null;\n        target.d = target.l ? target.l.d + 1 : 1;\n    }\n    const rightWasCutOff = !target.r;\n    if (left && !target.l) {\n        mergeRanges(target, left);\n    }\n    if (right && rightWasCutOff) {\n        mergeRanges(target, right);\n    }\n}\nfunction mergeRanges(target, newSet) {\n    function _addRangeSet(target, { from, to, l, r }) {\n        addRange(target, from, to);\n        if (l)\n            _addRangeSet(target, l);\n        if (r)\n            _addRangeSet(target, r);\n    }\n    if (!isEmptyRange(newSet))\n        _addRangeSet(target, newSet);\n}\nfunction rangesOverlap(rangeSet1, rangeSet2) {\n    const i1 = getRangeSetIterator(rangeSet2);\n    let nextResult1 = i1.next();\n    if (nextResult1.done)\n        return false;\n    let a = nextResult1.value;\n    const i2 = getRangeSetIterator(rangeSet1);\n    let nextResult2 = i2.next(a.from);\n    let b = nextResult2.value;\n    while (!nextResult1.done && !nextResult2.done) {\n        if (cmp(b.from, a.to) <= 0 && cmp(b.to, a.from) >= 0)\n            return true;\n        cmp(a.from, b.from) < 0\n            ? (a = (nextResult1 = i1.next(b.from)).value)\n            : (b = (nextResult2 = i2.next(a.from)).value);\n    }\n    return false;\n}\nfunction getRangeSetIterator(node) {\n    let state = isEmptyRange(node) ? null : { s: 0, n: node };\n    return {\n        next(key) {\n            const keyProvided = arguments.length > 0;\n            while (state) {\n                switch (state.s) {\n                    case 0:\n                        state.s = 1;\n                        if (keyProvided) {\n                            while (state.n.l && cmp(key, state.n.from) < 0)\n                                state = { up: state, n: state.n.l, s: 1 };\n                        }\n                        else {\n                            while (state.n.l)\n                                state = { up: state, n: state.n.l, s: 1 };\n                        }\n                    case 1:\n                        state.s = 2;\n                        if (!keyProvided || cmp(key, state.n.to) <= 0)\n                            return { value: state.n, done: false };\n                    case 2:\n                        if (state.n.r) {\n                            state.s = 3;\n                            state = { up: state, n: state.n.r, s: 0 };\n                            continue;\n                        }\n                    case 3:\n                        state = state.up;\n                }\n            }\n            return { done: true };\n        },\n    };\n}\nfunction rebalance(target) {\n    var _a, _b;\n    const diff = (((_a = target.r) === null || _a === void 0 ? void 0 : _a.d) || 0) - (((_b = target.l) === null || _b === void 0 ? void 0 : _b.d) || 0);\n    const r = diff > 1 ? \"r\" : diff < -1 ? \"l\" : \"\";\n    if (r) {\n        const l = r === \"r\" ? \"l\" : \"r\";\n        const rootClone = { ...target };\n        const oldRootRight = target[r];\n        target.from = oldRootRight.from;\n        target.to = oldRootRight.to;\n        target[r] = oldRootRight[r];\n        rootClone[r] = oldRootRight[l];\n        target[l] = rootClone;\n        rootClone.d = computeDepth(rootClone);\n    }\n    target.d = computeDepth(target);\n}\nfunction computeDepth({ r, l }) {\n    return (r ? (l ? Math.max(r.d, l.d) : r.d) : l ? l.d : 0) + 1;\n}\n\nconst observabilityMiddleware = {\n    stack: \"dbcore\",\n    level: 0,\n    create: (core) => {\n        const dbName = core.schema.name;\n        const FULL_RANGE = new RangeSet(core.MIN_KEY, core.MAX_KEY);\n        return {\n            ...core,\n            table: (tableName) => {\n                const table = core.table(tableName);\n                const { schema } = table;\n                const { primaryKey } = schema;\n                const { extractKey, outbound } = primaryKey;\n                const tableClone = {\n                    ...table,\n                    mutate: (req) => {\n                        const trans = req.trans;\n                        const mutatedParts = trans.mutatedParts || (trans.mutatedParts = {});\n                        const getRangeSet = (indexName) => {\n                            const part = `idb://${dbName}/${tableName}/${indexName}`;\n                            return (mutatedParts[part] ||\n                                (mutatedParts[part] = new RangeSet()));\n                        };\n                        const pkRangeSet = getRangeSet(\"\");\n                        const delsRangeSet = getRangeSet(\":dels\");\n                        const { type } = req;\n                        let [keys, newObjs] = req.type === \"deleteRange\"\n                            ? [req.range]\n                            : req.type === \"delete\"\n                                ? [req.keys]\n                                : req.values.length < 50\n                                    ? [[], req.values]\n                                    : [];\n                        const oldCache = req.trans[\"_cache\"];\n                        return table.mutate(req).then((res) => {\n                            if (isArray(keys)) {\n                                if (type !== \"delete\")\n                                    keys = res.results;\n                                pkRangeSet.addKeys(keys);\n                                const oldObjs = getFromTransactionCache(keys, oldCache);\n                                if (!oldObjs && type !== \"add\") {\n                                    delsRangeSet.addKeys(keys);\n                                }\n                                if (oldObjs || newObjs) {\n                                    trackAffectedIndexes(getRangeSet, schema, oldObjs, newObjs);\n                                }\n                            }\n                            else if (keys) {\n                                const range = { from: keys.lower, to: keys.upper };\n                                delsRangeSet.add(range);\n                                pkRangeSet.add(range);\n                            }\n                            else {\n                                pkRangeSet.add(FULL_RANGE);\n                                delsRangeSet.add(FULL_RANGE);\n                                schema.indexes.forEach(idx => getRangeSet(idx.name).add(FULL_RANGE));\n                            }\n                            return res;\n                        });\n                    },\n                };\n                const getRange = ({ query: { index, range }, }) => {\n                    var _a, _b;\n                    return [\n                        index,\n                        new RangeSet((_a = range.lower) !== null && _a !== void 0 ? _a : core.MIN_KEY, (_b = range.upper) !== null && _b !== void 0 ? _b : core.MAX_KEY),\n                    ];\n                };\n                const readSubscribers = {\n                    get: (req) => [primaryKey, new RangeSet(req.key)],\n                    getMany: (req) => [primaryKey, new RangeSet().addKeys(req.keys)],\n                    count: getRange,\n                    query: getRange,\n                    openCursor: getRange,\n                };\n                keys(readSubscribers).forEach(method => {\n                    tableClone[method] = function (req) {\n                        const { subscr } = PSD;\n                        if (subscr) {\n                            const getRangeSet = (indexName) => {\n                                const part = `idb://${dbName}/${tableName}/${indexName}`;\n                                return (subscr[part] ||\n                                    (subscr[part] = new RangeSet()));\n                            };\n                            const pkRangeSet = getRangeSet(\"\");\n                            const delsRangeSet = getRangeSet(\":dels\");\n                            const [queriedIndex, queriedRanges] = readSubscribers[method](req);\n                            getRangeSet(queriedIndex.name || \"\").add(queriedRanges);\n                            if (!queriedIndex.isPrimaryKey) {\n                                if (method === \"count\") {\n                                    delsRangeSet.add(FULL_RANGE);\n                                }\n                                else {\n                                    const keysPromise = method === \"query\" &&\n                                        outbound &&\n                                        req.values &&\n                                        table.query({\n                                            ...req,\n                                            values: false,\n                                        });\n                                    return table[method].apply(this, arguments).then((res) => {\n                                        if (method === \"query\") {\n                                            if (outbound && req.values) {\n                                                return keysPromise.then(({ result: resultingKeys }) => {\n                                                    pkRangeSet.addKeys(resultingKeys);\n                                                    return res;\n                                                });\n                                            }\n                                            const pKeys = req.values\n                                                ? res.result.map(extractKey)\n                                                : res.result;\n                                            if (req.values) {\n                                                pkRangeSet.addKeys(pKeys);\n                                            }\n                                            else {\n                                                delsRangeSet.addKeys(pKeys);\n                                            }\n                                        }\n                                        else if (method === \"openCursor\") {\n                                            const cursor = res;\n                                            const wantValues = req.values;\n                                            return (cursor &&\n                                                Object.create(cursor, {\n                                                    key: {\n                                                        get() {\n                                                            delsRangeSet.addKey(cursor.primaryKey);\n                                                            return cursor.key;\n                                                        },\n                                                    },\n                                                    primaryKey: {\n                                                        get() {\n                                                            const pkey = cursor.primaryKey;\n                                                            delsRangeSet.addKey(pkey);\n                                                            return pkey;\n                                                        },\n                                                    },\n                                                    value: {\n                                                        get() {\n                                                            wantValues && pkRangeSet.addKey(cursor.primaryKey);\n                                                            return cursor.value;\n                                                        },\n                                                    },\n                                                }));\n                                        }\n                                        return res;\n                                    });\n                                }\n                            }\n                        }\n                        return table[method].apply(this, arguments);\n                    };\n                });\n                return tableClone;\n            },\n        };\n    },\n};\nfunction trackAffectedIndexes(getRangeSet, schema, oldObjs, newObjs) {\n    function addAffectedIndex(ix) {\n        const rangeSet = getRangeSet(ix.name || \"\");\n        function extractKey(obj) {\n            return obj != null ? ix.extractKey(obj) : null;\n        }\n        const addKeyOrKeys = (key) => ix.multiEntry && isArray(key)\n            ? key.forEach(key => rangeSet.addKey(key))\n            : rangeSet.addKey(key);\n        (oldObjs || newObjs).forEach((_, i) => {\n            const oldKey = oldObjs && extractKey(oldObjs[i]);\n            const newKey = newObjs && extractKey(newObjs[i]);\n            if (cmp(oldKey, newKey) !== 0) {\n                if (oldKey != null)\n                    addKeyOrKeys(oldKey);\n                if (newKey != null)\n                    addKeyOrKeys(newKey);\n            }\n        });\n    }\n    schema.indexes.forEach(addAffectedIndex);\n}\n\nclass Dexie$1 {\n    constructor(name, options) {\n        this._middlewares = {};\n        this.verno = 0;\n        const deps = Dexie$1.dependencies;\n        this._options = options = {\n            addons: Dexie$1.addons,\n            autoOpen: true,\n            indexedDB: deps.indexedDB,\n            IDBKeyRange: deps.IDBKeyRange,\n            ...options\n        };\n        this._deps = {\n            indexedDB: options.indexedDB,\n            IDBKeyRange: options.IDBKeyRange\n        };\n        const { addons, } = options;\n        this._dbSchema = {};\n        this._versions = [];\n        this._storeNames = [];\n        this._allTables = {};\n        this.idbdb = null;\n        this._novip = this;\n        const state = {\n            dbOpenError: null,\n            isBeingOpened: false,\n            onReadyBeingFired: null,\n            openComplete: false,\n            dbReadyResolve: nop,\n            dbReadyPromise: null,\n            cancelOpen: nop,\n            openCanceller: null,\n            autoSchema: true,\n            PR1398_maxLoop: 3\n        };\n        state.dbReadyPromise = new DexiePromise(resolve => {\n            state.dbReadyResolve = resolve;\n        });\n        state.openCanceller = new DexiePromise((_, reject) => {\n            state.cancelOpen = reject;\n        });\n        this._state = state;\n        this.name = name;\n        this.on = Events(this, \"populate\", \"blocked\", \"versionchange\", \"close\", { ready: [promisableChain, nop] });\n        this.on.ready.subscribe = override(this.on.ready.subscribe, subscribe => {\n            return (subscriber, bSticky) => {\n                Dexie$1.vip(() => {\n                    const state = this._state;\n                    if (state.openComplete) {\n                        if (!state.dbOpenError)\n                            DexiePromise.resolve().then(subscriber);\n                        if (bSticky)\n                            subscribe(subscriber);\n                    }\n                    else if (state.onReadyBeingFired) {\n                        state.onReadyBeingFired.push(subscriber);\n                        if (bSticky)\n                            subscribe(subscriber);\n                    }\n                    else {\n                        subscribe(subscriber);\n                        const db = this;\n                        if (!bSticky)\n                            subscribe(function unsubscribe() {\n                                db.on.ready.unsubscribe(subscriber);\n                                db.on.ready.unsubscribe(unsubscribe);\n                            });\n                    }\n                });\n            };\n        });\n        this.Collection = createCollectionConstructor(this);\n        this.Table = createTableConstructor(this);\n        this.Transaction = createTransactionConstructor(this);\n        this.Version = createVersionConstructor(this);\n        this.WhereClause = createWhereClauseConstructor(this);\n        this.on(\"versionchange\", ev => {\n            if (ev.newVersion > 0)\n                console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`);\n            else\n                console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`);\n            this.close();\n        });\n        this.on(\"blocked\", ev => {\n            if (!ev.newVersion || ev.newVersion < ev.oldVersion)\n                console.warn(`Dexie.delete('${this.name}') was blocked`);\n            else\n                console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${ev.oldVersion / 10}`);\n        });\n        this._maxKey = getMaxKey(options.IDBKeyRange);\n        this._createTransaction = (mode, storeNames, dbschema, parentTransaction) => new this.Transaction(mode, storeNames, dbschema, this._options.chromeTransactionDurability, parentTransaction);\n        this._fireOnBlocked = ev => {\n            this.on(\"blocked\").fire(ev);\n            connections\n                .filter(c => c.name === this.name && c !== this && !c._state.vcFired)\n                .map(c => c.on(\"versionchange\").fire(ev));\n        };\n        this.use(virtualIndexMiddleware);\n        this.use(hooksMiddleware);\n        this.use(observabilityMiddleware);\n        this.use(cacheExistingValuesMiddleware);\n        this.vip = Object.create(this, { _vip: { value: true } });\n        addons.forEach(addon => addon(this));\n    }\n    version(versionNumber) {\n        if (isNaN(versionNumber) || versionNumber < 0.1)\n            throw new exceptions.Type(`Given version is not a positive number`);\n        versionNumber = Math.round(versionNumber * 10) / 10;\n        if (this.idbdb || this._state.isBeingOpened)\n            throw new exceptions.Schema(\"Cannot add version when database is open\");\n        this.verno = Math.max(this.verno, versionNumber);\n        const versions = this._versions;\n        var versionInstance = versions.filter(v => v._cfg.version === versionNumber)[0];\n        if (versionInstance)\n            return versionInstance;\n        versionInstance = new this.Version(versionNumber);\n        versions.push(versionInstance);\n        versions.sort(lowerVersionFirst);\n        versionInstance.stores({});\n        this._state.autoSchema = false;\n        return versionInstance;\n    }\n    _whenReady(fn) {\n        return (this.idbdb && (this._state.openComplete || PSD.letThrough || this._vip)) ? fn() : new DexiePromise((resolve, reject) => {\n            if (this._state.openComplete) {\n                return reject(new exceptions.DatabaseClosed(this._state.dbOpenError));\n            }\n            if (!this._state.isBeingOpened) {\n                if (!this._options.autoOpen) {\n                    reject(new exceptions.DatabaseClosed());\n                    return;\n                }\n                this.open().catch(nop);\n            }\n            this._state.dbReadyPromise.then(resolve, reject);\n        }).then(fn);\n    }\n    use({ stack, create, level, name }) {\n        if (name)\n            this.unuse({ stack, name });\n        const middlewares = this._middlewares[stack] || (this._middlewares[stack] = []);\n        middlewares.push({ stack, create, level: level == null ? 10 : level, name });\n        middlewares.sort((a, b) => a.level - b.level);\n        return this;\n    }\n    unuse({ stack, name, create }) {\n        if (stack && this._middlewares[stack]) {\n            this._middlewares[stack] = this._middlewares[stack].filter(mw => create ? mw.create !== create :\n                name ? mw.name !== name :\n                    false);\n        }\n        return this;\n    }\n    open() {\n        return dexieOpen(this);\n    }\n    _close() {\n        const state = this._state;\n        const idx = connections.indexOf(this);\n        if (idx >= 0)\n            connections.splice(idx, 1);\n        if (this.idbdb) {\n            try {\n                this.idbdb.close();\n            }\n            catch (e) { }\n            this._novip.idbdb = null;\n        }\n        state.dbReadyPromise = new DexiePromise(resolve => {\n            state.dbReadyResolve = resolve;\n        });\n        state.openCanceller = new DexiePromise((_, reject) => {\n            state.cancelOpen = reject;\n        });\n    }\n    close() {\n        this._close();\n        const state = this._state;\n        this._options.autoOpen = false;\n        state.dbOpenError = new exceptions.DatabaseClosed();\n        if (state.isBeingOpened)\n            state.cancelOpen(state.dbOpenError);\n    }\n    delete() {\n        const hasArguments = arguments.length > 0;\n        const state = this._state;\n        return new DexiePromise((resolve, reject) => {\n            const doDelete = () => {\n                this.close();\n                var req = this._deps.indexedDB.deleteDatabase(this.name);\n                req.onsuccess = wrap(() => {\n                    _onDatabaseDeleted(this._deps, this.name);\n                    resolve();\n                });\n                req.onerror = eventRejectHandler(reject);\n                req.onblocked = this._fireOnBlocked;\n            };\n            if (hasArguments)\n                throw new exceptions.InvalidArgument(\"Arguments not allowed in db.delete()\");\n            if (state.isBeingOpened) {\n                state.dbReadyPromise.then(doDelete);\n            }\n            else {\n                doDelete();\n            }\n        });\n    }\n    backendDB() {\n        return this.idbdb;\n    }\n    isOpen() {\n        return this.idbdb !== null;\n    }\n    hasBeenClosed() {\n        const dbOpenError = this._state.dbOpenError;\n        return dbOpenError && (dbOpenError.name === 'DatabaseClosed');\n    }\n    hasFailed() {\n        return this._state.dbOpenError !== null;\n    }\n    dynamicallyOpened() {\n        return this._state.autoSchema;\n    }\n    get tables() {\n        return keys(this._allTables).map(name => this._allTables[name]);\n    }\n    transaction() {\n        const args = extractTransactionArgs.apply(this, arguments);\n        return this._transaction.apply(this, args);\n    }\n    _transaction(mode, tables, scopeFunc) {\n        let parentTransaction = PSD.trans;\n        if (!parentTransaction || parentTransaction.db !== this || mode.indexOf('!') !== -1)\n            parentTransaction = null;\n        const onlyIfCompatible = mode.indexOf('?') !== -1;\n        mode = mode.replace('!', '').replace('?', '');\n        let idbMode, storeNames;\n        try {\n            storeNames = tables.map(table => {\n                var storeName = table instanceof this.Table ? table.name : table;\n                if (typeof storeName !== 'string')\n                    throw new TypeError(\"Invalid table argument to Dexie.transaction(). Only Table or String are allowed\");\n                return storeName;\n            });\n            if (mode == \"r\" || mode === READONLY)\n                idbMode = READONLY;\n            else if (mode == \"rw\" || mode == READWRITE)\n                idbMode = READWRITE;\n            else\n                throw new exceptions.InvalidArgument(\"Invalid transaction mode: \" + mode);\n            if (parentTransaction) {\n                if (parentTransaction.mode === READONLY && idbMode === READWRITE) {\n                    if (onlyIfCompatible) {\n                        parentTransaction = null;\n                    }\n                    else\n                        throw new exceptions.SubTransaction(\"Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY\");\n                }\n                if (parentTransaction) {\n                    storeNames.forEach(storeName => {\n                        if (parentTransaction && parentTransaction.storeNames.indexOf(storeName) === -1) {\n                            if (onlyIfCompatible) {\n                                parentTransaction = null;\n                            }\n                            else\n                                throw new exceptions.SubTransaction(\"Table \" + storeName +\n                                    \" not included in parent transaction.\");\n                        }\n                    });\n                }\n                if (onlyIfCompatible && parentTransaction && !parentTransaction.active) {\n                    parentTransaction = null;\n                }\n            }\n        }\n        catch (e) {\n            return parentTransaction ?\n                parentTransaction._promise(null, (_, reject) => { reject(e); }) :\n                rejection(e);\n        }\n        const enterTransaction = enterTransactionScope.bind(null, this, idbMode, storeNames, parentTransaction, scopeFunc);\n        return (parentTransaction ?\n            parentTransaction._promise(idbMode, enterTransaction, \"lock\") :\n            PSD.trans ?\n                usePSD(PSD.transless, () => this._whenReady(enterTransaction)) :\n                this._whenReady(enterTransaction));\n    }\n    table(tableName) {\n        if (!hasOwn(this._allTables, tableName)) {\n            throw new exceptions.InvalidTable(`Table ${tableName} does not exist`);\n        }\n        return this._allTables[tableName];\n    }\n}\n\nconst symbolObservable = typeof Symbol !== \"undefined\" && \"observable\" in Symbol\n    ? Symbol.observable\n    : \"@@observable\";\nclass Observable {\n    constructor(subscribe) {\n        this._subscribe = subscribe;\n    }\n    subscribe(x, error, complete) {\n        return this._subscribe(!x || typeof x === \"function\" ? { next: x, error, complete } : x);\n    }\n    [symbolObservable]() {\n        return this;\n    }\n}\n\nfunction extendObservabilitySet(target, newSet) {\n    keys(newSet).forEach(part => {\n        const rangeSet = target[part] || (target[part] = new RangeSet());\n        mergeRanges(rangeSet, newSet[part]);\n    });\n    return target;\n}\n\nfunction liveQuery(querier) {\n    let hasValue = false;\n    let currentValue = undefined;\n    const observable = new Observable((observer) => {\n        const scopeFuncIsAsync = isAsyncFunction(querier);\n        function execute(subscr) {\n            if (scopeFuncIsAsync) {\n                incrementExpectedAwaits();\n            }\n            const exec = () => newScope(querier, { subscr, trans: null });\n            const rv = PSD.trans\n                ?\n                    usePSD(PSD.transless, exec)\n                : exec();\n            if (scopeFuncIsAsync) {\n                rv.then(decrementExpectedAwaits, decrementExpectedAwaits);\n            }\n            return rv;\n        }\n        let closed = false;\n        let accumMuts = {};\n        let currentObs = {};\n        const subscription = {\n            get closed() {\n                return closed;\n            },\n            unsubscribe: () => {\n                closed = true;\n                globalEvents.storagemutated.unsubscribe(mutationListener);\n            },\n        };\n        observer.start && observer.start(subscription);\n        let querying = false, startedListening = false;\n        function shouldNotify() {\n            return keys(currentObs).some((key) => accumMuts[key] && rangesOverlap(accumMuts[key], currentObs[key]));\n        }\n        const mutationListener = (parts) => {\n            extendObservabilitySet(accumMuts, parts);\n            if (shouldNotify()) {\n                doQuery();\n            }\n        };\n        const doQuery = () => {\n            if (querying || closed)\n                return;\n            accumMuts = {};\n            const subscr = {};\n            const ret = execute(subscr);\n            if (!startedListening) {\n                globalEvents(DEXIE_STORAGE_MUTATED_EVENT_NAME, mutationListener);\n                startedListening = true;\n            }\n            querying = true;\n            Promise.resolve(ret).then((result) => {\n                hasValue = true;\n                currentValue = result;\n                querying = false;\n                if (closed)\n                    return;\n                if (shouldNotify()) {\n                    doQuery();\n                }\n                else {\n                    accumMuts = {};\n                    currentObs = subscr;\n                    observer.next && observer.next(result);\n                }\n            }, (err) => {\n                querying = false;\n                hasValue = false;\n                observer.error && observer.error(err);\n                subscription.unsubscribe();\n            });\n        };\n        doQuery();\n        return subscription;\n    });\n    observable.hasValue = () => hasValue;\n    observable.getValue = () => currentValue;\n    return observable;\n}\n\nlet domDeps;\ntry {\n    domDeps = {\n        indexedDB: _global.indexedDB || _global.mozIndexedDB || _global.webkitIndexedDB || _global.msIndexedDB,\n        IDBKeyRange: _global.IDBKeyRange || _global.webkitIDBKeyRange\n    };\n}\ncatch (e) {\n    domDeps = { indexedDB: null, IDBKeyRange: null };\n}\n\nconst Dexie = Dexie$1;\nprops(Dexie, {\n    ...fullNameExceptions,\n    delete(databaseName) {\n        const db = new Dexie(databaseName, { addons: [] });\n        return db.delete();\n    },\n    exists(name) {\n        return new Dexie(name, { addons: [] }).open().then(db => {\n            db.close();\n            return true;\n        }).catch('NoSuchDatabaseError', () => false);\n    },\n    getDatabaseNames(cb) {\n        try {\n            return getDatabaseNames(Dexie.dependencies).then(cb);\n        }\n        catch (_a) {\n            return rejection(new exceptions.MissingAPI());\n        }\n    },\n    defineClass() {\n        function Class(content) {\n            extend(this, content);\n        }\n        return Class;\n    },\n    ignoreTransaction(scopeFunc) {\n        return PSD.trans ?\n            usePSD(PSD.transless, scopeFunc) :\n            scopeFunc();\n    },\n    vip,\n    async: function (generatorFn) {\n        return function () {\n            try {\n                var rv = awaitIterator(generatorFn.apply(this, arguments));\n                if (!rv || typeof rv.then !== 'function')\n                    return DexiePromise.resolve(rv);\n                return rv;\n            }\n            catch (e) {\n                return rejection(e);\n            }\n        };\n    },\n    spawn: function (generatorFn, args, thiz) {\n        try {\n            var rv = awaitIterator(generatorFn.apply(thiz, args || []));\n            if (!rv || typeof rv.then !== 'function')\n                return DexiePromise.resolve(rv);\n            return rv;\n        }\n        catch (e) {\n            return rejection(e);\n        }\n    },\n    currentTransaction: {\n        get: () => PSD.trans || null\n    },\n    waitFor: function (promiseOrFunction, optionalTimeout) {\n        const promise = DexiePromise.resolve(typeof promiseOrFunction === 'function' ?\n            Dexie.ignoreTransaction(promiseOrFunction) :\n            promiseOrFunction)\n            .timeout(optionalTimeout || 60000);\n        return PSD.trans ?\n            PSD.trans.waitFor(promise) :\n            promise;\n    },\n    Promise: DexiePromise,\n    debug: {\n        get: () => debug,\n        set: value => {\n            setDebug(value, value === 'dexie' ? () => true : dexieStackFrameFilter);\n        }\n    },\n    derive: derive,\n    extend: extend,\n    props: props,\n    override: override,\n    Events: Events,\n    on: globalEvents,\n    liveQuery,\n    extendObservabilitySet,\n    getByKeyPath: getByKeyPath,\n    setByKeyPath: setByKeyPath,\n    delByKeyPath: delByKeyPath,\n    shallowClone: shallowClone,\n    deepClone: deepClone,\n    getObjectDiff: getObjectDiff,\n    cmp,\n    asap: asap$1,\n    minKey: minKey,\n    addons: [],\n    connections: connections,\n    errnames: errnames,\n    dependencies: domDeps,\n    semVer: DEXIE_VERSION,\n    version: DEXIE_VERSION.split('.')\n        .map(n => parseInt(n))\n        .reduce((p, c, i) => p + (c / Math.pow(10, i * 2))),\n});\nDexie.maxKey = getMaxKey(Dexie.dependencies.IDBKeyRange);\n\nif (typeof dispatchEvent !== 'undefined' && typeof addEventListener !== 'undefined') {\n    globalEvents(DEXIE_STORAGE_MUTATED_EVENT_NAME, updatedParts => {\n        if (!propagatingLocally) {\n            let event;\n            if (isIEOrEdge) {\n                event = document.createEvent('CustomEvent');\n                event.initCustomEvent(STORAGE_MUTATED_DOM_EVENT_NAME, true, true, updatedParts);\n            }\n            else {\n                event = new CustomEvent(STORAGE_MUTATED_DOM_EVENT_NAME, {\n                    detail: updatedParts\n                });\n            }\n            propagatingLocally = true;\n            dispatchEvent(event);\n            propagatingLocally = false;\n        }\n    });\n    addEventListener(STORAGE_MUTATED_DOM_EVENT_NAME, ({ detail }) => {\n        if (!propagatingLocally) {\n            propagateLocally(detail);\n        }\n    });\n}\nfunction propagateLocally(updateParts) {\n    let wasMe = propagatingLocally;\n    try {\n        propagatingLocally = true;\n        globalEvents.storagemutated.fire(updateParts);\n    }\n    finally {\n        propagatingLocally = wasMe;\n    }\n}\nlet propagatingLocally = false;\n\nif (typeof BroadcastChannel !== 'undefined') {\n    const bc = new BroadcastChannel(STORAGE_MUTATED_DOM_EVENT_NAME);\n    if (typeof bc.unref === 'function') {\n        bc.unref();\n    }\n    globalEvents(DEXIE_STORAGE_MUTATED_EVENT_NAME, (changedParts) => {\n        if (!propagatingLocally) {\n            bc.postMessage(changedParts);\n        }\n    });\n    bc.onmessage = (ev) => {\n        if (ev.data)\n            propagateLocally(ev.data);\n    };\n}\nelse if (typeof self !== 'undefined' && typeof navigator !== 'undefined') {\n    globalEvents(DEXIE_STORAGE_MUTATED_EVENT_NAME, (changedParts) => {\n        try {\n            if (!propagatingLocally) {\n                if (typeof localStorage !== 'undefined') {\n                    localStorage.setItem(STORAGE_MUTATED_DOM_EVENT_NAME, JSON.stringify({\n                        trig: Math.random(),\n                        changedParts,\n                    }));\n                }\n                if (typeof self['clients'] === 'object') {\n                    [...self['clients'].matchAll({ includeUncontrolled: true })].forEach((client) => client.postMessage({\n                        type: STORAGE_MUTATED_DOM_EVENT_NAME,\n                        changedParts,\n                    }));\n                }\n            }\n        }\n        catch (_a) { }\n    });\n    if (typeof addEventListener !== 'undefined') {\n        addEventListener('storage', (ev) => {\n            if (ev.key === STORAGE_MUTATED_DOM_EVENT_NAME) {\n                const data = JSON.parse(ev.newValue);\n                if (data)\n                    propagateLocally(data.changedParts);\n            }\n        });\n    }\n    const swContainer = self.document && navigator.serviceWorker;\n    if (swContainer) {\n        swContainer.addEventListener('message', propagateMessageLocally);\n    }\n}\nfunction propagateMessageLocally({ data }) {\n    if (data && data.type === STORAGE_MUTATED_DOM_EVENT_NAME) {\n        propagateLocally(data.changedParts);\n    }\n}\n\nDexiePromise.rejectionMapper = mapError;\nsetDebug(debug, dexieStackFrameFilter);\n\nexport { Dexie$1 as Dexie, RangeSet, Dexie$1 as default, liveQuery, mergeRanges, rangesOverlap };\n//# sourceMappingURL=dexie.mjs.map\n"],"names":["createStoreImpl","createState","state","listeners","Set","setState","partial","replace","nextState","Object","is","previousState","assign","forEach","listener","getState","api","getInitialState","initialState","subscribe","add","delete","destroy","clear","shimModule","exports","checkIfSnapshotChanged","inst","latestGetSnapshot","getSnapshot","value","nextValue","objectIs","error","__REACT_DEVTOOLS_GLOBAL_HOOK__","registerInternalModuleStart","Error","React","require$$0","x","y","useState","useEffect","useLayoutEffect","useDebugValue","didWarnOld18Alpha","didWarnUncachedGetSnapshot","shim","window","document","createElement","startTransition","cachedValue","forceUpdate","useSyncExternalStoreShim_development","useSyncExternalStore","registerInternalModuleStop","withSelectorModule","require$$1","useRef","useMemo","withSelector_development","getServerSnapshot","selector","isEqual","instRef","current","hasValue","memoizedSelector","nextSnapshot","hasMemo","memoizedSnapshot","currentSelection","memoizedSelection","nextSelection","maybeGetServerSnapshot","ReactExports","useSyncExternalStoreWithSelector","useSyncExternalStoreExports","didWarnAboutEqualityFn","identity","arg","createImpl","createStore","useBoundStore","equalityFn","__vite_import_meta_env__","slice","getServerState","useStore","create","_global","globalThis","self","global","keys","isArray","Array","extend","obj","extension","key","Promise","getProto","getPrototypeOf","_hasOwn","hasOwnProperty","hasOwn","prop","call","props","proto","Reflect","ownKeys","setProp","defineProperty","functionOrGetSet","options","get","set","configurable","writable","derive","Child","from","Parent","prototype","bind","getOwnPropertyDescriptor","getPropertyDescriptor","_slice","args","start","end","override","origFunc","overridedFactory","assert","b","asap$1","fn","setImmediate","setTimeout","arrayToObject","array","extractor","reduce","result","item","i","nameAndValue","getByKeyPath","keyPath","rv","l","length","val","push","period","indexOf","innerObj","substr","setByKeyPath","isFrozen","currentKeyPath","remainingKeyPath","isNaN","parseInt","splice","shallowClone","m","concat","flatten","a","apply","intrinsicTypeNames","split","map","num","t","filter","intrinsicTypes","circularRefs","deepClone","any","WeakMap","innerDeepClone","constructor","toString","toStringTag","o","iteratorSymbol","Symbol","iterator","getIteratorOf","NO_CHAR_ARRAY","getArrayOf","arrayLike","it","arguments","this","next","done","isAsyncFunction","debug","location","test","href","setDebug","libraryFilter","NEEDS_THROW_FOR_STACK","stack","getErrorWithStack","e","prettyStack","exception","numIgnoredFrames","name","message","frame","join","idbDomErrorNames","errorList","defaultTexts","VersionChanged","DatabaseClosed","Abort","TransactionInactive","MissingAPI","DexieError","msg","_e","getMultiErrorMessage","failures","v","s","ModifyError","successCount","failedKeys","BulkError","pos","failuresByPos","_stack","errnames","BaseException","exceptions","fullName","msgOrInner","inner","Syntax","SyntaxError","Type","TypeError","Range","RangeError","exceptionMap","fullNameExceptions","nop","mirror","pureFunctionChain","f1","f2","callBoth","on1","on2","hookCreatingChain","res","onsuccess","onerror","res2","hookDeletingChain","hookUpdatingChain","modifications","reverseStoppableEventChain","promisableChain","then","thiz","INTERNAL","resolvedNativePromise","nativePromiseProto","resolvedGlobalPromise","globalP","resolve","crypto","subtle","nativeP","digest","Uint8Array","nativePromiseThen","NativePromise","patchGlobalPromise","stack_being_generated","schedulePhysicalTick","physicalTick","MutationObserver","hiddenDiv","observe","attributes","setAttribute","asap","callback","microtickQueue","needsNewPhysicalTick","isOutsideMicroTick","unhandledErrors","rejectingErrors","currentFulfiller","rejectionMapper","globalPSD","id","ref","unhandleds","onunhandled","globalError","pgp","env","finalize","uh","PSD","numScheduledCalls","tickFinalizers","DexiePromise","_listeners","onuncatched","_lib","psd","_PSD","_stackHolder","_prev","_numPrev","_state","_value","handleRejection","executePromiseTask","thenProp","microTaskId","totalEchoes","onFulfilled","onRejected","possibleAwait","cleanup","decrementExpectedAwaits","reject","propagateToListener","Listener","nativeAwaitCompatibleWrap","linkToPreviousPromise","zone","promise","shouldExecuteTick","beginMicroTickScope","_then","propagateAllListeners","endMicroTickScope","ex","reason","_promise","tryCatch","origProp","some","p","addPossiblyUnhandledError","len","finalizePhysicalTick","cb","callListener","ret","markErrorAsHandled","getStack","stacks","limit","errorName","failure","prev","numPrev","wasRootExec","callbacks","unhandledErrs","finalizers","PromiseReject","wrap","errorCatcher","outerScope","switchToZone","catch","type","handler","err","finally","onFinally","timeout","ms","Infinity","handle","Timeout","clearTimeout","snapShot","all","values","onPossibleParallellAsync","remaining","race","newPSD","newScope","usePSD","scheduler","follow","zoneProps","finalizer","run_at_end_of_this_or_next_physical_tick","allSettled","possiblePromises","results","status","AggregateError","task","awaits","echoes","taskCounter","zoneStack","zoneEchoes","zone_id_counter","a1","a2","parent","globalEnv","PromiseProp","nthen","getPatchedPromiseThen","gthen","incrementExpectedAwaits","possiblePromise","rejection","zoneEnterEcho","targetZone","zoneLeaveEcho","pop","bEnteringZone","currentZone","enqueueNativeMicroTask","GlobalPromise","targetEnv","a3","job","outerZone","origThen","onResolved","UNHANDLEDREJECTION","event","eventData","createEvent","initEvent","CustomEvent","detail","dispatchEvent","PromiseRejectionEvent","onunhandledrejection","_","defaultPrevented","tempTransaction","db","mode","storeNames","idbdb","openComplete","letThrough","_vip","trans","_createTransaction","_dbSchema","PR1398_maxLoop","InvalidState","isOpen","_close","open","_completion","dbOpenError","isBeingOpened","_options","autoOpen","dbReadyPromise","DEXIE_VERSION","maxString","String","fromCharCode","minKey","INVALID_KEY_ARGUMENT","STRING_EXPECTED","connections","isIEOrEdge","navigator","userAgent","hasIEDeleteObjectStoreBug","hangsOnDeleteLargeKeyRange","dexieStackFrameFilter","DBNAMES_DB","READONLY","READWRITE","combine","filter1","filter2","AnyRange","lower","lowerOpen","upper","upperOpen","workaroundForUndefinedPrimKey","Table","_trans","writeLocked","_tx","tableName","checkTableInTransaction","schema","NotFound","idbtrans","transless","keyOrCrit","where","first","core","hook","reading","fire","indexOrCrit","WhereClause","keyPaths","equals","compoundIndex","indexes","primKey","ix","compound","every","sort","_maxKey","keyPathsInValidOrder","kp","idxByName","idb","_deps","indexedDB","cmp","idx","filterFunction","prevIndex","prevFilterFn","index","multi","toCollection","and","count","thenShortcut","offset","numRows","each","toArray","Collection","orderBy","reverse","mapToClass","mappedClass","readHook","unsubscribe","defineClass","content","auto","objToAdd","mutate","numFailures","lastResult","update","keyOrObject","modify","InvalidArgument","_a","put","range","bulkGet","getMany","bulkAdd","objects","keysOrOptions","wantResults","allKeys","numObjects","objectsToAdd","bulkPut","objectsToPut","bulkDelete","numKeys","Events","ctx","evs","eventName","subscriber","addEventType","chainFunction","defaultFunction","cfg","context","subscribers","makeClassConstructor","isPlainKeyRange","ignoreLimitFilter","algorithm","or","justLimit","replayFilter","addFilter","addReplayFilter","factory","isLimitFilter","curr","getIndexOrStore","coreSchema","isPrimKey","primaryKey","getIndexByKeyPath","Schema","openCursor","coreTable","keysOnly","dir","unique","query","iter","coreTrans","union","cursor","advance","stop","fail","_iterate","iterate","valueMapper","cursorPromise","wrappedFn","c","continue","advancer","ta","tb","NaN","al","bl","compareUint8Arrays","getUint8Array","compareArrays","ArrayBuffer","isView","tsTag","buffer","byteOffset","byteLength","_read","_ctx","table","_write","_addAlgorithm","clone","raw","Math","min","sortBy","parts","lastPart","lastIndex","getval","order","sorter","aVal","bVal","offsetLeft","rowsLeft","until","bIncludeStopEntry","last","isMatch","indexName","_ondirectionchange","desc","eachKey","eachUniqueKey","eachPrimaryKey","primaryKeys","uniqueKeys","firstKey","lastKey","distinct","strKey","found","changes","modifyer","anythingModified","outbound","extractKey","modifyChunkSize","totalFailures","applyMutateResult","expectedCount","nextChunk","cache","addValues","putValues","putKeys","deleteKeys","origValue","criteria","deleteCallback","changeSpec","coreRange","simpleCompare","simpleCompareReverse","collectionOrWhereClause","T","collection","emptyCollection","whereClause","rangeEqual","nextCasing","lowerKey","upperNeedle","lowerNeedle","llp","lwrKeyChar","addIgnoreCaseAlgorithm","match","needles","suffix","compare","upperNeedles","lowerNeedles","direction","nextKeySuffix","needlesLen","initDirection","toUpperCase","toLowerCase","upperFactory","lowerFactory","needleBounds","needle","nb","createRange","firstPossibleNeedle","lowestPossibleCasing","casing","between","includeLower","includeUpper","_cmp","above","aboveOrEqual","below","belowOrEqual","startsWith","str","startsWithIgnoreCase","equalsIgnoreCase","anyOfIgnoreCase","startsWithAnyOfIgnoreCase","n","anyOf","_ascending","_descending","notEqual","inAnyRange","includeLowers","includeUppers","noneOf","ranges","ascending","descending","_min","max","_max","sortDirection","rangeSorter","addRange","newRange","rangePos","keyIsBeyondCurrentEntry","keyIsBeforeCurrentEntry","checkKey","keyWithinCurrentRange","startsWithAnyOf","eventRejectHandler","preventDefault","target","stopPropagation","DEXIE_STORAGE_MUTATED_EVENT_NAME","STORAGE_MUTATED_DOM_EVENT_NAME","globalEvents","Transaction","_lock","_reculock","lockOwnerFor","_unlock","_blockedFuncs","_locked","fnAndPSD","shift","OpenFailed","active","transaction","durability","chromeTransactionDurability","ev","_reject","onabort","on","oncomplete","_resolve","storagemutated","bWriteLock","ReadOnly","_root","waitFor","promiseLike","root","_waitingFor","_waitingQueue","store","objectStore","spin","_spinCount","currentWaitPromise","abort","memoizedTables","_memoizedTables","tableSchema","transactionBoundTable","createIndexSpec","src","nameFromKeyPath","createTableSchema","getMaxKey","IdbKeyRange","only","getKeyExtractor","getSinglePathKeyExtractor","arrayify","_id_counter","getKeyPathAlias","createDBCore","tmpTrans","makeIDBKeyRange","upperBound","lowerBound","bound","hasGetAll","tables","objectStoreNames","autoIncrement","indexByKeyPath","isPrimaryKey","indexNames","multiEntry","extractSchema","isAddOrPut","req","reqs","errorHandler","args1","args2","keyCount","callbackCount","successHandler","_pos","request","nonInfinitLimit","source","idbKeyRange","getAll","getAllKeys","openKeyCursor","___id","_cursorContinue","_cursorContinuePrimaryKey","continuePrimaryKey","_cursorAdvance","doThrowCursorIsStopped","gotOne","iterationPromise","resolveIteration","rejectIteration","guardedCallback","createDbCoreTable","tableMap","MIN_KEY","MAX_KEY","generateMiddlewareStacks","_novip","middlewares","IDBKeyRange","dbcore","stackImpl","down","createMiddlewareStack","createMiddlewareStacks","_middlewares","tbl","setApiOnPlace","objs","tableNames","dbschema","propDesc","enumerable","removeTablesApi","lowerVersionFirst","_cfg","version","runUpgraders","oldVersion","idbUpgradeTrans","globalSchema","_storeNames","rejectTransaction","createTable","populate","queue","versions","_versions","buildGlobalSchema","anyContentUpgraderHasRun","versToRun","runQueue","oldSchema","newSchema","adjustToExistingIndexNames","diff","getSchemaDiff","tuple","change","recreate","Upgrade","addIndex","deleteIndex","del","idxName","contentUpgrade","upgradeSchema","contentUpgradeIsAsync","returnValue","promiseFollowed","decrementor","storeName","deleteObjectStore","deleteRemovedTables","contains","updateTablesAndIndexes","oldDef","newDef","def","oldIndexes","newIndexes","oldIdx","newIdx","createObjectStore","createIndex","j","idbindex","_hasGetAll","dexieName","indexSpec","WorkerGlobalScope","Version","_parseStoresSpec","stores","outSchema","indexNum","trim","storesSource","storesSpec","_allTables","upgrade","upgradeFunction","getDbNamesTable","dbNamesDB","Dexie$1","addons","dbnames","hasDatabasesNative","databases","vip","dexieOpen","openCanceller","throwIfCancelled","resolveDbReady","dbReadyResolve","upgradeTransaction","wasCreated","tryOpenDB","dbName","autoSchema","round","verno","onblocked","_fireOnBlocked","onupgradeneeded","allowEmptyDB","close","delreq","deleteDatabase","NoSuchDatabase","oldVer","pow","readGlobalSchema","ch","verifyInstalledSchema","onversionchange","vcFired","onclose","_onDatabaseCreated","userAgentData","tryIdb","intervalId","setInterval","clearInterval","onReadyBeingFired","ready","fireRemainders","remainders","awaitIterator","callNext","onSuccess","step","onError","throw","getNext","extractTransactionArgs","_tableArgs_","scopeFunc","enterTransactionScope","parentTransaction","scopeFuncIsAsync","PrematureCommit","pad","virtualIndexMiddleware","level","indexLookup","allVirtualIndexes","addVirtualIndexes","keyTail","lowLevelIndex","keyPathAlias","indexList","keyLength","isVirtual","virtualIndex","translateRequest","createVirtualCursor","getObjectDiff","prfx","ap","bp","apTypeName","hooksMiddleware","downCore","downTable","dxTrans","deleting","creating","updating","addPutOrDelete","deleteRange","deleteNextChunk","getEffectiveKeys","effectiveKeys","getExistingValues","existingValues","contexts","existingValue","generatedPrimaryKey","objectDiff","additionalChanges","requestedValue","getFromTransactionCache","cacheExistingValuesMiddleware","cachedResult","isEmptyRange","node","RangeSet","fromOrTree","to","d","left","right","r","rebalance","rightWasCutOff","mergeRanges","newSet","_addRangeSet","getRangeSetIterator","keyProvided","up","_b","rootClone","oldRootRight","computeDepth","rangeSet","addKey","addKeys","observabilityMiddleware","FULL_RANGE","tableClone","mutatedParts","getRangeSet","part","pkRangeSet","delsRangeSet","newObjs","oldCache","oldObjs","addAffectedIndex","addKeyOrKeys","oldKey","newKey","trackAffectedIndexes","getRange","readSubscribers","method","subscr","queriedIndex","queriedRanges","keysPromise","resultingKeys","pKeys","wantValues","pkey","deps","dependencies","cancelOpen","bSticky","keyRangeGenerator","keyRange","whereCtx","readingHook","createTableConstructor","complete","wasActive","createTransactionConstructor","versionNumber","createVersionConstructor","orCollection","_IDBKeyRange","createWhereClauseConstructor","newVersion","use","addon","versionInstance","_whenReady","unuse","mw","hasArguments","doDelete","_onDatabaseDeleted","backendDB","hasBeenClosed","hasFailed","dynamicallyOpened","_transaction","onlyIfCompatible","idbMode","SubTransaction","enterTransaction","InvalidTable","symbolObservable","observable","Observable","_subscribe","extendObservabilitySet","domDeps","mozIndexedDB","webkitIndexedDB","msIndexedDB","webkitIDBKeyRange","Dexie","propagateLocally","updateParts","wasMe","propagatingLocally","databaseName","exists","getDatabaseNames","infos","info","ignoreTransaction","async","generatorFn","spawn","currentTransaction","promiseOrFunction","optionalTimeout","liveQuery","querier","currentValue","observer","closed","accumMuts","currentObs","subscription","mutationListener","querying","startedListening","shouldNotify","rangeSet1","rangeSet2","i1","nextResult1","i2","nextResult2","rangesOverlap","doQuery","exec","execute","getValue","delByKeyPath","semVer","maxKey","addEventListener","updatedParts","initCustomEvent","BroadcastChannel","bc","unref","changedParts","postMessage","onmessage","data","localStorage","setItem","JSON","stringify","trig","random","matchAll","includeUncontrolled","client","parse","newValue","swContainer","serviceWorker","domError"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6]}