import{c as F,u as A,a as L,r as o,j as e,C as k,b as T,I as R,B as y,d as z,e as M,A as G,f as C,g as S,k as w,l as q,T as I,W as P,h as U,i as B,L as H,S as E,P as O,m as K,n as _}from"./index-BBaWhQzg.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p=F("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);function $(){const{weights:s}=A(),{updateWeight:x}=L(),[l,u]=o.useState(!1),[d,h]=o.useState(!1),[c,g]=o.useState([]),[m,t]=o.useState(!1),i=()=>{u(!0);const n=s.map(r=>{const f=w(r.kg),j=r.kg>200||r.kg>100&&r.kg<200&&r.kg%1!==0,D=j?r.kg:f;return{entry:r,currentDisplayLbs:f,suggestedLbs:D,needsConversion:j}}).filter(r=>r.needsConversion);g(n),u(!1)},a=async n=>{try{const r=q(n.suggestedLbs);await x(n.entry.id,{kg:r}),g(f=>f.filter(j=>j.entry.id!==n.entry.id))}catch(r){console.error("Failed to convert entry:",r)}},v=async()=>{h(!0);try{for(const n of c)await a(n),await new Promise(r=>setTimeout(r,100))}catch(n){console.error("Failed to convert entries:",n)}finally{h(!1)}},N=n=>new Date(n).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});return m?e.jsxs(k,{className:"cyber-card border-yellow-500/50",children:[e.jsxs(z,{children:[e.jsxs(M,{className:"cyber-subtitle flex items-center gap-2 text-yellow-400",children:[e.jsx(p,{className:"cyber-icon h-5 w-5"}),"Weight Conversion Tool"]}),e.jsx("p",{className:"text-sm text-gray-400",children:"This tool helps fix weight entries that may have been entered in the wrong unit. If you previously entered weights in pounds but they were stored as kilograms, this will correct them."})]}),e.jsxs(T,{className:"space-y-4",children:[c.length===0&&!l&&e.jsx("div",{className:"text-center py-6",children:e.jsxs(y,{onClick:i,variant:"outline",className:"border-yellow-500/50 text-yellow-400 hover:bg-yellow-500/10",disabled:l,children:[e.jsx(p,{className:`mr-2 h-4 w-4 ${l?"animate-spin":""}`}),l?"Analyzing...":"Analyze Entries"]})}),c.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-4 w-4 text-yellow-400"}),e.jsxs("span",{className:"text-sm font-medium text-yellow-400",children:["Found ",c.length," entries that may need conversion"]})]}),e.jsx(y,{onClick:v,variant:"cyber-ki",size:"sm",disabled:d,children:d?"Converting...":"Convert All"})]}),e.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:c.map(n=>e.jsx("div",{className:"cyber-card bg-gray-900/50 p-3 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-mono text-gray-300",children:N(n.entry.dateISO)}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsxs(C,{variant:"outline",className:"text-red-400 border-red-500/50",children:["Current: ",n.currentDisplayLbs.toFixed(1),"lbs"]}),e.jsx("span",{className:"text-gray-500",children:"→"}),e.jsxs(C,{variant:"outline",className:"text-ki-green border-ki-green/50",children:["Fixed: ",n.suggestedLbs.toFixed(1),"lbs"]})]})]})}),e.jsxs(y,{onClick:()=>a(n),variant:"outline",size:"sm",className:"border-ki-green/50 text-ki-green hover:bg-ki-green/10",children:[e.jsx(S,{className:"mr-1 h-3 w-3"}),"Fix"]})]})},n.entry.id))})]}),c.length===0&&l&&e.jsxs("div",{className:"text-center py-6",children:[e.jsx(p,{className:"h-8 w-8 animate-spin text-yellow-400 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Analyzing weight entries..."})]}),c.length===0&&!l&&s.length>0&&e.jsxs("div",{className:"text-center py-6",children:[e.jsx(S,{className:"h-8 w-8 text-ki-green mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-ki-green font-medium",children:"All entries look correct!"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"No conversion needed"})]}),e.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-gray-700",children:[e.jsx(y,{variant:"ghost",size:"sm",onClick:()=>t(!1),className:"text-gray-400 hover:bg-gray-800",children:"Hide Tool"}),e.jsxs("div",{className:"text-xs text-gray-500",children:[s.length," total entries • ",c.length," need conversion"]})]})]})]}):e.jsx(k,{className:"cyber-card border-yellow-500/30",children:e.jsx(T,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(R,{className:"h-5 w-5 text-yellow-400"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-yellow-400",children:"Weight Unit Conversion"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Check if any entries need kg → lbs conversion"})]})]}),e.jsx(y,{variant:"outline",size:"sm",onClick:()=>t(!0),className:"border-yellow-500/50 text-yellow-400 hover:bg-yellow-500/10",children:"Check Entries"})]})})})}const b="perfect-zenkai-reminder-timeout";function Y(){const[s,x]=o.useState("default"),[l]=o.useState(()=>"Notification"in window);o.useEffect(()=>{l&&x(Notification.permission)},[l]);const u=async()=>{if(!l)return"denied";try{const t=await Notification.requestPermission();return x(t),t}catch(t){return console.error("Error requesting notification permission:",t),"denied"}},d=()=>{const t=new Date,i=new Date;return i.setHours(9,0,0,0),t>=i&&i.setDate(i.getDate()+1),i.getTime()-t.getTime()},h=()=>{const t=new Date().toISOString().split("T")[0];return localStorage.getItem(`weight-logged-${t}`)==="true"},c=()=>{if(s!=="granted"||h())return;const t=new Date().getDay();if(t===0||t===6)return;const i=new Notification("Time to weigh in",{body:"Track your weight to stay on top of your health goals",icon:"/icons/logo192.png",tag:"daily-weight-reminder",requireInteraction:!1,data:{url:"/weight"}});i.onclick=a=>{a.preventDefault(),window.focus(),window.location.href="/weight",i.close()},setTimeout(()=>{i.close()},1e4)},g=()=>{if(s!=="granted")return;m();const t=d(),i=setTimeout(()=>{c(),g()},t);localStorage.setItem(b,i.toString())},m=()=>{const t=localStorage.getItem(b);t&&(clearTimeout(parseInt(t)),localStorage.removeItem(b))};return o.useEffect(()=>()=>{m()},[]),{permission:s,isSupported:l,requestPermission:u,scheduleDailyReminder:g,clearDailyReminder:m}}const W="perfect-zenkai-notification-requested";function Q(){const{weights:s,activeGoal:x,loadWeights:l,loadActiveGoal:u,isLoading:d}=A(),{permission:h,isSupported:c,requestPermission:g,scheduleDailyReminder:m}=Y(),[t,i]=o.useState(!1);return o.useEffect(()=>{s.length===0&&l(),x||u()},[s.length,l,x,u]),o.useEffect(()=>{const a=localStorage.getItem(W);if(c&&h==="default"&&!a){const v=setTimeout(async()=>{const N=await g();localStorage.setItem(W,"true"),N==="granted"&&m()},2e3);return()=>clearTimeout(v)}else h==="granted"&&m()},[c,h,g,m]),e.jsxs("div",{className:"container mx-auto px-4 pb-24 pt-4",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"cyber-title gradient-text-ki mb-2",children:"WEIGHT TRACKING"}),e.jsxs("p",{className:"font-mono text-sm text-gray-400",children:["Progress monitoring system • ",s.length," entries logged"]})]}),e.jsxs(y,{variant:"outline",size:"sm",onClick:()=>i(!t),className:"flex items-center gap-2",children:[e.jsx(I,{className:"h-4 w-4"}),x?"Edit Goal":"Set Goal"]})]})}),e.jsx(P,{}),t&&e.jsx("div",{className:"mb-6",children:e.jsx(U,{onClose:()=>i(!1)})}),s.length>0&&!d&&e.jsx("div",{className:"mb-6",children:e.jsx($,{})}),s.length>0&&!d&&e.jsx(B,{}),d&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"cyber-card p-4",children:e.jsxs("div",{className:"mb-4 flex items-center gap-3",children:[e.jsx("div",{className:"shimmer h-8 w-8 rounded-full bg-gray-700"}),e.jsxs("div",{children:[e.jsx("div",{className:"shimmer mb-2 h-4 w-24 rounded bg-gray-700"}),e.jsx("div",{className:"shimmer h-3 w-16 rounded bg-gray-700"})]})]})}),e.jsx(H,{count:5})]}),!d&&s.length===0&&e.jsx("div",{className:"py-16 text-center",children:e.jsx("div",{className:"cyber-card mx-auto max-w-md",children:e.jsxs("div",{className:"flex flex-col items-center space-y-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"flex h-20 w-20 items-center justify-center rounded-xl border border-gray-700 bg-gray-900",children:e.jsx(E,{className:"text-ki-green cyber-icon h-10 w-10 animate-pulse"})}),e.jsx("div",{className:"bg-hyper-magenta absolute -right-2 -top-2 flex h-6 w-6 items-center justify-center rounded-full",children:e.jsx(O,{className:"h-4 w-4 text-white"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"cyber-subtitle text-gray-300",children:"Begin Weight Journey"}),e.jsxs("p",{className:"font-mono text-sm leading-relaxed text-gray-500",children:["Track your progress with precision.",e.jsx("br",{}),"Every entry brings you closer to your goal."]})]}),e.jsxs(y,{variant:"cyber-ki",onClick:()=>{const a=document.getElementById("weight-quick");a&&a.focus()},className:"w-full",children:[e.jsx(E,{className:"mr-2 h-4 w-4"}),"LOG FIRST WEIGHT"]}),e.jsxs("div",{className:"mt-6 grid w-full grid-cols-2 gap-4 border-t border-gray-700 pt-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(K,{className:"text-plasma-cyan cyber-icon mx-auto mb-2 h-6 w-6"}),e.jsx("div",{className:"font-mono text-xs text-gray-400",children:"Trend Analysis"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(I,{className:"text-hyper-magenta cyber-icon mx-auto mb-2 h-6 w-6"}),e.jsx("div",{className:"font-mono text-xs text-gray-400",children:"Goal Tracking"})]})]})]})})}),!d&&s.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"cyber-card mb-6 p-4",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"gradient-text-ki metric-display text-lg font-bold",children:s.length}),e.jsx("div",{className:"font-mono text-xs text-gray-400",children:"Entries"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"gradient-text-cyan metric-display text-lg font-bold",children:[s[0]?w(s[0].kg).toFixed(1):0,"lbs"]}),e.jsx("div",{className:"font-mono text-xs text-gray-400",children:"Latest"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"gradient-text-magenta metric-display text-lg font-bold",children:Math.max(...s.map(a=>a.kg))-Math.min(...s.map(a=>a.kg))>=.1?`${w(Math.max(...s.map(a=>a.kg))-Math.min(...s.map(a=>a.kg))).toFixed(1)}lbs`:"0lbs"}),e.jsx("div",{className:"font-mono text-xs text-gray-400",children:"Range"})]})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-300 mb-2",children:["Weight Entries (",s.length,")"]}),s.map(a=>e.jsx(_,{entry:a},a.id))]})]})]})}export{Q as default};
